<!DOCTYPE HTML>


[%settitle Security%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<div class="col-12">

<h1>Security Labels</h1>
<table class="colstu"><tr><td id="wg"><a _target="blank" href="[%wg fhir%]">[%wgt fhir%]</a> Work Group</td><td id="fmm"><a href="versions.html#maturity">Maturity Level</a>: 3</td><td id="ballot"><a href="versions.html#std-process">Standards Status</a>:<!--!ns!--><a href="versions.html#std-process">Trial Use</a></td></tr></table>

<p>
A security label is a <a href="datatypes.html#Coding">concept</a> attached to a resource
or bundle that provides specific security metadata about the information it is fixed to.
The <a href="security.html#access-control">Access Control decision engine</a>
uses the security label together with any provenance resources associated with
the resource and other metadata (e.g. the resource type, resource contents, etc.) to</p>
<ul>
  <li>approve read, change, and other operations</li>
  <li>determine what resources can be returned</li>
  <li>determine what handling caveats must be conveyed with the data</li>
</ul>
<p>
Security Labels enable more data to flow as they enable policy fragments to accompany the resource data.
</p>
<p>
The intent of a security label is that the recipient of resources or bundles with security-tags is obligated
to enforce the handling caveats of the tags and carry the security labels forward as appropriate.
</p>
<p>
Security labels are only a device to connect specific resources, bundles, or operations
to a wider security framework; a full set of policy and consent statements and their
consequent obligations is needed to give the labels meaning. Because of this,
security labels are most effective in fully trusted environments - that is,
where all trading partners have agreed to abide by them in a Mutual Trust
Framework. Note also that security labels support policy, and specific tagging
of individual resources is not always required to implement policy correctly.
</p>
<p>
In the absence of this kind of pre-agreement, Security Labels
may still be used by individual parties to assist with security role
checking, but they might not all be recognized and enforced, which in turn
limits what information can flow.
</p>
<p>
Local agreements and implementation profiles for the use security labels should
describe how the security labels connect to the relevant consent and policy
statements, and in particular:
</p>
<ul>
 <li>Which Security Labels are able to be used</li>
 <li>What to do if a resource has an unrecognized security label on it</li>
 <li>Authoring obligations around security labels</li>
 <li>Operational implications of security labels</li>
</ul>
<p>
This specification defines a basic set of labels for the most common
use cases trading partners, and a wider array of security labels
that allow much finer grained management of the information.
</p>

<a name="rsl"></a>

<h2>Representing Security Labels</h2>

<p>
A security label is represented as a <a href="datatypes.html#Coding">Coding</a>, with the
following important properties:
</p>
<table>
  <tr> <td>system</td> <td>The coding scheme from which label is taken (see <a href="terminologies-systems.html">code system URI</a>, and below) </td></tr>
  <tr> <td>code</td> <td>a code from the coding scheme that identifies the security label  and code is a value from the code system</td> </tr>
  <tr> <td>display</td> <td>The display form for the code (mostly for use when a system doesn't recognize the code)</td> </tr>
</table>

<div class="example">
<p>
An example XML Patient Resource with a "Restricted" tag associated with it, as represented in an HTTP response:
</p>
<pre>
&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;
  &lt;meta&gt;
    &lt;security&gt;
      &lt;system value=&quot;http://terminology.hl7.org/CodeSystem/v3-Confidentiality&quot;/&gt;
      &lt;code value=&quot;R&quot;/&gt;
      &lt;display value=&quot;Restricted&quot;/&gt;
    &lt;/security&gt;
  &lt;/meta&gt;
...  [snip] ...
&lt;/Patient&gt;
</pre>
<p>
A JSON search result that includes a resource that the receiving application must delete all copies of the resource after using it:
</p>
<pre>
{
  "resourceType" : "Bundle",
  "type" : "searchset",
  ... other headers etc.....
  "entry" : [
     ... other entries ....
     {
       "resource": {
         "id" : "1",
         "meta" : {
           "security" : [{
             "system" : "http://terminology.hl7.org/CodeSystem/v3-ActCode",
             "code" : "DELAU",
             "display" : "delete after use"
           }]
         }
         ... other content etc.....
       }
     },
     ... other entries ....
  ]
}
</pre>
</div>

<p>Note: the actual terms used in these examples are described below.</p>

<p>
The basic framework for security labels is described by the <a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=345">HL7 Healthcare Classification
System</a>. This specification identifies how security labels are defined and provides a
relatively comprehensive list of labels. All the HCS defined labels (see below for the lists)
can be used as security labels on FHIR resources and bundles (e.g. requests and responses).
</p>
<p>
In addition, other security labels not defined here or in the HCS can be defined by
jurisdictions, vendors and/or projects and used as appropriate. However, note that:
</p>
<ul>
 <li>Defining additional security labels will increase costs associated with information and system portability</li>
 <li>Implementation guides and applications SHOULD always use the applicable label defined by the HCS if one exists</li>
</ul>

<p>
Note: The use of security labels and the expression of common shared security
policies is a matter of ongoing discussion and development in several communities.
</p>

<a name="core"></a>
<h2>Core Security Labels</h2>
<p>
This specification defines a set of core security labels for all FHIR systems.
All conformant FHIR Applications SHOULD use these labels where appropriate.
For all these labels, how they are operationalized - their use and interpretation - is subject
to the applicable Mutual Trust Framework agreement as described above.
</p>

<table class="grid">
 <tr>
   <td><b>Name/ Tag</b></td>
   <td><b>Description</b></td>
 </tr>
 <tr>
   <td colspan="2" style="background-color: #EFEFEF"><b>Context of Use</b></td>
 </tr>
 <tr>
   <td>Purpose of Use</td>
   <td>
     These <a href="v3/PurposeOfUse/vs.html">Purpose of Use</a> (system = http://terminology.hl7.org/CodeSystem/v3-PurposeOfUse) is an indication of a reason for performing one or more operations on information.
	which may be permitted by source system's security policy in accordance with one or more privacy policies and consent directives. 
	Such as collecting personal health information for research or public health purposes.
	<br/> Notes may be used as:
     <ul>
      <li>The rationale or purpose for a request for data</li>
      <li>The use limitation on a data Bundle</li>
     </ul>
	See discussion on HCS below
   </td>
 </tr>
 <tr>
   <td colspan="2" style="background-color: #EFEFEF"><b>Data Sensitivity</b></td>
 </tr>
 <tr>
   <td>Confidentiality codes</td>
   <td>
     These <a href="v3/ConfidentialityClassification/vs.html">confidentiality class</a> (system = http://terminology.hl7.org/CodeSystem/v3-Confidentiality) can be applied to any resource or bundle. They are generally assigned by the author of the resource
     but can be modified subsequently as a matter of operational management. The Confidentiality classifications describe the sensitivity of the information in a resource about
     whether it should made available or disclosed to unauthorized individuals, entities, or processes.  <br/> Notes:
     <ul>
      <li>In the absence of a confidentiality code, the basic confidentiality of a resource may be implied by its definition and content; e.g. a patient's condition is far more likely to be confidential than a practitioner resource, and a Diagnostic Report with an HIV test is always highly confidential, whereas a routine electrolytes report is rarely particularly confidential</li>
      <li>The confidentiality of a bundle is always as confidential as the most confidential resource in the bundle</li>
     </ul>
     The additional security labels are more specific to support very specific fine-grained access control and should
     always be used in association with an appropriate confidentiality label. See discussion on HCS below
   </td>
 </tr>
 <tr>
   <td colspan="2" style="background-color: #EFEFEF"><b>Control of Flow</b></td>
 </tr>
 <tr>
   <td>Delete After Use: ActCode.<a href="v3/ActCode/cs.html#DELAU">DELAU</a></td>
   <td>
     An application receiving a resource with this label must delete all copies after the immediate use for which the data was exchanged, is complete. <br/> Notes:
     <ul>
      <li>This may imply a prohibition not storing the resource in any audit trail as well</li>
      <li>Additional security labels can make exceptions to the blanket restriction this implies. This allows a resource to be exchanged with a blanket rule not to retain copies unless the exact rules for retaining it can be followed</li>
     </ul>
   </td>
 </tr>

 <tr>
   <td>Do Not Re-use: ActCode.<a href="v3/ActCode/cs.html#NOREUSE">NOREUSE</a></td>
   <td>
     An application receiving a resource with this label may only use it for the immediate purpose of use. In particular, the application is not authorized to re-distribute (i.e. exchange this resource with any other application). <br/> Notes:
     <ul>
      <li>The exact interpretation of "immediate purpose of use" and the boundaries of "the application" are determined by local policy</li>
      <li>Additional security labels can make exceptions to the blanket restriction this implies. This allows a resource to be exchanged with a blanket rule not to re-use unless the exact rules for doing so can be followed</li>
     </ul>
   </td>
 </tr>

 <tr>
   <td>Test Data: ActCode.<a href="v3/ActCode/cs.html#HTEST">HTEST</a></td>
   <td>
     This marks that a resource has been created to test an application, and is not real production data<br/> Notes:
     <ul>
      <li>Most testing is performed on dedicated test systems where all the data is test data</li>
      <li>Some testing is performed on production systems, which is where this security label is used</li>
      <li>This is a security label because different access control rules may apply to test resources</li>
     </ul>
   </td>
 </tr>

</table>

<a name="break-the-glass"></a>
<h2>Break the Glass</h2>

<p>
There is a special security label to support the commonly encountered "break-the-glass" protocol,
where a clinician (usually in an emergency context) requests emergency
unauthorized access to the patient's record. 
</p>
<table class="grid">
 <tr>
   <td>Break the Glass</td>
   <td>http://hl7.org/fhir/security-label#break-the-glass</td>
   <td>
    The requester is asking for emergency access for patient treatment. Typically, this means that the patient is unconscious and not able to provide relevant information or consent.
   </td>
 </tr>
</table>
<p>
This <a href="v3/PurposeOfUse/vs.html">purpose of use</a> label is represented as a security 
label on the request, rather than on a resource, and so is represented in the request as a 
<a href="https://tools.ietf.org/html/draft-johnston-http-category-header-02">web category</a>:
</p>
<div>
<pre>
HTTP/1.1 GET fhir/Patient/482735/condition
Content-Type: text/xml
Access-Control-Allow-Origin: *
Last-Modified: Thu, 19 Nov 2013 07:07:32 +1100
ETag: 24
Category: http://terminology.hl7.org/CodeSystem/v3-ActReason#BTG; scheme="http://hl7.org/fhir/tag/security"; label="break the glass"
</pre>
</div>
[%dragons-start%]
<p>
While the principle of break-the-glass is well understood, implementing it well
has some challenges. This specification defines a method to represent break-the-glass
in an HTTP request, but does not define any policy or protocol around such requests.
At a minimum, implementations must ensure:
</p>
<ul>
 <li>How, when and why to initiate the break-the-glass is well understood</li>
 <li>Appropriate authorization, consent checking, and access control is used to ensure it is used properly (e.g. if using OAuth, checking that the Authorization Server allows this)</li>
 <li>Any use is well-represented in an <a href="auditevent.html">AuditEvent</a> break the glass <a href="auditevent-example-breakglass-start.html">example</a>.</li>
 <li>Note an example <a href="operationoutcome-example-break-the-glass.html">OperationOutcome that might be used to indicate potential for break-glass</a>.</li>
</ul>
<p>
See <a href="http://www.hl7.org/search/viewSearchResult.cfm?search_id=393442&amp;search_result_url=%2Fdocumentcenter%2Fpublic%2Fwg%2Fsecure%2FHL7%20Emergency%20Access%2Edoc">this paper</a> for
discussion of the issues involved in break-the-glass operations.
</p>
[%dragons-end%]

<a name="hcs"></a>
<h2>Healthcare Privacy and Security Classification System (HCS)</h2>

<p>
The security labels described above are a subset of the full set of security labels defined by the
HL7 <a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=345">Healthcare Privacy and Security Classification System</a>. 
The HCS defines 5 categories of security labels that may be applied to a resource:
</p>

<table class="grid">
 <tr> <td><b>Security Label</b></td> <td><b>Card.</b></td> <td><b>Values</b></td>  <td><b>Description</b></td> </tr>

 <tr> <td>Confidentiality Classification</td> <td>0..1</td> <td><a href="v3/ConfidentialityClassification/vs.html">ConfidentialityClassification</a></td>  <td>Security label metadata classifying an IT
resource (clinical fact, data, information
object, service, or system capability)
according to its level of sensitivity, which is
based on an analysis of applicable privacy
policies and the risk of financial,
reputational, or other harm to an individual
or entity that could result if made available
or disclosed to unauthorized individuals,
entities, or processes.
<br/>Example Uses: Unrestricted, Normal, Very restricted</td> </tr>

 <tr> <td>Sensitivity Category</td> <td>0..*</td> <td><a href="v3/InformationSensitivityPolicy/vs.html">InformationSensitivityPolicy</a></td>  <td>Security label metadata that "segments" an
IT resource by categorizing the value,
importance, and vulnerability of an IT
resource perceived as undesirable to share.
<br/>Example Uses: STDs, Psychiatric care, Celebrity status
</td> </tr>

 <tr> <td>Compartment Category</td> <td>0..*</td> <td><a href="v3/Compartment/vs.html">Compartment</a></td>  <td>Security label metadata that "segments" an
IT resource by indicating that access and
use is restricted to members of a defined
community or project
<br/>Note: this is a different use of "Compartment" to the <a href="compartmentdefinition.html">Patient Compartment</a> use.
<br/>Example Uses: Research, HR records
</td> </tr>

 <tr> <td>Integrity Category</td> <td>0..*</td> <td><a href="v3/SecurityIntegrityObservationValue/vs.html">SecurityIntegrityObservationValue</a></td>  <td>Security label metadata that "segments" an
IT resource by conveying the completeness,
veracity, reliability, trustworthiness, and
provenance of an IT resource
<br/>Example Uses: Anonymized, signed, patient reported

</td> </tr>

 <tr> <td>Handling Caveat</td> <td>0..*</td> <td><a href="v3/SecurityControlObservationValue/vs.html">SecurityControlObservationValue</a></td>  <td>Security label metadata conveying dissemination
controls and information handling instructions
such as obligations and retention policies to which an
IT resource custodian or receiver must comply.<br/>
This type of handling caveat SHALL be assigned
to a clinical fact if required by jurisdictional or
organizational policy, which may be triggered by a
patient consent directive
<br/>Example Uses: do not disclose, various restrictions on use, and policy marks
</td> </tr>
</table>

<p>
Each of these security labels identifies a <a href="valueset.html">ValueSet</a> that
lists a set of possible codes for the security label.
</p>

<a name="jurisdictions"></a>
<h3>Jurisdiction Specific Security Labels</h3>

<p>
The HL7 Healthcare Classification System also allows for Realm-specific privacy law or policy category codes for use in security labels in specific domains. These
domains are included with this specification:
</p>

<table class="grid">
 <tr> <td><b>Security Label</b></td> <td><b>Card.</b></td> <td><b>Values</b></td>  <td><b>Description</b></td> </tr>

 <tr> <td>US Privacy Law</td> <td>0..*</td> <td><a href="v3/ActUSPrivacyLaw/vs.html">ActUSPrivacyLaw</a></td>  <td>Security label metadata that "segments" an IT resource by indicating the legal provisions to which the assignment of a Confidentiality Classification complies in the US.

</td> </tr>

</table>



</div>

[%file newfooter%]


</body>
</html>
