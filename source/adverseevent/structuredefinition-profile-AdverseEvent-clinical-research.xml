<?xml version="1.0" encoding="UTF-8"?>

<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="AdverseEvent-clinical-research"/>
  <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-category">
    <valueString value="Clinical.Summary"/>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-security-category">
    <valueCode value="patient"/>
  </extension>
  <url value="http://hl7.org/fhir/StructureDefinition/AdverseEvent-clinical-research"/>
  <version value="0.1.0"/>
  <name value="AdverseEventClinicalResearch"/>
  <title value="Adverse Event Clinical Research"/>
  <status value="active"/>
  <date value="2022-06-14T10:06:34-06:00"/>
  <publisher value="Vulcan Accelerator"/>
  <contact>
    <name value="Vulcan Accelerator"/>
    <telecom>
      <system value="url"/>
      <value value="http://example.org/example-publisher"/>
    </telecom>
  </contact>
  <description value="An example profile of AdverseEvent for Research reporting."/>
  <fhirVersion value="5.0.0-snapshot1"/>
  <mapping>
    <identity value="rim"/>
    <uri value="http://hl7.org/v3"/>
    <name value="RIM Mapping"/>
  </mapping>
  <mapping>
    <identity value="w5"/>
    <uri value="http://hl7.org/fhir/fivews"/>
    <name value="FiveWs Pattern Mapping"/>
  </mapping>
  <mapping>
    <identity value="workflow"/>
    <uri value="http://hl7.org/fhir/workflow"/>
    <name value="Workflow Pattern"/>
  </mapping>
  <kind value="resource"/>
  <abstract value="false"/>
  <type value="AdverseEvent"/>
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/AdverseEvent"/>
  <derivation value="constraint"/>
  <differential>
    <element id="AdverseEvent">
      <path value="AdverseEvent"/>
	  
	  <constraint>
	    <key value="aeClinRes-1"/>
	    <severity value="error"/>
	    <human value="If serious is true then must have at least one seriousness criteria."/>
	    <expression value="serious = true implies (seriousnessCriteria.valueCodeableConcept.hasValue())"/>
		<xpath value="not(f:serious=true) or exists(f:seriousnessCriteria/f:valueCodeableConcept)"/>
	    <source value="http://hl7.org/fhir/StructureDefinition/AdverseEvent-clinical-research"/>
	  </constraint>
	  
    </element>
    <element id="AdverseEvent.extension">
      <path value="AdverseEvent.extension"/>
      <slicing>
        <discriminator>
          <type value="value"/>
          <path value="url"/>
        </discriminator>
        <ordered value="false"/>
        <rules value="open"/>
      </slicing>
    </element>
    <!--element id="AdverseEvent.extension:study-info-associated-with-AE">
      <path value="AdverseEvent.extension"/>
      <sliceName value="study-info-associated-with-AE"/>
      <min value="0"/>
      <max value="*"/>
      <type>
        <code value="Extension"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/study-info-associated-with-AE"/>
      </type>
    </element>
    <element id="AdverseEvent.extension:seriousness">
      <path value="AdverseEvent.extension"/>
      <sliceName value="seriousness"/>
      <short value="Investigator defined severity of the adverse event, in relation to the subject not the resulting condition"/>
      <min value="0"/>
      <max value="1"/>
      <type>
        <code value="Extension"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/seriousness"/>
      </type>
    </element>
    <element id="AdverseEvent.extension:severity-or-grade">
      <path value="AdverseEvent.extension"/>
      <sliceName value="severity-or-grade"/>
      <short value="Clinical Research Study subject who experienced the adverse event"/>
      <min value="0"/>
      <max value="1"/>
      <type>
        <code value="Extension"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/severity-or-grade"/>
      </type>
    </element-->
    <element id="AdverseEvent.actuality">
      <path value="AdverseEvent.actuality"/>
      <short value="actual"/>
      <patternCode value="actual"/>
    </element>
    <element id="AdverseEvent.seriousness">
      <path value="AdverseEvent.seriousness"/>
      <max value="0"/>
    </element>
    <!--element id="AdverseEvent.suspectEntity.extension">
      <path value="AdverseEvent.suspectEntity.extension"/>
      <slicing>
        <discriminator>
          <type value="value"/>
          <path value="url"/>
        </discriminator>
        <ordered value="false"/>
        <rules value="open"/>
      </slicing>
    </element>
    <element id="AdverseEvent.suspectEntity.extension:study-associated">
      <path value="AdverseEvent.suspectEntity.extension"/>
      <sliceName value="study-associated"/>
      <min value="0"/>
      <max value="1"/>
      <type>
        <code value="Extension"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/study-associated"/>
      </type>
    </element-->
	<element id="AdverseEvent.occurrence[x]">
      <extension url="http://hl7.org/fhir/build/StructureDefinition/committee-notes">
        <valueString value="GF#24681."/>
      </extension>
      <path value="AdverseEvent.occurrence[x]"/>
      <short value="When the event occurred"/>
      <definition value="The start date and end date when the adverse event occurred."/>
      <alias value="timing"/>
      <min value="0"/>
      <max value="1"/>
      <type>
        <code value="Period"/>
      </type>
      <isSummary value="true"/>
      <mapping>
        <identity value="workflow"/>
        <map value="Event.occurrence"/>
      </mapping>
      <mapping>
        <identity value="w5"/>
        <map value="FiveWs.done[x]"/>
      </mapping>
    </element>
    <element id="AdverseEvent.suspectEntity.causality">
      <path value="AdverseEvent.suspectEntity.causality"/>
      <min value="1"/>
      <mustSupport value="true"/>
    </element>
	<element id="AdverseEvent.suspectEntity.causality.entityRelatedness">
      <path value="AdverseEvent.suspectEntity.causality.entityRelatedness"/>
      <min value="1"/>
      <mustSupport value="true"/>
	  <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="AdverseEventCausalityAssessmentResearch"/>
        </extension>
        <strength value="preferred"/>
        <description value="Codes for the assessment of whether the entity caused the event."/>
        <valueSet value="http://hl7.org/fhir/ValueSet/adverse-event-causality-res-relatedness"/>
      </binding>
    </element>
	<element id="AdverseEvent.outcome">
      <extension url="http://hl7.org/fhir/build/StructureDefinition/committee-notes">
        <valueString value="J#27784."/>
      </extension>
      <path value="AdverseEvent.outcome"/>
	  <min value="1"/>
      <short value="Type of outcome from the adverse event"/>
      <definition value="Describes the type of outcome from the adverse event, such as resolved, recovering, ongoing, resolved-with-sequelae, or fatal."/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="AdverseEventOutcomeResearch"/>
        </extension>
        <strength value="preferred"/>
        <description value="Codes describing the type of outcome from the adverse event."/>
        <valueSet value="http://hl7.org/fhir/ValueSet/adverse-event-outcome-res"/>
      </binding>
    </element>
	<element id="AdverseEvent.study">
      <path value="AdverseEvent.study"/>
      <min value="1"/>
    </element>  
  </differential>
</StructureDefinition>