<!DOCTYPE HTML>

[%settitle Search (RESTful API) %]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<a name="base"></a>
<h2>Search</h2>
<table class="colsn"><tr><td id="wg"><a _target="blank" href="[%wg fhir%]">[%wgt fhir%]</a> Work Group</td><td id="fmm"><a href="versions.html#maturity">Maturity Level</a>: Normative</td><td id="ballot"><a href="versions.html#std-process">Standards Status</a>:<!--!ns!--><a href="versions.html#std-process">Normative</a></td></tr></table>
[%normative page infrastructure%]

<p>
Searching for resources is fundamental to the mechanics of FHIR.
Search operations traverse through an existing set of resources filtering by
parameters supplied to the search operation. The text below describes
the FHIR search framework, starting with simple cases moving to the more complex.
Implementers need only implement the amount of
complexity that they require for their implementations. Servers SHALL declare 
what features of search they require through their <a href="capabilitystatement.html#search-decl">CapabilityStatement
search declarations</a>, and clients are encouraged to do this too.
</p>

<a name="Contents"></a>
<h3>Contents</h3>
<ul>
  <li><a href="#introduction">Introduction</a>
	<ul>
	  <li><a href="#overview">Search Overview</a></li>
    <li><a href="#searchinputs">Search Inputs</a></li>
	  <li><a href="#searchcontexts">Search Contexts</a></li>
    <li><a href="#return">Search Responses</a>
      <ul>
        <li><a href="#returnbundletype">Bundle Type</a></li>
        <li><a href="#selflink">Self Link - Understanding a Performed Search</a></li>
        <li><a href="#paginglinks">Other Links - Paging</a></li>
        <li><a href="#entries">Matches, Inclusions, and Outcomes - Bundle Entries</a></li>
        <li><a href="#errors">Handling Errors</a></li>
      </ul>
    </li>
	</ul>
  </li>
  <li><a href="#transportprotocols">Transport Protocols</a>
    <ul>
      <li><a href="#basicspost">HTTP POST</a></li>
      <li><a href="#basicsget">HTTP GET</a></li>
      <li><a href="#getvspost">Choosing an HTTP Method</a></li>
      <li><a href="#batching">Batching Searches</a></li>
      <li><a href="#messaging">Search in Messaging</a></li>
    </ul>
  </li>
  <li><a href="#ptypes">Search Parameters</a>
    <ul>
      <li><a href="#multivalue">Searching Multiple Values (joining with AND or OR)</a></li>
      <li><a href="#modifiers">Modifiers</a></li>
      <li><a href="#prefix">Prefixes</a></li>
      <li><a href="#escaping">Escaping Search Parameters</a></li>
      <li>Basic Parameter Types: <a href="#date">date</a>, <a href="#number">number</a>, 
        <a href="#quantity">quantity</a>, <a href="#reference">reference</a>, 
        <a href="#string">string</a>, <a href="#token">token</a>, 
        <a href="#uri">uri</a></li>
	    <li>Extended Parameter Types: <a href="#composite">composite</a>, <a href="#special">special</a></li>
    </ul>
  </li>

  <li><a href="#specialconditions">Special Search Conditions</a>
    <ul>
      <li><a href="#specialidentifiers">Searching Identifiers</a>
        <ul>
          <li><a href="#identifierslogical">Logical Identifiers</a></li>
          <li><a href="#membership">Searching by Membership</a></li>
          <li><a href="#identifierreferences">Identifiers and References</a></li>
          <li><a href="#identifiercanonical">Canonical Identifiers</a></li>
        </ul>
      </li>
      <li><a href="#versions">References and Versions</a></li>
      <li><a href="#recursive">Searching Hierarchies</a></li>
	    <li><a href="#mimetype">Searching MIME Types</a></li>
      <li><a href="#chaining">Chaining (chained parameters)</a></li>
      <li><a href="#has">Reverse Chaining</a></li>
      <li><a href="#missing">Handling Missing Data</a></li>
      <li><a href="#filter">Advanced Filtering</a></li>
      <li><a href="#type">Searching Multiple Resource Types</a></li>
      <li><a href="#implicitresources">Implicit Resources</a></li>
      <li><a href="#advanced">Named Queries</a></li>
    </ul>
  </li>
  <li><a href="#modifyingresults">Modifying Search Results</a>
    <ul>
      <li><a href="#sort">Sorting (_sort)</a></li>
      <li><a href="#total">Total number of matching resources (_total)</a></li>
      <li><a href="#count">Limiting Page Size (_count)</a></li>
      <li><a href="#summary">Summary (_summary)</a></li>
      <li><a href="#elements">Selecting Elements (_elements)</a></li>
      <li><a href="#score">Relevance (_score)</a></li>
      <li><a href="#include">Including Referenced Resources</a>
        <ul>
          <li><a href="#_include">Inline Requests (_include, _revinclude)</a></li>
          <li><a href="#external">External References</a></li>
          <li><a href="#_graph">Graph Definitions (_graph)</a> <span class="stu">TU</span></li>
          <li><a href="#contained">Contained Resources (_contained)</a></li>
          <li><a href="#paging">Paging and Other Resources</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#standard">Standard Parameters</a>
    <ul>
      <li><a href="#all">Parameters for All Resources</a></li>
      <li><a href="#parameters">Parameters for Each Resource</a></li>
      <li><a href="#text">Text Search Parameters</a></li>
    </ul>
  </li>
  <li><a href="#conformance">Server Conformance</a></li>
  <li><a href="#currency">Search Result Currency</a></li>
  <li><a href="#conformancesummary">Conformance Summary</a></li>
  <li><a href="#summary">Summary Tables</a></li>
</ul>

<a name="introduction"></a>
<h3>Introduction</h3>
<p>
  FHIR Search is the primary mechanism used to find and list resource instances.  The search mechanism is designed to be flexible 
  enough to meet the needs of a wide variety of use cases, and yet be simple enough to be commonly useful.
</p>
<p>
  In a typical RESTful interface, collections of instances are returned as arrays of a type.  In 
  order to include related information (e.g., number of total results), support extended functionality
  (e.g., paging), and allow multiple resource types in results (e.g., returning Patient and Encounter resources), 
  FHIR Search instead returns a <a href="bundle.html">Bundle</a> resource, with a type of
  <a href="bundle.html#searchset">searchset</a>.  Resources included in the results appear as individual 
  entries in such a bundle. Note that the <code>_format</code>
  parameter works for search <a href="http.html#mime-type">like for other interactions</a>.  More information
  about returned contents and elements can be found in 
  <a href="#return">Managing Returned Resources</a>
</p>
<p>
  There are safety issues associated with the implementation of searching that implementers should always keep in mind. Implementers SHOULD review the <a href="safety.html#search">safety checklist</a>.
</p>

<a name="overview"></a>
<h4>Search Overview</h4>
<p>
  Though search operations are typically performed via REST, search is defined to be useful independently of HTTP.  
  Note that while different formats of search requests are functionally equivalent, there MAY be differences inherent 
  to searching via a particular protocol. Details can be found in <a href="#transportprotocols">Search Protocols</a>.
</p>

<a name="searchinputs"></a>
<h4>Search Inputs</h4>
<p>
  Input to search operations are referred to as <code>Search Parameters</code>.  A search parameter can be:
</p>
<ul>
  <li>a filter across <a href="#all">all resources</a> (e.g., <code>_id</code>, which is 
    present on every resource),</li>
  <li>a filter on a <a href="#parameters">specific resource</a> 
    (e.g., <code>Patient.birthDate</code>, which applies to the Patient resource,)</li>
  <li>a <a href="#content">textual search</a> across a resource, or</li>
  <li>a parameter that affects <a href="#return">search results</a>.</li>
</ul>
<p>
  There is a single page that lists <a href="searchparameter-registry.html">all the search parameters</a>
  published with this specification.  Note that search parameter names are case sensitive, though this 
  specification never defines different parameters with names that differ only in case. Clients SHOULD use 
  correct case, and servers SHALL NOT define additional parameters with different meanings with names that 
  only differ in case.
</p>
<p>
  Order of operations is not driven by order in the URL - with the exception of sort. First all filters are applied, 
  then the result set is sorted, then paging is applied, and then included resources (<code>_include</code>, 
  <code>_revinclude</code>) are added for each page.
</p>
<p>
  The server determines which of their resources meet the criteria
  contained in the search parameters as described below. However,
  the server has the prerogative to return additional search results
  if it believes them to be relevant. Note: There is a
  special search for the most relevant context in which the
  search set is indeterminate: <a href="patient.html#match">Patient MPI Search</a>.
</p>
<p>
  In the absence of any search filters, e.g. <code>GET [base]</code>, <code>GET [base]/Patient</code>, or
  <code>POST [base]/_search</code> or <code>POST [base]/Patient/_search</code> with no body, a server SHOULD
  return all records in scope of the search context.  Servers MAY reject a search as overly-broad, and SHOULD
  return an appropriate error in that situation (e.g., <a href="codesystem-issue-type.html#issue-type-too-costly">too-costly</a>).
</p>

<a name="searchcontexts"></a>
<h4>Search Contexts</h4>
<p>
<a href="http.html#search">Search operations</a> are executed in one of three defined contexts that control which 
set of resources are being searched:
</p>
<ul>
  <li>All resource types:
    Note that if the <code>_type</code> parameter is included, all other search parameters SHALL be 
    common to all provided types, and if <code>_type</code> is not included, all parameters SHALL be 
    common to all resource types.

    <span class='http-search-example'>
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class='http-verb-display'>
        <span class='http-verb-display-get'>GET [base]?parameter(s)</span>
        <span class='http-verb-display-post'>POST [base]/_search
Content-Type: application/x-www-form-urlencoded
parameter(s)</span>
      </span>
    </span>
  </li>
  <li>A specified resource type:
    <span class='http-search-example'>
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class='http-verb-display'>
        <span class='http-verb-display-get'>GET [base]/[type]?parameter(s)</span>
        <span class='http-verb-display-post'>
POST [base]/[type]/_search
Content-Type: application/x-www-form-urlencoded
parameter(s)
        </span>
      </span>
    </span>
  </li>
  <li>A specified <a href="compartmentdefinition.html">compartment</a>, perhaps with a specified resource type in that compartment.
    Note that the literal <code>*</code> (asterisk) is valid as the <code>[type]</code> in a GET-based compartment search.  This
    syntax is for disambiguation between an <a href="http.html#read">instance read</a> and a compartment search, which would 
    otherwise share the same URL.
    <span class='http-search-example'>
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class='http-verb-display'>
        <span class='http-verb-display-get'>GET [base]/[compartment]/[id]/[type]?parameter(s)</span>
        <span class='http-verb-display-post'>POST [base]/[compartment]/[id]/[type]/_search
Content-Type: application/x-www-form-urlencoded
parameter(s)</span>
      </span>
    </span>
  </li>
</ul>

<a name="return"></a>
<h3>Search Responses</h3>
<p>
  Search responses are always returned as a <a href="bundle.html">Bundle</a>.  Search result bundles convey a lot
  of metadata in addition to any possible results, using the various elements available in the bundle resource.
</p>
<p>
  The response to any search operation is always a list of resources in a Bundle.
  An alternative approach is to <a href="graphql.html">use GraphQL</a>.
</p>

<a name="returnbundletype"></a>
<h4>Bundle Type</h4>
<p>
  Search result bundles will always have the <code>Bundle.type</code> of <a href="bundle.html#searchset">searchset</a>.
  This element and value designate that the bundle is a search response and MAY be used in processing to indicate
</p>

<a name="selflink"></a>
<h4>Self Link - Understanding a Performed Search</h4>
<p>
  In order to allow the client to be confident about what search parameters
  were used as criteria by a server, servers SHALL return the parameters
  that were actually used to process a search. Applications processing search
  results SHALL check these returned values where necessary. For example, if
  a server did not support some of the filters specified in the search, a
  client might manually apply those filters to the retrieved result set,
  display a warning message to the user or take some other action.
</p>
<p>
  These parameters are encoded in the self link of the returned bundle - a <a href="bundle-definitions.html#Bundle.link">bundle.link</a>
  with the <code>relation</code> set to <code>self</code>:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">{
  "resourceType": "Bundle",
  "type": "searchset",
  ...
  "link": {
    "relation": "self",
    "url": "http://example.org/Patient?name=peter"
  }
  ...
}</span>
    <span class="example-format-display-xml">&lt;Bundle&gt;
  &lt;type value="searchset"/&gt;
  ...
  &lt;link&gt;
    &lt;relation value="self"/&gt;
    &lt;url value="http://example.org/Patient?name=peter"/&gt;
  &lt;/link&gt;
  ...
&lt;/Bundle&gt;</span>
  </span>
</span>
</p>
<p>
  Self links SHALL be expressed as an HTTP GET-based search with the relevant parameters included as query
  parameters, because of the semantics around the link types <span class="stu">TU</span>.  This means that the same self link is a 
  valid response for any equivalent search, regardless of how a search is performed (e.g., HTTP GET, HTTP POST, 
  Messaging, etc.).
</p>
<p>
  Self links MAY be returned as absolute URIs or URIs relative to the base URL of a server, and 
  MAY or MAY NOT be resolvable <span class="stu">TU</span>.  A server that does not support search via GET will return links
  in the same style as a server that does not support search via POST.  Note that this makes the 
  <code>self</code> link special in the context of bundle links, as all other links are intended
  to be resolvable by a client.
</p>
<p>
  Clients SHALL review the returned parameters in the self link to ensure proper processing of results.
  Generally, ignored parameters will result in clients receiving more results than intended.  In those
  situations, clients SHOULD filter received records to account for additional data <span class="stu">TU</span>.
</p>

<a name="paginglinks"></a>
<h4>Other Links - Paging</h4>
<p>
  In addition to the self link, many bundles MAY contain links relevant to paging.  These are identified
  via the <code>relation</code> value in the links.  Common links include: <code>first</code>, <code>last</code>,
  <code>next</code>, and <code>prev</code>.
</p>
<p>
  As with the self link, all relevant paging links SHALL be expressed as GET requests <span class="stu">TU</span>.  
  Servers SHOULD NOT include content that is considered sensitive in the URLs <span class="stu">TU</span>.
</p>

<a name="entries"></a>
<h4>Matches, Inclusions, and Outcomes - Bundle Entries</h4>
<p>
  Within the results bundle, there are three types of <a href="bundle-definitions.html#Bundle.entry">entries</a>
  that MAY be present, identified by the <a href="bundle-definitions.html#Bundle.entry.search.mode">search mode</a>
  of the entry: <code>match</code>, <code>include</code>, or <code>outcome</code>.
</p>
<p>
  Note that entries are unique (not allowed to repeat) and there is only one mode per entry. In some corner cases, a resource
  may be included because it is both a <code>match</code> and an <code>include</code>. In these circumstances, 
  <code>match</code> takes precedence.
</p>

<h5>Match</h5>
<p>
  Entries marked with <code>match</code> in search results indicate that a record is being returned because
  it meets the parameters specified in the search request (e.g., a record the client requested).
</p>

<h5>Include</h5>
<p>
  Entries marked with <code>include</code> in search results indicate that a record is being returned either
  because it is referred to from a record in the result set or that the server believes is useful or necessary
  for the client to process other results.
</p>

<h5>Outcome</h5>
<p>
  Entries marked with <code>outcome</code> in search results are <a href="operationoutcome.html">OperationOutcome</a>
  resources with information related to the processing of a search.  For example, a server MAY use an outcome record
  to report to a client that a search was unacceptable <span class="stu">TU</span>.
</p>

<a name="errors"></a>
<h4>Handling Errors</h4>
<p>
If a server is unable to execute a search request, it MAY either return an error for the request or return success
with an <code>outcome</code> containing details of the error <span class="stu">TU</span>. A HTTP status code of 
<code>403</code> signifies that the server refused to perform the search,
while other <code>4xx</code> and <code>5xx</code> codes signify that some sort of error has occurred. When
the search fails, a server SHOULD return an <a href="operationoutcome.html">OperationOutcome</a>
detailing the cause of the failure. Note that an empty search result is not an error.
</p>
<p>
In some cases, parameters may cause an error, or might not be able to match anything. For instance:
</p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table>
    <tr><td width="50%"><b>Issue</b></td><td><b>Search</b></td></tr>
    <tr>
      <td>A parameter may refer to a non-existent resource, such as if no Observation with an id of "101" exists</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?_id=101</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_id=101</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A parameter may reference a non-existent resource, such as if no Patient with MRN "1234" exists</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?patient.identifier=http://example.com/fhir/mrn|1234</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
patient.identifier=http://example.com/fhir/mrn|1234</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A parameter may refer to an unknown code, such as if LOINC code "1234-1" is not known to the server</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?code=loinc|1234-1</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code=loinc|1234-1</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A parameter may refer to a time that is out of scope, such as if the system only has data going back to 2001</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?onset=le1995</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
onset=le1995</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A parameter may use an illegal or unacceptable modifier, such as if the modifier cannot be processed by the server</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?onset:text=1995</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
onset:text=1995</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A data time parameter may have incorrect format, such as if the modifier cannot be processed by the server</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?onset=23%20May%202009</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
onset=23%20May%202009</span>
        </span>
      </td>
    </tr>
    <tr>
      <td>A parameter may be unknown or unsupported (more details below)</td>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?myInvalidParameter=true</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
myInvalidParameter=true</span>
        </span>
      </td>
    </tr>
  </table>
 </span>
<p>
Note: Empty parameters are not an error - they are just ignored by the server.
</p>
<p>
Where the content of the parameter is syntactically incorrect, servers SHOULD return an error.
However, where the issue is a logical condition (e.g. unknown subject or code), the server
SHOULD process the search, including processing the parameter - with the result of returning
an empty search set, since the parameter cannot be satisfied.
</p>
<p>
In such cases, the search process MAY include an <a href="operationoutcome.html">OperationOutcome</a>
in the search set that contains additional hints and warnings about the search process.
This is included in the search results as an entry with a <a href="bundle-definitions.html#Bundle.entry.search.mode">search mode</a> 
of <a href="valueset-search-entry-mode.html"><code>outcome</code></a>. Clients can use this information to 
improve future searches. If, for example, a client performed the following search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?patient.identifier=http://example.com/fhir/identifier/mrn|123456</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
patient.identifier=http://example.com/fhir/identifier/mrn|123456</span>
  </span>
</span>
and there is no patient for MRN 123456, the server may return a bundle with no results and a warning outcome, such as
<a href="bundle-search-warning.html">this</a>.
</p>

<p><b>Unknown and unsupported parameters</b></p>
<p>
Servers may receive parameters from the client that they do not recognize, or may
receive parameters they recognize but do not support (either in general, or for
a specific search). In general, servers SHOULD ignore unknown or unsupported parameters
for the following reasons:
</p>
<ul>
 <li>Various HTTP stacks and proxies may add parameters that aren't under the control of the client</li>
 <li>The client can determine what parameters the server used by examining the self link in the return (see <a href="#conformance">below</a>)</li>
</ul>
<p>
Clients can specify how the server should behave, by using the prefer header:
</p>
<ul>
 <li><code>Prefer: handling=strict</code>: Client requests that the server return an error for any unknown or unsupported parameter</li>
 <li><code>Prefer: handling=lenient</code>: Client requests that the server ignore any unknown or unsupported parameter</li>
</ul>
<p>
Servers SHOULD honor the client's request, but are not required to do so.  For more information,
see <a href="http.html#Http-Headers">HTTP Headers</a> on the HTTP Page.
</p>

<a name="transportprotocols"></a>
<h3>Transport Protocols</h3>
<p>
  This specification defines FHIR Search operations in both HTTP <code>POST</code> and <code>GET</code>.
  Servers supporting Search via HTTP SHALL support both modes of operation, though MAY return a 
  <code>HTTP 405</code> (Method Not Allowed) for <b>either</b> <code>POST</code> or <code>GET</code>, 
  but not both <span class="stu">TU</span>.
</p>

<a name="basicspost"></a>
<h4>HTTP POST</h4>
<p>
  Clients perform searches via HTTP POST by making an HTTP POST request to the appropriate context, with 
  search parameters included as <code>x-www-form-urlencoded</code> content for the post.  For example:
  <table>
    <tr>
      <td>Server Root</td>
      <td>
<pre>
POST [base]/_search
Content-Type: application/x-www-form-urlencoded
param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
    <tr>
      <td>Resource Type Search</td>
      <td>
<pre>
POST [base]/[resource-type]/_search
Content-Type: application/x-www-form-urlencoded
param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
    <tr>
      <td>Compartment Search</td>
      <td>
<pre>
POST [base]/[compartment-type]/[compartment-id]/_search
Content-Type: application/x-www-form-urlencoded
param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
    <tr>
      <td>Compartment and Resource Type Search</td>
      <td>
<pre>
POST [base]/[compartment-type]/[compartment-id]/[resource-type]/_search
Content-Type: application/x-www-form-urlencoded
param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
  </table>
</p>
<p>
  While servers SHALL support search parameters encoded in the POST body (as shown above), servers MAY also support
  including some or all parameters as query parameters on a POST request <span class="stu">TU</span>, e.g.:
</p>
<pre>
POST [base]/[type]/_search?param1=value&amp;...{&amp;_format=[mime-type]}
Content-Type: application/x-www-form-urlencoded
param2=value2&amp;...
</pre>
<p>
  Note that servers MAY impose restrictions on what parameters are allowed to be passed as query parameters on POST
  requests <span class="stu">TU</span>.  For example, a server could allow the <code>_format</code> query parameter
  but reject searches with a <code>Patient.name</code> query parameter.
</p>

<a name="basicsget"></a>
<h4>HTTP GET</h4>
<p>
  Clients perform searches via HTTP GET by making an HTTP GET request to the appropriate context, with 
  search parameters included as HTTP Query Parameters.  For example:
  <table>
    <tr>
      <td>Server Root</td>
      <td>
<pre>
GET [base]?param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
    <tr>
      <td>Resource Type Search</td>
      <td>
<pre>
GET [base]/[resource-type]/?param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
    <tr>
      <td>Compartment Search</td>
      <td>This search is not available because the search is indistinguishable from a READ operation.</td>
    </tr>
    <tr>
      <td>Compartment and Resource Type Search</td>
      <td>
<pre>
GET [base]/[compartment-type]/[compartment-id]/[resource-type]?param1=value&amp;...{&amp;_format=[mime-type]}
</pre>
      </td>
    </tr>
  </table>
</p>

<a name="getvspost"></a>
<h4>Choosing an HTTP Method</h4>
<p>
  As described above, servers that support search via REST SHALL support both the <code>GET</code> and <code>POST</code>
  methods <span class="stu">TU</span>. However, there are known use cases that prevent one or the other method from being desirable in production.
  For example, in the case of a large set of Endpoint resources (e.g., FHIR servers), infrastructure could be 
  configured to take advantage of HTTP caching mechanisms that do not function correctly on HTTP POST requests.
  Conversely, an implementation might not be able to properly secure Personal Health Information (PHI) that appears in request query parameters (e.g., 
  in HTTP logs made by infrastructure) and wants to require the use of HTTP POST for mitigation.
</p>
<p>
  Note that neither <code>GET</code> nor <code>POST</code> have any inherent benefits with respect to security or 
  privacy.  The use of various default software configurations in production have led some to believe that 
  <code>POST</code> is more secure because HTTP Body contents are not logged.  This is not due to any protocol 
  restrictions and should not be relied on.  Implementers should verify that their logging processes adequately protect PHI
  and other sensitive data.
</p>
<p>
  Given the above considerations, server implementers SHOULD be sure to test both <code>GET</code> and 
  <code>POST</code> search operations to ensure they are correct on their servers <span class="stu">TU</span>.  For example, a read-only server
  may prohibit the HTTP POST verb universally (returning a <code>405</code> - Method Not Allowed) and must then ensure 
  correct implementation of HTTP GET.
</p>
<p>
  Search requests may include sensitive information in the search parameters.  Therefore,
  secure communications and endpoint management are recommended, see <a href="security.html#http">Security Communications</a>
</p>

<a name="batching"></a>
<h4>Batching Search Requests</h4>
<p>
  Servers MAY support <a href="http.html#transaction">batching</a> multiple requests <span class="stu">TU</span>.  In the context of search, 
  this allows several searches to be performed serially via a single request.  Note that each operation of a <code>batch</code> is independent,
  so it is not possible to use the results of one request as input to another in the same batch.
</p>
<p>
  When submitting multiple requests via a batch or transaction, the returned bundle is for the batch or transaction as an operation.
  Therefore, two search requests in a batch would return a bundle that <em>contains</em> at least two entries, each of which is 
  the result of a search request (e.g., the batch result bundle will contain entries that are the search result bundles).
</p>
<p>
  When bundling requests via <code>batch</code> or <code>transaction</code>, HTTP verbs and the URLs for RESTful interfaces 
  are used.  When requesting searches in a bundle, systems SHOULD accept searches via GET, even if they do not typically accept GET-based 
  searches <span class="stu">TU</span>.  There is no standard way to convey POST-based searches within a Bundle and the architectural differences when searching via
  GET or POST are not relevant within a Bundle.  Servers receiving searches within a Bundle SHOULD NOT impose any GET-specific limitations 
  on search (i.e. restrictions not imposed on POST-based searches) that they would impose if the GET-based search had been received outside a Bundle <span class="stu">TU</span>.
</p>

<a name="messaging"></a>
<h4>Search via Messaging</h4>
<p>
  Servers MAY support FHIR <a href="messaging.html">Messaging</a>.  The mapping of seach requests into messages is described in more detail in 
  the section <a href="messaging.html#search">Invoking Search via Messages</a>.
</p>

<a name="ptypes"></a>
<h3>Search Parameters</h3>
<p>
  While search parameters are typically transmitted as URL-Encoded strings (e.g., HTTP Parameters or <code>x-www-form-urlencoded</code> body content),
  FHIR is modeled with a rich set of <a href="datatypes.html#primitive">primitive</a> and <a href="datatypes.html#complex">complex</a> datatypes to describe the data encountered in healthcare.  To provide consistent
  mapping between the two formats, each search parameter is defined by a type that specifies how the search parameter
  behaves.  These are the defined search parameter types:
</p>
<%linkcodelist http://hl7.org/fhir/search-param-type%>
<p>
  Individual search parameters MAY also allow "modifiers" that control their behavior.  The kinds of modifiers available 
  depend on the type of the search parameter.  More details can be found in the <a href="#modifiers">Modifiers</a> section
  of the search page.
</p>

<a name="multivalue"></a>
<a name="combining"></a>
<h4>Searching Multiple Values (joining with AND or OR)</h4>
<p>
  Multiple search parameters passed to a single search are used to create an intersection of the results.  In other words,
  multiple parameters are joined via "AND".  For example, a search for a patient that includes a given name and a
  family name will only return records that match BOTH:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?given=valueGiven&amp;family=valueFamily</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given=valueGiven&amp;family=valueFamily</span>
  </span>
</span>
  will return only Patient records with a family name of "valueFamily" and a given name of "valueGiven".
</p>
<p>
  In order to search for unions of results (values joined by "OR"), values can be separated by a comma (",") character.
  For example, a search for a patient with EITHER of two given names:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?given=valueGivenA,valueGivenB</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given=valueGivenA,valueGivenB</span>
  </span>
</span>
  will return Patient records with EITHER a given name of "valueGivenA" OR "valueGivenB".  This includes patient 
  record that have BOTH "valueGivenA" and "valueGivenB" (e.g., inclusive or).
</p>
<p>
  It is possible to combine both "AND" and "OR" type queries together in a single request.  For example, a 
  search that includes a family name and either of two given names:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?given=valueGivenA,valueGivenB&amp;family=valueFamily</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given=valueGivenA,valueGivenB&amp;family=valueFamily</span>
  </span>
</span>
  will return records that match a family name of "valueFamily" AND a given name of either "valueGivenA" OR 
  "valueGivenB".
</p>
<p>
  Note that there is not a syntax to request unions on different elements (OR joins).  For example,
  a client that wants records with either a given OR family name of "valueName".  However, it is possible to 
  define search parameters that operate on multiple elements.  For example, the described use case of searching 
  for a patient by any part of their name has a search parameter on Patient called <code>name</code>, which 
  matches any part of a name (e.g., <code>name=valueName</code>).  It is also possible to define
  <a href="#composite">composite search parameters</a>, which allows servers to provide this functionality.
</p>
<p>
  If a client wants results based on OR-joins of unrelated elements, or if there is not a combined search 
  parameter defined or supported on a server, the results can be retrieved by issuing multiple queries, 
  either serially or in a batch.
</p>

<a name="modifiers"></a>
<h4>Modifiers</h4>
<p>
  Generally, search parameters are used as filters to refine search results based on one or more resource elements. 
  For example, a query might find patients born in a certain year by using the <code>birthdate</code> search parameter,
  which maps to the <code>Patient.birthDate</code> element.  Sometimes it is necessary or desirable to use a search parameter with a 
  different behavior, for example, searching for patients that do not have a birth date in their records.  Instead 
  of requiring many search parameters on an element to cover each type of use, this specification defines <b>modifiers</b> 
  that can be used to change the meaning of a search parameter while leaving element mappings intact.
</p>
<p>
  Search parameter modifiers are defined by the <a href="codesystem-search-modifier-code.html">search-modifier-code</a> 
  code system. Search parameter definitions MAY include a list of allowed modifiers in the <code>SearchParameter.code</code> 
  element, which is bound to the <a href="valueset-search-modifier-code.html">search-modifier-code</a> value set.  Servers
  SHALL support any modifiers present in search parameters the server advertises support for.  Servers MAY choose to support
  additional modifiers.  Note that servers MAY support modifiers on types not defined in this specification.
</p>
<p>
  In search requests, search modifiers are used by appending the modifier as a suffix to the search parameter name, with the syntax
  of: <code>[name]:[modifier]</code>, such as <code>birthdate:missing</code>.  Note that only a single modifier is allowed on 
  a single search parameter.  If multiple layers of modification are necessary, a new search parameter can be defined with
  the appropriate behavior.  If the desired behavior is not possible to define in a search parameter without multiple stacked
  modifiers, an operation can be defined.
</p>
<p>
  Since modifiers change the meaning of a search parameter, a server SHALL reject any search request that contains a search 
  parameter with an unsupported modifier.  For example, if the server supports the <code>name</code> search parameter, 
  but not the <code>:exact</code> modifier on the name, it would reject a search with the parameter <code>name:exact=Bill</code>, 
  using an HTTP <code>400</code> error with an <a href="operationoutcome.html">OperationOutcome</a> with a 
  <a href="operationoutcome-example-searchfail.html">clear error message</a>.
</p>
<p>
  While support for modifiers is applied per search parameter, modifiers are generally defined according to search parameter type.  
  For example, the ":exact" modifier has meaning when applied to string-type search parameters but has no meaning and cannot
  be used with token-type search parameters.  The exception is the search parameters type <a href="#special">special</a>.  The
  definition for any search parameter of type "special" SHALL explicitly list any allowed modifiers; this list MAY include any
  value from the <a href="codesystem-search-modifier-code.html">search-modifier-code</a> code system.
</p>
<p>
  The modifiers defined by this specification are:
</p>
<table class="grid">
  <tr>
    <td><code><a href="#modifierabove">above</a></code></td>
    <td><a href="#reference">reference</a>, <a href="#token">token</a>, <a href="#uri">uri</a></td>
    <td>
      Tests whether the value in a resource is or subsumes the supplied parameter value (is-a, or hierarchical relationships).
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifierbelow">below</a></code></td>
    <td><a href="#reference">reference</a>, <a href="#token">token</a>, <a href="#uri">uri</a></td>
    <td>
      Tests whether the value in a resource is or is subsumed by the supplied parameter value (is-a, or hierarchical relationships).
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifiercodetext">code-text</a></code> <span class="stu">TU</span> </td>
    <td><a href="#reference">reference</a>, <a href="#token">token</a></td>
    <td>
      Tests whether the textual display value in a resource (e.g., <code>CodeableConcept.text</code>, <code>Coding.display</code>, 
      or <code>Reference.display</code>) matches the supplied parameter value.
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifiercontains">contains</a></code></td>
    <td><a href="#string">string</a>, <a href="#uri">uri</a></td>
    <td>
      Tests whether the value in a resource includes the supplied parameter value anywhere within the field being searched.
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifierexact">exact</a></code></td>
    <td><a href="#string">string</a></td>
    <td>
      Tests whether the value in a resource exactly matches the supplied parameter value (the whole string, including casing and accents).
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifieridentifier">identifier</a></code></td>
    <td><a href="#reference">reference</a></td>
    <td>
      Tests whether the <code>Reference.identifier</code> in a resource (rather than the <code>Reference.reference</code>) matches
      the supplied parameter value.
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifierin">in</a></code></td>
    <td><a href="#token">token</a></td>
    <td>
      Tests whether the value in a resource is a member of the supplied parameter ValueSet.
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifieriterate">iterate</a></code></td>
    <td>n/a (not allowed anywhere by default)</td>
    <td>
      The search parameter indicates an inclusion directive (_include, _revinclude) that is applied to an included resource instead of the matching resource.
    </td>
  </tr>
  <tr>
    <td><code><a href="#modifiermissing">missing</a></code></td>
    <td>
      <a href="#date">date</a>, <a href="#number">number</a>, <a href="#quantity">quantity</a>, 
      <a href="#reference">reference</a>, <a href="#string">string</a>, <a href="#token">token</a>, 
      <a href="#uri">uri</a>
    </td>
    <td>
      Tests whether the value in a resource is present (when the supplied parameter value is <code>true</code>) or
      absent (when the supplied parameter value is <code>false</code>).
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiernot">not</a></code></td>
    <td><a href="#token">token</a></td>
    <td>
      Tests whether the value in a resource does not match the specified parameter value. Note that this includes 
      resources that have no value for the parameter.
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiernotin">not-in</a></code></td>
    <td><a href="#reference">reference</a> <span class="stu">TU</span> , <a href="#token">token</a></td>
    <td>
      Tests whether the value in a resource is not a member of the supplied parameter ValueSet.
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifieroftype">of-type</a></code></td>
    <td><a href="#token">token</a> (only <a href="datatypes.html#Identifier">Identifier</a>)</td>
    <td>
      Tests whether the <code>Identifier</code> value in a resource matches the supplied parameter value.
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiertexttoken">text</a></code></td>
    <td><a href="#reference">reference</a> <span class="stu">TU</span> , <a href="#token">token</a></td>
    <td>
      Tests whether the textual value in a resource (e.g., <code>CodeableConcept.text</code>, <code>Coding.display</code>, 
      <code>Identifier.type.text</code>, or <code>Reference.display</code>) matches the supplied parameter value using 
      basic string matching (begins with or is, case-insensitive).
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiertextstring">text</a></code></td>
    <td><a href="#string">string</a></td>
    <td>
      The search parameter value should be processed as input to a search with advanced text handling.
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiertextadvanced">text-advanced</a></code> <span class="stu">TU</span> </td>
    <td><a href="#reference">reference</a>, <a href="#token">token</a></td>
    <td>
      Tests whether the value in a resource matches the supplied parameter value using advanced text handling that searches
      text associated with the code/value - e.g.,
      <code>CodeableConcept.text</code>, <code>Coding.display</code>, or <code>Identifier.type.text</code>.
    </td>
   </tr>
   <tr>
    <td><code><a href="#modifiertype">[type]</a></code></td>
    <td><a href="#reference">reference</a></td>
    <td>
      Tests whether the value in a resource points to a resource of the supplied parameter type.
      Note: a concrete <code>ResourceType</code> is specified as the modifier (e.g., not the literal <code>:[type]</code>,
      but a value such as <code>:Patient</code>).
    </td>
   </tr>
  </table>

  <a name="modifierabove"></a>
  <h5>above</h5>
  <p>
    The <code>above</code> modifier allows clients to search hierarchies of data based on relationships.  The <code>above</code> modifier is only
    allowed on search parameters of type <a href="#reference">reference</a>, <a href="#token">token</a>, and <a href="#uri">uri</a>.
    The exact semantics for use vary depending on the type of search parameter:
  </p>

  <h6>above with <em>reference</em> type search parameters</h6>
  <p>
    When the <code>above</code> modifier is used with a <a href="#reference">reference</a> type search parameter, the search is interpreted
    as a hierarchical search on linked resources of the same type, including exact matches and all parents of those matches.  The <code>above</code> 
    modifier is only valid for <a href="references.html#circular">circular</a> references - that is, references that point to another instance of the 
    same type of resource (e.g., a hierarchy of Location resources).  Further discussion about the requirements and uses for this type of search can
    be found in the section <a href="#recursive">Searching Hierarchies</a>.
  </p>
  <p>
    When using the <code>above</code> modifier on a reference, all typically-valid search parameter reference inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Procedure?location:above=A101</span>
        <span class="http-verb-display-post">POST [base]/Procedure/_search
Content-Type: application/x-www-form-urlencoded
location:above=A101</span>
      </span>
    </span>
    would match any Procedure resources with locations:
    <ul>
      <li><code>A101</code>, <code>Location/A101</code>, <code>https://example.org/Location/A101</code> - this location by ID</li>
      <li><code>A100</code>, <code>Location/A100</code>, <code>https://example.org/Location/A100</code> - parent of A101, representing the first floor (A101 - A199)</li>
      <li><code>BuildingA</code>, <code>Location/BuildingA</code>, <code>https://example.org/Location/BuildingA</code> - parent of A100, representing the building 'A'</li>
    </ul>
  </p>

  <h6>above with <em>canonical references</em></h6>
  <p>
    When the <code>above</code> modifier is used with a <a href="#reference">reference</a> against a <a href="datatypes.html#canonical">canonical</a>
    reference, the search is interpreted as a version search against the canonical resource.  The format of the parameter is either 
    <b><code>[url]</code></b> or <b><code>[url]|[version]</code></b>.  This search is only allowed if the version scheme for the
    resource is known (e.g., a known version-scheme extension or element).  Version-related search criteria against 
    resources with unknown versioning schemes SHALL be either ignored or rejected <span class="stu">TU</span>.  The <code>above</code>
    modifier comparison is performed as a 'greater than' against the version-scheme defined by the resource.
  </p>
  <p>
    When using the <code>above</code> modifier on a canonical reference, all typically-valid search parameter token inputs are allowed.  Note that any
    vertical pipe (<code>|</code>) characters that are part of the URL must be escaped (<code>%7C</code>) - the character is used as the separator between
    the URL and version components of the parameter.
  </p>
  <p>
    More information can be found in the section <a href="#versions">References and Versions</a>.
  </p>

  <h6>above with <em>token</em> type search parameters</h6>
  <p>
    When the <code>above</code> modifier is used with a <a href="#token">token</a> type search parameter, the supplied token is a concept with the
    form <code>[system]|[code]</code> and the intention is to test whether the coding in a resource <a href="codesystem.html#subsumption">subsumes</a> the 
    specified search code.  Matches to the input token concept have an is-a relationship with the coding in the resource, and this includes the coding itself.
  </p>
  <p>
    When using the <code>above</code> modifier on a token, all typically-valid search parameter token inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?code:above=http://snomed.info/sct|3738000</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code:above=http://snomed.info/sct|3738000</span>
      </span>
    </span>
    for Observations with a code <code>above</code> SNOMED 'Viral hepatitis (disorder)' will match any Observation resources with codes:
    <ul>
      <li>SNOMED <code>3738000</code> - Viral hepatitis (this code)</li>
      <li>SNOMED <code>235862008</code> - Hepatitis due to infection (parent of 'Viral hepatitis')</li>
      <li>SNOMED <code>128241005</code> - Inflammatory disease of liver (parent of 'Hepatitis due to infection')</li>
      <li>Etc.</li>
      <li>SNOMED <code>312130009</code> - Viral infection by site (parent of 'Viral hepatitis')</li>
      <li>SNOMED <code>301810000</code> - Infection by site (parent of 'Viral infection by site')</li>
      <li>Etc.</li>
    </ul>

    Note that there are two hierarchical parents to the requested code and parent matches traverse up each path.
  </p>

  <h6>above with <em>uri</em> type search parameters</h6>
  <p>
    When the <code>above</code> modifier is used with a <a href="#uri">uri</a> type search parameter, the value is used for partial matching
    based on URL path segments.  Because of the hierarchical behavior of <code>above</code>, the modifier only applies to URIs that are URLs and cannot
    be used with URNs such as OIDs.  Note that there are not many use cases where <code>above</code> is useful compared to a <code>below</code> search.
  </p>
  <p>
    When using the <code>above</code> modifier on a uri, all typically-valid search parameter uri inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/ValueSet?url:above=http://acme.org/fhir/ValueSet/123/_history/5</span>
        <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url:above=http://acme.org/fhir/ValueSet/123/_history/5</span>
      </span>
    </span>
    would match any ValueSet resources with a url of:
    <ul>
      <li><code>http://acme.org/fhir/ValueSet/123/_history/5</code> - full match</li>
      <li><code>http://acme.org/fhir/ValueSet/123/_history</code> - parent of requested URI</li>
      <li><code>http://acme.org/fhir/ValueSet/123</code> - ancestor of requested URI</li>
      <li><code>http://acme.org/fhir/ValueSet</code> - ancestor of requested URI</li>
      <li><code>http://acme.org/fhir</code> - ancestor of requested URI</li>
      <li><code>http://acme.org/</code> - ancestor of requested URI</li>
    </ul>
  </p>
  
  <a name="modifierbelow"></a>
  <h5>below</h5>
  <p>
    The <code>below</code> modifier allows clients to search hierarchies of data based on relationships.  The <code>below</code> modifier is only
    allowed on search parameters of type <a href="#reference">reference</a>, <a href="#token">token</a>, and <a href="#uri">uri</a>.
    The exact semantics for use vary depending on the type of search parameter:
  </p>

  <h6>below with <em>reference</em> type search parameters - hierarchical searches</h6>
  <p>
    When the <code>below</code> modifier is used with a <a href="#reference">reference</a> type search parameter, the search is interpreted
    as a hierarchical search on linked resources of the same type, including exact matches and all children of those matches.  The <code>below</code> 
    modifier is only valid for <a href="references.html#circular">circular</a> <b>?? recursive instead of circular here ??</b> references - that is, references that point to another instance of the 
    same type of resource (e.g., a hierarchy of Location resources).  Further discussion about the requirements and uses for this type of search can
    be found in the section <a href="#recursive">Searching Hierarchies</a>.
  </p>
  <p>
    When using the <code>below</code> modifier on a hierarchical reference, all typically-valid search parameter reference inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Procedure?location:below=BuildingA</span>
        <span class="http-verb-display-post">POST [base]/Procedure/_search
Content-Type: application/x-www-form-urlencoded
location:below=BuildingA</span>
      </span>
    </span>
    for Procedures with a location <code>below</code> BuildingA would match any Procedure resources with locations:
    <ul>
      <li><code>BuildingA</code>, <code>Location/BuildingA</code>, <code>https://example.org/Location/BuildingA</code> - this location by ID</li>
      <li><code>A100</code>, <code>Location/A100</code>, <code>https://example.org/Location/A100</code> - child of BuildingA, representing the first floor</li>
      <li><code>A101</code>, <code>Location/A101</code>, <code>https://example.org/Location/A101</code> - child of A100, room 101</li>
      <li><code>A1..</code>, etc. - child of A100, rooms on the first floor</li>
      <li><code>A200</code>, <code>Location/A200</code>, <code>https://example.org/Location/A200</code> - child of BuildingA, representing the second floor</li>
      <li>Etc.</li>
    </ul>
  </p>

  <h6>below with <em>canonical references</em></h6>
  <p>
    When the <code>below</code> modifier is used with a <a href="#reference">reference</a> against a <a href="datatypes.html#canonical">canonical</a>
    reference, the search is interpreted as a version search against the canonical resource.  The format of the parameter is either 
    <b><code>[url]</code></b> or <b><code>[url]|[version]</code></b>.  This search is only allowed if the version scheme for the
    resource is known (e.g., a known version-scheme extension or element).  Version-related search criteria against 
    resources with unknown versioning schemes SHALL be either ignored or rejected <span class="stu">TU</span>.  The <code>below</code>
    modifier comparison is performed as a 'less than' against the version-scheme defined by the resource.
  </p>
  <p>
    When using the <code>below</code> modifier on a canonical reference, all typically-valid search parameter token inputs are allowed.  Note that any
    vertical pipe (<code>|</code>) characters that are part of the URL must be escaped (<code>%7C</code>) - the character is used as the separator between
    the URL and version components of the parameter.
  </p>
  <p>
    More information can be found in the section <a href="#versions">References and Versions</a>.
  </p>

  <h6>below with <em>token</em> type search parameters</h6>
  <p>
    When the <code>below</code> modifier is used with a <a href="#token">token</a> type search parameter, the supplied token is a concept with the
    form <code>[system]|[code]</code> and the intention is to test whether the coding in a resource <a href="codesystem.html#subsumption">is subsumed by</a> the 
    specified search code.  Matches include resources that have a coding that has an is-a relationship with the input concept, and this includes the coding itself.
  </p>
  <p>
    When using the <code>below</code> modifier on a token, all typically-valid search parameter token inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?code:below=http://snomed.info/sct|235862008</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code:below=http://snomed.info/sct|235862008</span>
      </span>
    </span>
    for Observations with a code <code>below</code> SNOMED 'Hepatitis due to infection' would match any Observation resources with codes:
    <ul>
      <li>SNOMED <code>235862008</code> - Hepatitis due to infection (this code)</li>
      <li>SNOMED <code>773113008</code> - Acute infectious hepatitis (child)</li>
      <li>SNOMED <code>95897009</code> - Amebic hepatitis (child)</li>
      <li>Etc.</li>
    </ul>
  </p>
  <p>
    Note that there is no limit inherent to the referential search.  If child concepts contain child concepts of their own, the search
    continues down the tree in each path until reaching a terminal node.
  </p>
  <p>
    The <code>below</code> modifier is useful when trying to resolve MIME types.  Further documentation can be found in the
    <a href="#mimetype">Searching MIME Types</a> section of this page.
  </p>

  <h6>below with <em>uri</em> type search parameters</h6>
  <p>
    When the <code>below</code> modifier is used with a <a href="#uri">uri</a> type search parameter, the value is used for partial matching
    based on URL path segments.  Because of the hierarchical behavior of <code>below</code>, the modifier only applies to URIs that are URLs and cannot
    be used with URNs such as OIDs.
  </p>
  <p>
    When using the <code>below</code> modifier on a uri, all typically-valid search parameter uri inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/ValueSet?url:below=http://acme.org/fhir</span>
        <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url:above=http://acme.org/fhir</span>
      </span>
    </span>
    would match any ValueSet resources with a url of:
    <ul>
      <li><code>http://acme.org/fhir</code> - full match</li>
      <li><code>http://acme.org/fhir/ValueSet</code> - child of requested URI</li>
      <li><code>http://acme.org/fhir/ValueSet/123</code> - descendant of requested URI</li>
      <li><code>http://acme.org/fhir/ValueSet/123/_history</code> - descendant of requested URI</li>
      <li><code>http://acme.org/fhir/ValueSet/123/_history/1</code> - descendant of requested URI</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifiercodetext"></a>
  <h5>code-text <span class="stu">TU</span></h5>
  <p>
    The <code>code-text</code> modifier allows clients to indicate that a supplied <code>string</code> input should be matched
    as a case-insensitive and combining-character insensitive match against the start of target string.  This modifier is used
    to do a 'standard' string search against code values.  Note that the handling of extended 
    <a href="http://unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">grapheme clusters</a> is within the discretion of 
    the server, i.e. the server decides if a search parameter matches on canonically equivalent characters or matches on
		the actual used Unicode code points.
  </p>
  <p>
    <code>code-text</code> is only allowed on <a href="#reference">reference</a> and <a href="#token">token</a>
    type search parameters. When using the 'code-text' modifier, all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?language:code-text=en</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
language:code-text=EN</span>
      </span>
    </span>
    would match any Patient resources with a communication language of:
    <ul>
      <li><code>en</code> - requested code text (case-insensitive)</li>
      <li><code>en-AU</code> - starts with requested code text (case-insensitive)</li>
      <li><code>en-CA</code> - starts with requested code text (case-insensitive)</li>
      <li><code>en-GB</code> - starts with requested code text (case-insensitive)</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifiercontains"></a>
  <h5>contains</h5>
  <p>
    The <code>contains</code> modifier allows clients to indicate that a supplied <code>string</code> input should be matched
    as a case-insensitive and combining-character insensitive match anywhere in the target string. Note that the handling of extended 
    <a href="http://unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">grapheme clusters</a> is within the discretion of 
    the server, i.e. the server decides if a string search parameter matches on canonically equivalent characters or matches on
		the actual used Unicode code points.
  </p>
  <p>
    <code>contains</code> is allowed on <a href="#string">string</a> and <a href="search.html">uri</a> type search 
    parameters. When using the 'contains' modifier, all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?family:contains=son</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
family:contains=son</span>
      </span>
    </span>
    would match any Patient resources with a family names such as:
    <ul>
      <li><code>Son</code> - requested string (case-insensitive)</li>
      <li><code>Sonder</code> - begins with requested string (case-insensitive)</li>
      <li><code>Erikson</code> - ends with requested string (case-insensitive)</li>
      <li><code>Samsonite</code> - contains requested string (case-insensitive)</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifierexact"></a>
  <h5>exact</h5>
  <p>
    The <code>exact</code> modifier allows clients to indicate that a supplied <code>string</code> input is the complete and 
    exact value that should be matched, including casing and combining characters. Note that the handling of extended 
    <a href="http://unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">grapheme clusters</a> is within the discretion of 
    the server, i.e. the server decides if a string search parameter matches on canonically equivalent characters or matches on
		the actual used Unicode code points.
  </p>
  <p>
    <code>exact</code> is only allowed on <a href="#string">string</a> type search parameters. When using the 'exact' modifier,
    all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?family:exact=Son</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
family:exact=Son</span>
      </span>
    </span>
    will <em>only</em> match Patient resources with a family name of:
    <ul>
      <li><code>Son</code> - requested string (case-sensitive)</li>
    </ul>
  </p>

  <a name="modifieridentifier"></a>
  <h5>identifier</h5>
  <p>
    The <code>identifier</code> modifier allows clients to indicate that a supplied <code>token</code> should be used to
    match against the <a href="references-definitions.html#Reference.identifier">identifier</a> element of a reference instead
    of the <a href="references-definitions.html#Reference.reference">reference</a> element.  The format of the parameter is
    <b><code>[system]|[code]</code></b>.  Note that chaining is not supported when using the <code>identifier</code> modifier 
    and the modifier is not supported on canonical elements since they do not have an identifier separate from the reference itself.
  </p>
  <p>
    <code>identifier</code> is only allowed on <a href="#reference">reference</a> type search parameters. When using the 'identifier' modifier,
    all typically-valid search parameter token inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?subject:identifier=http://example.org/fhir/mrn|12345</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject:identifier=http://example.org/fhir/mrn|12345</span>
      </span>
    </span>
    for observations with a subject containing the identifier 'http://example.org/fhir/mrn|12345' would match Observation resources such as:
    <span class="fhir-example">
      <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
      <span class="example-format-display">
        <span class="example-format-display-json">"Observation": {
  "subject": {
    "reference": "Patient/abc",
    "identifier": {
      "system": "http://example.org/fhir/mrn",
      "value": "12345"
    }
  }
}</span>
        <span class="example-format-display-xml">&lt;Observation&gt;
  &lt;subject&gt;
    &lt;reference value="Patient/abc"/&gt;
    &lt;identifier&gt;
      &lt;system value="http://example.org/fhir/mrn"/&gt;
      &lt;value value="12345"/&gt;
    &lt;/identifier&gt;
  &lt;/subject&gt;
&lt;/Observation&gt;</span>
      </span>
    </span>
    but <b>will not</b> match:
    <span class="fhir-example">
      <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
      <span class="example-format-display">
        <span class="example-format-display-json">"Observation": {
  "subject": {
    "reference": "Patient/abc"
  }
}</span>
        <span class="example-format-display-xml">&lt;Observation&gt;
  &lt;subject&gt;
    &lt;reference value="Patient/abc"/&gt;
  &lt;/subject&gt;
&lt;/Observation&gt;</span>
      </span>
    </span>
    even if the Patient resource for <code>Patient/abc</code> includes the requested identifier among its 
    <code>Patient.identifier</code> values.
  </p>
  <p>
    For more details about the difference between the <code>identifier</code> modifier and chained-searches on the 
    identifier element, see <a href="#specialidentifiers">Searching Identifiers</a>.
  </p>

  <a name="modifierin"></a>
  <h5>in</h5>
  <p>
    The <code>in</code> modifier is used to filter based on value membership of codes in Value Sets.  The <code>in</code> 
    modifier is only allowed on <a href="#token">token</a> type search parameters.
  </p>
  <p>
    When the <code>in</code> modifier is used with a <a href="#token">token</a> search parameter, the input is
    a <a href="#uri">uri</a>  (relative or absolute) that identifies a value set, and the search parameter 
    tests whether the coding is in the specified value set. The reference may be literal (to an address where 
    the value set can be found) or logical (a reference to <code>ValueSet.url</code>). If the server can treat 
    the reference as a literal URL, it does, else it tries to match known logical ValueSet.url values.  Note 
    that the URI need not point to the root value set, <code>http://snomed.info/sct?fhir_vs=isa/235862008</code>
    is a valid reference to a subset of SNOMED CT 'Hepatitis due to infection', but the parameter value will
    need to be URL Encoded in order to be a valid parameter.
  </p>
  <p>
    When using the <code>in</code> modifier on a token, only tokens targeting value sets are allowed (e.g., 
    a boolean token parameter target is not allowed).
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:in=ValueSet/123</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:in=ValueSet/123</span>
      </span>
    </span>
    would match any conditions that contain any code from 'ValueSet/123'.
  </p>
  <p>
    Similarly, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F235862008</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F235862008</span>
      </span>
    </span>
    would match any conditions that contain any code from 'http://snomed.info/sct?fhir_vs=isa/235862008', e.g.:
    <ul>
      <li>SNOMED <code>235862008</code> - Hepatitis due to infection (this code)</li>
      <li>SNOMED <code>773113008</code> - Acute infectious hepatitis (is-a 235862008)</li>
      <li>SNOMED <code>95897009</code> - Amebic hepatitis (is-a 235862008)</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifieriterate"></a>
  <h5>iterate</h5>
  <p>
    The <code>iterate</code> modifier is used to indicate that an inclusion directive 
    should be applied to an included resource instead of the matching resource.  Note
    that this modifier is not defined for any search parameter types.  This modifier
    can only be applied to the search result parameters of <code>_include</code> and
    <code>_revinclude</code>.
  </p>
  <p>
    When the <code>iterate</code> modifier is used, the input provided is the same as
    the input for the inclusion directive (see <a href="#include">Including other resources</a>).
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?code=http://snomed.info/sct|3738000&amp;_include=Observation:patient&amp;_include:iterate=Patient:link</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code=http://snomed.info/sct|3738000&amp;_include=Observation:patient&amp;_include:iterate=Patient:link</span>
      </span>
    </span>
    would match any observations with the SNOMED code <code>3738000</code> (Viral hepatitis (disorder)).  
    The results would include resources from following the search reference <code>Observation.patient</code>,
    which are <code>Patient</code> resources linked via <code>Observation.subject</code>. Additionally, the 
    server would <i>iterate</i> through the included patient records and follow the <code>Patient.link</code> 
    references, including linked <code>Patient</code> or <code>RelatedPerson</code> resources.
  </p>
  <p>
    More information can be found in the section <a href="#include">Including other resources</a>
  </p>

  <a name="modifiermissing"></a>
  <h5>missing</h5>
  <p>
    The <code>missing</code> modifier allows clients to filter based on whether resources contain values that <i>can</i> match 
    a search parameter.  Usually, this equates to testing if a resource has an element or not.
  </p>
  <p>
    <code>missing</code> is allowed on search parameter types that represent single-elements: <a href="#date">date</a>, 
    <a href="#number">number</a>, <a href="#quantity">quantity</a>, <a href="#reference">reference</a>, 
    <a href="#string">string</a>, <a href="#token">token</a>, <a href="#uri">uri</a>. When using the 'missing' modifier,
    the only valid input values are the literal values <code>true</code> and <code>false</code>.
  </p>
  <p>
    Searching for <code>[parameter]:missing=true</code> requests all resources that <b>do not</b> have a value in the matching element
    or where the element is present with extensions, but no <code>value</code> is specified.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?given:missing=true</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given:missing=true</span>
      </span>
    </span>
    would match any Patient records that do not have <em>any</em> value in <code>Patient.name</code> that contains a value for <code>given</code>,
    even if a patient contains a <code>Patient.name</code> that has a <code>given</code> with an extension and no value (e.g., a Data Absent Reason).
  </p>
  <p>
    Searching for <code>[parameter]:missing=false</code> requests all resources that <b>do</b> have a value in the matching element.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?given:missing=false</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given:missing=false</span>
      </span>
    </span>
    would match any Patient records that have <em>any</em> value in <code>Patient.name</code> that contains a value for <code>given</code>.
  </p>

  <a name="modifiernot"></a>
  <h5>not</h5>
  <p>
    The <code>not</code> modifier allows clients to filter based on whether resources do not contain a specified token based on the 
    search parameter input.
  </p>
  <p>
    <code>not</code> is only allowed on search parameters of type <a href="#token">token</a>. When using the 'not' modifier,
    all typically-valid search parameter token inputs are allowed.
  </p>
  <p>
    Searching for <code>[parameter]:not=[value]</code> requests all resources that <b>do not</b> have any matching value in the searched element(s).
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?gender:not=male</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
gender:not=male</span>
      </span>
    </span>
    would match any Patient records that do not have <code>male</code> as the value in <code>Patient.gender</code>.  This includes:
    <ul>
      <li><code>female</code> - <a href="valueset-administrative-gender.html">Administrative Gender</a> that is not 'male'</li>
      <li><code>other</code> - <a href="valueset-administrative-gender.html">Administrative Gender</a> that is not 'male'</li>
      <li><code>unknown</code> - <a href="valueset-administrative-gender.html">Administrative Gender</a> that is not 'male'</li>
      <li>records without a <code>Patient.gender</code> value (even if a record has extensions, such as a Data Absent Reason)</li>
    </ul>
  </p>
  <p>
    Similarly, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Composition?section:not=48765-2</span>
        <span class="http-verb-display-post">POST [base]/Composition/_search
Content-Type: application/x-www-form-urlencoded
Composition?section:not=48765-2</span>
      </span>
    </span>
    for documents without an "Allergies and adverse reaction" section (<a href="https://loinc.org/48765-2/">LOINC 48765-2</a>) would return
    all Composition records that <em>do not contain</em> any section with a code of '48765-2'.  This search <em>does not</em> return 
    "any document that has a section that is not an Allergies and adverse reaction section".  In the presence of multiple possible matches, 
    the negation applies to the set and not each individual entry.
  </p>

  <a name="modifiernotin"></a>
  <h5>not-in</h5>
  <p>
    The <code>not-in</code> modifier is used to filter based on a value exclusion test for codes of Value Sets.  
    The <code>not-in</code> modifier is only allowed on <a href="#token">token</a> type search parameters.
  </p>
  <p>
    When the <code>not-in</code> modifier is used with a <a href="#token">token</a> search parameter, the input is
    a <a href="#uri">uri</a> (relative or absolute) that identifies a value set, and the search parameter 
    tests whether the coding is not in the specified value set. The reference may be literal (to an address where 
    the value set can be found) or logical (a reference to <code>ValueSet.url</code>). If the server can treat 
    the reference as a literal URL, it does, else it tries to match known logical ValueSet.url values.  Note 
    that the URI need not point to the root value set, <code>http://snomed.info/sct?fhir_vs=isa/235862008</code>
    is a valid reference to a subset of SNOMED CT 'Hepatitis due to infection', but the parameter value will
    need to be URL Encoded in order to be a valid parameter.
  </p>
  <p>
    When using the <code>not-in</code> modifier on a token, only tokens targeting value sets are allowed (e.g., 
    a boolean token parameter target is not allowed).
  </p>

  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:not-in=ValueSet/123</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:not-in=ValueSet/123</span>
      </span>
    </span>
    would match any conditions that <em>do not</em> contain any code from 'ValueSet/123'.
  </p>
  <p>
    Similarly, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:not-in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F235862008</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:not-in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F235862008</span>
      </span>
    </span>
    would match any conditions that <em>do not</em> contain any code from 'http://snomed.info/sct?fhir_vs=isa/235862008', e.g.:
    <ul>
      <li>SNOMED <code>235862008</code> - Hepatitis due to infection (this code)</li>
      <li>SNOMED <code>773113008</code> - Acute infectious hepatitis (is-a 235862008)</li>
      <li>SNOMED <code>95897009</code> - Amebic hepatitis (is-a 235862008)</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifieroftype"></a>
  <h5>of-type</h5>
  <p>
    The <code>of-type</code> modifier allows clients to filter for resource <a href="datatypes.html#Identifier">Identifier</a>, based on the 
    <code>Identifier.type.coding.system</code>, <code>Identifier.type.coding.code</code> and <code>Identifier.value</code>.  This allows searches
    for specific values only within a specific identifier code system.  The format when using 'of-type' is <code>[system]|[code]|[value]</code>,
    where <code>[system]</code> and <code>[code]</code> refer to the code and system in <code>Identifier.type.coding</code>; the system and code
    portion is considered a match if the the <code>system|code</code> token would match a given <code>Identifier.type.coding</code>. The 
    <code>[value]</code> test is a string match against <code>Identifier.value</code>. All three parts must be present.
  </p>
  <p>
    <code>of-type</code> is only allowed on search parameters of type <a href="#token">token</a>, and further restricted to parameters
    targeting the <a href="datatypes.html#Identifier">Identifier</a> type.  When using the 'of-type' modifier, all typically-valid token values
    are valid for the <code>system</code> and <code>code</code> segments, and all typically-valid string values are valid for the <code>value</code>
    segment.  Note that input values MAY need to escaped in order to be processed correctly (e.g., if the 'value' contains a vertical pipe character).
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Patient?identifier:of-type=http://terminology.hl7.org/CodeSystem/v2-0203|MR|12345</span>
        <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
identifier:of-type=http://terminology.hl7.org/CodeSystem/v2-0203|MR|12345</span>
      </span>
    </span>
    for patients that contain an identifier that has a type coding of with a system of <code>http://terminology.hl7.org/CodeSystem/v2-0203</code>, 
    a code of <code>MR</code> (which identifies Medical Record Numbers), and a value of <code>12345</code> will return records such as:
    <span class="fhir-example">
      <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
      <span class="example-format-display">
        <span class="example-format-display-json">"Patient": {
  "identifier": [{
    "type": {
      "coding" : {
        "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
        "code": "MR"
      }
    }
    "system": "http://example.org/ehr-primary/",
    "value": "12345"
  }]
}</span>
        <span class="example-format-display-xml">&lt;Patient&gt;
  &lt;identifier&gt;
    &lt;type&gt;
      &lt;coding&gt;
        &lt;system value="http://terminology.hl7.org/CodeSystem/v2-0203"/&gt;
        &lt;value value="MR"/&gt;
      &lt;/coding&gt;
    &lt;/type&gt;
    &lt;system value="http://example.org/ehr-primary"/&gt;
    &lt;value value="12345"/&gt;
  &lt;/identifier&gt;
&lt;/Patient&gt;</span>
      </span>
    </span>

    This can be used to disambiguate between data sets that contain collisions.  For example, the above search will NOT return values 
    with a different identifying type, such as:
    <span class="fhir-example">
      <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
      <span class="example-format-display">
        <span class="example-format-display-json">"Patient": {
  "identifier": [{
    "type": {
      "coding" : {
        "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
        "code": "MRT"
      }
    }
    "system": "http://example.org/ehr-er",
    "value": "12345"
  }]
}</span>
        <span class="example-format-display-xml">&lt;Patient&gt;
  &lt;identifier&gt;
    &lt;type&gt;
      &lt;coding&gt;
        &lt;system value="http://terminology.hl7.org/CodeSystem/v2-0203"/&gt;
        &lt;value value="MRT"/&gt;
      &lt;/coding&gt;
    &lt;/type&gt;
    &lt;system value="http://example.org/ehr-er"/&gt;
    &lt;value value="12345"/&gt;
  &lt;/identifier&gt;
&lt;/Patient&gt;</span>
      </span>
    </span>
    which signifies that the identifier is a Temporary Medical Record Number.
  </p>


  <a name="modifiertexttoken"></a>
  <h5>text with <em>reference</em> <span class="stu">TU</span> or <em>token</em> type search parameters</h5>
  <p>
    The <code>text</code> modifier on search parameters of type <a href="#reference">reference</a> and <a href="#token">token</a>
    allows clients to indicate that a supplied <code>string</code> should be used to perform a string-search against the text
    associated with a code or value.  For example, <code>CodeableConcept.text</code>, <code>Coding.display</code>, 
    <code>Identifier.type.text</code>, or <code>Identifier.assigner.display</code>. Search matching is performed using basic string matching 
    rules - begins with or is, case-insensitive.
  </p>
  <p>
    In this context, the <code>text</code> modifier is only allowed on <a href="#reference">reference</a> and <a href="#token">token</a>
    type search parameters. When using the 'text' modifier, all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:text=headache</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:text=headache</span>
      </span>
    </span>
    would match Condition resources containing any codes that start with or equal the string 'headache' (case-insensitive), such as:
    <ul>
      <li>SNOMED <code>25064002</code> - Headache finding</li>
      <li>SNOMED <code>398987004</code> - Headache following lumbar puncture</li>
      <li>SNOMED <code>230480006</code> - Headache following myelography (disorder)</li>
      <li>ICD-10 <code>R51</code> - Headache</li>
      <li>ICD-10 <code>R51.0</code> - Headache with orthostatic component, not elsewhere classified</li>
      <li>ICD-10 <code>R51.9</code> - Headache, unspecified</li>
      <li>Etc.</li>
    </ul>
  </p>
  <p>
    Note that the search is <em>not</em> expected to return results with codes such as SNOMED <code>735938006</code>, since
    the code text of 'Acute headache' does not match a default string search of the term headache (case-insensitive, begins with or equals).
    For advanced searching of related text, see the <a href="#modifiertextadvanced">text-advanced</a> search modifier.
  </p>
  <p>
    For more details about the difference between the <code>identifier</code> modifier and chained-searches on the 
    identifier element, see <a href="#specialidentifiers">Searching Identifiers</a>.
  </p>

  <a name="modifiertextstring"></a>
  <h5>text with <em>string</em> type search parameters</h5>
  <p>
    The <code>text</code> modifier allows clients to request matching based on 
    advanced string processing of the search parameter input.  Implementers of this modifier SHOULD support a sophisticated search functionality of 
    the type offered by typical text indexing services. The value of the parameter is a text-based search, which may involve searching multiple words 
    with thesaurus and proximity considerations, and logical operations such as AND, OR, etc..  Note that only a few servers are expected to offer 
    this facility.
  </p>
  <p>
    Implementers could consider using the rules specified by the 
    <a href="http://docs.oasis-open.org/odata/odata/v4.0/cs01/part1-protocol/odata-v4.0-cs01-part1-protocol.html#_The_$search_System">OData specification for the $search parameter</a>.
    Typical implementations would use Lucene, Solr, an SQL-based full text search, or some similar indexing service.
  </p>
  <p>
    <code>text</code> is only allowed on search parameters of type <a href="#string">string</a>. When using the 'text' modifier,
    all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, assuming a search parameter <code>section-text</code> that applies to <code>Composition.section.text</code>, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Composition?section:text=(bone OR liver) and metastases</span>
        <span class="http-verb-display-post">POST [base]/Composition/_search
Content-Type: application/x-www-form-urlencoded
section:text=(bone OR liver) and metastases</span>
      </span>
    </span>
    for compositions about metastases in the bones or liver of subjects will search for those literal values, but MAY also search for terms such
    as 'cancerous growth', 'tumor', etc..
  </p>

  <a name="modifiertextadvanced"></a>
  <h5>text-advanced <span class="stu">TU</span></h5>
  <p>
    The <code>text-advanced</code> modifier allows clients to request matching based on advanced string processing of the search parameter input
    against the text associated with a code or value.  For example, <code>CodeableConcept.text</code>, <code>Coding.display</code>, or 
    <code>Identifier.type.text</code>.  Implementers of this modifier SHOULD support a sophisticated search functionality of 
    the type offered by typical text indexing services, but MAY support only basic search with minor additions (e.g., word-boundary recognition). 
    The value of the parameter is a text-based search, which may involve searching multiple words with thesaurus and proximity considerations, 
    and logical operations such as AND, OR, etc..
  </p>
  <p>
    <code>text-advanced</code> is allowed on search parameters of type <a href="#reference">reference</a> and <a href="#token">token</a>.
    When using the 'text-advanced' modifier, all typically-valid search parameter string inputs are allowed.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Condition?code:text-advanced=headache</span>
        <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:text-ad=headache</span>
      </span>
    </span>
    would match Condition resources containing codes with text that equals or begins with 'headache', 
    case-insensitive (e.g., same as the <a href="#modifiertexttoken">text</a> modifier) such as:
    <ul>
      <li>SNOMED <code>25064002</code> - Headache finding</li>
      <li>SNOMED <code>398987004</code> - Headache following lumbar puncture</li>
      <li>SNOMED <code>230480006</code> - Headache following myelography (disorder)</li>
      <li>ICD-10 <code>R51</code> - Headache</li>
      <li>ICD-10 <code>R51.0</code> - Headache with orthostatic component, not elsewhere classified</li>
      <li>ICD-10 <code>R51.9</code> - Headache, unspecified</li>
      <li>Etc.</li>
    </ul>
  </p>
  <p>
    However, it would also match Condition resources containing codes with text <em>containing</em> the word 'headache' such as:
    <ul>
      <li>SNOMED <code>735938006</code> - Acute headache</li>
      <li>SNOMED <code>95660002</code> - Thunderclap headache</li>
      <li>SNOMED <code>4969004</code> - Sinus headache</li>
      <li>ICD-10 <code>G44.019</code> - Episodic cluster headache, not intractable</li>
      <li>ICD-10 <code>G44.81</code> - Hypnic headache</li>
      <li>Etc.</li>
    </ul>
  </p>
  <p>
    Additionally, a server MAY also return Condition resources with codes containing synonymous text such as conditions
    with the codes:
    <ul>
      <li>SNOMED <code>37796009</code> - Migraine</li>
      <li>SNOMED <code>49605003</code> - Ophthalmoplegic migraine (disorder)</li>
      <li>ICD-10 <code>G43.4</code> - Hemiplegic migraine</li>
      <li>ICD-10 <code>G43.B0</code> - Ophthalmoplegic migraine, not intractable</li>
      <li>Etc.</li>
    </ul>
  </p>

  <a name="modifiertype"></a>
  <h5>[type]</h5>
  <p>
    The <code>[type]</code> modifier allows clients to restrict the resource type of a reference.  The modifier does not use
    the literal '[type]' in any way, but rather the name of a resource - e.g., <code>Patient</code>, <code>Encounter</code>, etc..
    Note that the modifier cannot be used with a reference to a resource found on another server, since the server would not usually know 
    what type that resource has. However, since these are absolute references, there can be no ambiguity about the type.
  </p>
  <p>
    <code>[type]</code> is only allowed on <a href="#reference">reference</a> type search parameters. When using the '[type]' modifier,
    all typically-valid search parameter reference inputs are allowed, but the value format is restricted to only <code>[id]</code>.
  </p>
  <p>
    For example, the search:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?subject:Patient=23</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject:Patient=23</span>
      </span>
    </span>
    for observations where the subject is 'Patient 23' is functionally equivalent to:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?subject=Patient/23</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject=Patient/23</span>
      </span>
    </span>
    as well as:
    <span class="http-search-example">
      <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/Observation?patient=23</span>
        <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
patient=23</span>
      </span>
    </span>
    However, the modifier becomes more useful when used with <a href="#chaining">Chaining</a> and <a href="#has">Reverse Chaining</a>
    of search parameters.
  </p>


<a name="prefix"></a>
<h4>Prefixes</h4>
<p>
For the ordered parameter types of <a href="#number">number</a>, <a href="#date">date</a>, and <a href="#quantity">quantity</a>,
a prefix to the parameter value may be used to control the nature of the matching. To avoid URL escaping and visual confusion,
the following prefixes are used:
</p>
<table class="grid">
 <tr>
	<td><code>eq</code></td>
	<td>the value for the parameter in the resource is equal to the provided value</td>
	<td>the range of the search value fully contains the range of the target value</td>
 </tr>
 <tr>
	<td><code>ne</code></td>
	<td>the value for the parameter in the resource exists and is not equal to the provided value</td>
  <td>the range of the search value does not fully contain the range of the target value</td>
 </tr>
 <tr>
	<td><code>gt</code></td>
	<td>the value for the parameter in the resource exists and is greater than the provided value</td>
  <td>the range above the search value intersects (i.e. overlaps) with the range of the target value</td>
 </tr>
 <tr>
	<td><code>lt</code></td>
	<td>the value for the parameter in the resource exists and is less than the provided value</td>
  <td>the range below the search value intersects (i.e. overlaps) with the range of the target value</td>
 </tr>
 <tr>
	<td><code>ge</code></td>
	<td>the value for the parameter in the resource exists and is greater or equal to the provided value</td>
  <td>the range above the search value intersects (i.e. overlaps) with the range of the target value, or the range of the search value fully contains the range of the target value</td>
 </tr>
 <tr>
	<td><code>le</code></td>
	<td>the value for the parameter in the resource exists and is less or equal to the provided value</td>
  <td>the range below the search value intersects (i.e. overlaps) with the range of the target value or the range of the search value fully contains the range of the target value</td>
 </tr>
 <tr>
	<td><code>sa</code></td>
	<td>the value for the parameter in the resource exists and starts after the provided value</td>
  <td>the range of the search value does not overlap with the range of the target value, and the range above the search value contains the range of the target value</td>
 </tr>
 <tr>
	<td><code>eb</code></td>
	<td>the value for the parameter in the resource exists and ends before the provided value</td>
  <td>the range of the search value does not overlap with the range of the target value, and the range below the search value contains the range of the target value</td>
 </tr>
 <tr>
	<td><code>ap</code></td>
	<td>the value for the parameter in the resource exists and is approximately the same to the provided value.<br/>
	Note that the recommended value for the approximation is 10% of the stated value (or for a date, 10% of the gap between now and the date), but systems may choose other values where appropriate</td>
  <td>the range of the search value overlaps with the range of the target value</td>
 </tr>
</table>
<p>
  Note that prefixes always test against values present in elements.  In all cases, a prefix-based test against an
  element that does not exist will fail the test.  To search for elements missing values, the use of search modifiers
  is required - either <a href="#modifiermissing"><code>missing</code></a> or <a href="#modifiernot"><code>not</code></a>.
</p>
<p>
If no prefix is present, the prefix <code>eq</code> is assumed. Note that the way search parameters operate
is not the same as the way the operations on two numbers work in a mathematical sense. <code>sa</code> (<code>starts-after</code>) and
<code>eb</code> (<code>ends-before</code>) are not used with integer values but are used for decimals.
</p>
<p>
For each prefix above, two interpretations are provided - the simple intent of the prefix and the
interpretation of the parameter when applied to ranges. The range interpretation is provided
for decimals and dates.  Searches are always performed on values that are implicitly
or explicitly a range. For instance, the number 2.0 has an implicit range of
1.95 to 2.05, and the date 2015-08-12 has an implicit range of all the time during that day.
If the target value is a <a href="datatypes.html#range">Range</a>, a <a href="datatypes.html#period">Period</a>,
or a <a href="datatypes.html#timing">Timing</a>, then the target is explicitly a range. Three ranges
are identified:
</p>
<table class="grid">
 <tr>
	<td>range of the value</td>
	<td>The limits implied by the precision of the value</td>
  <td>The number 2.0 has a range of 1.95 to 2.05<br/>
    The date 2015-08-12 has a range from 2015-08-12T00:00:00.0000 inclusive to 2015-08-13T00:00:00.0000 exclusive.</td>
 </tr>
 <tr>
	<td>range below the value</td>
	<td>Up to the specified value</td>
  <td>The range below 2.0 includes any value less or equal to &lt;2.00000000000000000000<br/>
      The range before 2015-08-12T05:23:45 includes any time up to 2015-08-12T05:23:45.000000000000000</td>
 </tr>
 <tr>
	<td>range above the value</td>
	<td>The specified value and up</td>
  <td>The range above 2.0 includes any value greater or equal to &lt;2.00000000000000000000<br/>
      The range after 2015-08-12T05:23:45 includes any time after 2015-08-12T05:23:45.000000000000000</td>
 </tr>
</table>
<p>
The proper use of these ranges is discussed further below.
</p>

<a name="escaping"></a>
<h4>Escaping Search Parameters</h4>
<p>
In the rules described above, special rules are defined for the characters <code>$</code>, <code>,</code>, and <code>|</code>.
As a consequence, if these characters appear in an actual parameter value,
they must be differentiated from their use as separator characters. When
any of these characters appear in an actual parameter value, they must be
prepended by the character <code>\</code>, which also must be used to prepend itself.
Therefore, <code>param=xxx$xxx</code> indicates that it is a composite parameter, while <code>param=xx\$xx</code> indicates that
the parameter has the literal value <code>xx$xx</code>. The parameter value <code>xx\xx</code> is illegal,
and the parameter value <code>param=xx\\xx</code> indicates a literal value of <code>xx\xx</code>.
This means that:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?code=a,b</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code=a,b</span>
  </span>
</span>
is a request for any Observation that has a code of either <code>a</code> or <code>b</code>, whereas:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?code=a\,b</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code=a\,b</span>
  </span>
</span>
is a request for any Observation that has a code of <code>a,b</code>.
</p>
<p>
This escaping is at a different level to the percent encoding that applies to all
URL parameters (as defined in <a href="https://datatracker.ietf.org/doc/html/rfc3986">RFC 3986</a>). 
Standard percent escaping still applies, such that these URLs have the same meaning:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url=http://acme.org/fhir/ValueSet/123,http://acme.org/fhir/ValueSet/124,ValueSet/125</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url=http://acme.org/fhir/ValueSet/123,http://acme.org/fhir/ValueSet/124,ValueSet/125</span>
  </span>
</span>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url=http%3A%2F%2Facme.org%2Ffhir%2FValueSet%2F123%2Chttp%3A%2F%2Facme.org%2Ffhir%2FValueSet%2F124%2CValueSet%2F125</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url=http%3A%2F%2Facme.org%2Ffhir%2FValueSet%2F123%2Chttp%3A%2F%2Facme.org%2Ffhir%2FValueSet%2F124%2CValueSet%2F125</span>
  </span>
</span>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url=http://acme.org/fhir/ValueSet/123,http://acme.org/fhir/ValueSet/124\,ValueSet/125</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url=http://acme.org/fhir/ValueSet/123,http://acme.org/fhir/ValueSet/124\,ValueSet/125</span>
  </span>
</span>
</p>
<p>
This specification defines this additional form of escape because the escape syntax using \ applies
to all parameter values after they have been 'unescaped' on the server while being read from the
HTTP headers.
</p>

<a name="date"></a>
<h4>date</h4>
<p>
A date parameter searches on a date/time or period. As is usual for date/time related functionality, while the
concepts are relatively straight-forward, there are a number of subtleties involved in ensuring consistent behavior.
</p>
<p>
The date parameter format is <code>yyyy-mm-ddThh:mm:ss[Z|(+|-)hh:mm]</code> (the standard XML format).
</p>
<p>
Technically, this is any of the <a href="datatypes.html#date">date</a>, <a href="datatypes.html#dateTime">dateTime</a>,
and <a href="datatypes.html#instant">instant</a> datatypes; e.g. Any degree of precision can be provided, but it SHALL
be populated from the left (e.g. can't specify a month without a year), except that the minutes SHALL be present if
an hour is present, and you SHOULD provide a time zone if the time part is present. Note: Time can consist of hours and minutes with no seconds, unlike the XML Schema dateTime type. Some user agents may escape the <code>:</code>
characters in the URL, and servers SHALL handle this correctly.
</p>
<p>
  Date searches are intrinsically matches against 'periods', regardless of the underlying element type.  For more 
  information about how the different search prefixes work when comparing periods/ranges, refer to the 
  <a href="#prefix">Prefixes</a> section.  Date parameters may be used with the following datatypes:
</p>
<table class="grid">
 <tr><td><a href="datatypes.html#date">date</a></td><td>The range of the value is the day, month, or year as specified</td></tr>
 <tr><td><a href="datatypes.html#dateTime">dateTime</a></td><td>The range of the value as defined above; e.g. For example, the
   date 2013-01-10 specifies all the time from 00:00 on 10-Jan 2013 to immediately before 00:00 on 11-Jan 2013</td></tr>
 <tr><td><a href="datatypes.html#instant">instant</a></td><td>An instant is considered a fixed point in time with an interval smaller than the precision of the system, i.e. an interval with an effective width of 0</td></tr>
 <tr><td><a href="datatypes.html#Period">Period</a></td><td>Explicit, though the upper or lower bound might not actually be specified in resources.</td></tr>
 <tr><td><a href="datatypes.html#Timing">Timing</a></td><td>the specified scheduling details are ignored and only the outer limits matter. For instance, a schedule that specifies every second day between
   31-Jan 2013 and 24-Mar 2013 includes 1-Feb 2013, even though that is on an odd day that is not specified by the period. This is
   to keep the server load processing queries reasonable.</td></tr>
</table>
<p>
Implicitly, a missing lower boundary is "less than" any actual date.  A missing upper boundary is "greater than" any actual date.
Date searches can be controlled through the use of prefixes as described in the following table:
</p>
<table class="grid">
 <tr>
   <td><code>[parameter]=eq2013-01-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">2013-01-14T00:00 matches (obviously)</li>
     <li style="list-style-image: url('assets/images/tick2.gif')">2013-01-14T10:00 matches</li>
     <li style="list-style-image: url('assets/images/cross.png')">2013-01-15T00:00 does not match - it's not in the range</li>
    </ul>
   </td>
 </tr>
 <tr>
   <td><code>[parameter]=ne2013-01-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">2013-01-15T00:00 matches - it's not in the range</li>
     <li style="list-style-image: url('assets/images/cross.png')">2013-01-14T00:00 does not match - it's in the range</li>
     <li style="list-style-image: url('assets/images/cross.png')">2013-01-14T10:00 does not match - it's in the range</li>
    </ul>
   </td>
 </tr>
 <tr>
   <td><code>[parameter]=lt2013-01-14T10:00</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">2013-01-14 matches, because it includes the part of 14-Jan 2013 before 10am</li>
    </ul>
   </td>
 </tr>
 <tr>
   <td><code>[parameter]=gt2013-01-14T10:00</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">2013-01-14 matches, because it includes the part of 14-Jan 2013 after 10am</li>
    </ul>
   </td>
 </tr>
 <tr>
   <td><code>[parameter]=ge2013-03-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">"from 21-Jan 2013 onwards" is included because that period may include times after 14-Mar 2013</li>
    </ul>
   </td>
 </tr>
 <tr>
   <td><code>[parameter]=le2013-03-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">"from 21-Jan 2013 onwards" is included because that period may include times before 14-Mar 2013</li>
    </ul>
   </td>
  </tr>
 <tr>
   <td><code>[parameter]=sa2013-03-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick2.gif')">"from 15-Mar 2013 onwards" is included because that period starts after 14-Mar 2013</li>
     <li style="list-style-image: url('assets/images/cross.png')">"from 21-Jan 2013 onwards" is not included because that period starts before 14-Mar 2013</li>
     <li style="list-style-image: url('assets/images/cross.png')">"before and including 21-Jan 2013" is not included because that period starts (and ends) before 14-Mar 2013</li>
    </ul>
   </td>
  </tr>
 <tr>
   <td><code>[parameter]=eb2013-03-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/cross.png')">"from 15-Mar 2013 onwards" is not included because that period starts after 14-Mar 2013</li>
     <li style="list-style-image: url('assets/images/cross.png')">"from 21-Jan 2013 onwards" is not included because that period starts before 14-Mar 2013, but does not end before it</li>
     <li style="list-style-image: url('assets/images/tick2.gif')">"before and including 21-Jan 2013" is included because that period ends before 14-Mar 2013</li>
    </ul>
   </td>
  </tr>
 <tr>
   <td><code>[parameter]=ap2013-03-14</code></td>
   <td>
    <ul>
     <li style="list-style-image: url('assets/images/tick.gif')">14-Mar 2013 is included - as it exactly matches</li>
     <li style="list-style-image: url('assets/images/cross.png')">21-Jan 2013 is not included because that is near 14-Mar 2013</li>
     <li style="list-style-image: url('assets/images/cross.png')">15-Jun 2015 is not included - as it is not near 14-Mar 2013. Note that the exact value here is at the discretion of the system</li>
    </ul>
   </td>
  </tr>
</table>
<p>
Other notes:
</p>
<ul>
 <li>When the date parameter is not fully specified, matches against it are based on the behavior of intervals, where:
	<ul>
		<li>Dates with only the year specified are equivalent to an interval that starts at the first instant of January 1st to the last instant of December 31st, e.g. 2000 is equivalent to an interval of [2000-01-01T00:00, 2000-12-31T23:59].</li>
		<li>Dates with the year and month are equivalent to an interval that starts at the first instant of the first day of the month and ends on the last instant of the last day of the month, e.g. 2000-04 is equivalent to an interval of [2000-04-01T00:00, 2000-04-30T23:59].</li>
	</ul>
 </li>
 <li>Where possible, the system should correct for time zones when performing queries. Dates do not have time zones, and time zones
   should not be considered. Where both search parameters and resource element date times do not have time zones, the servers local
   time zone should be assumed.
 </li>
</ul>
<p>
To search for all the procedures in a patient compartment that occurred over a 2-year period:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient/23/Procedure?date=ge2010-01-01&amp;date=le2011-12-31</span>
    <span class="http-verb-display-post">POST [base]/Patient/23/_search
Content-Type: application/x-www-form-urlencoded
Patient/23/Procedure?date=ge2010-01-01&amp;date=le2011-12-31</span>
  </span>
</span>
</p>

[%dragons-start%]
<p>
Managing time zones and offsets and their impact on search is a very difficult area. The FHIR
implementation community is still investigating and debating the best way to handle time zones.
Implementation guides may make additional rules in this regard.
</p>
<p>
Future versions of this specification may impose rules around the use of time zones with dates.
Implementers and authors of implementation guides should be aware of ongoing work in this area.
</p>
<p>
Implementer feedback is welcome <a href="http://hl7.org/fhir-issues">on the issue tracker</a> or <a href="https://chat.fhir.org/#narrow/stream/4-implementers">chat.fhir.org</a>.
</p>
[%dragons-end%]

<a name="number"></a>
<h4>number</h4>
<p>
Searching on a simple numerical value in a resource. Examples:
</p>
<table class="grid">
 <tr><td><code>[parameter]=100</code></td><td>Values that equal 100, to 3 significant figures precision, so this is actually searching for values in the range [99.5 ... 100.5)</td></tr>
 <tr><td><code>[parameter]=100.00</code></td><td>Values that equal 100, to 5 significant figures precision, so this is actually searching for values in the range [99.995 ... 100.005)</td></tr>
 <tr><td><code>[parameter]=1e2</code></td><td>Values that equal 100, to 1 significant figure precision, so this is actually searching for values in the range [50 ... 150)</td></tr>
 <tr><td><code>[parameter]=lt100</code></td><td>Values that are less than exactly 100</td></tr>
 <tr><td><code>[parameter]=le100</code></td><td>Values that are less or equal to exactly 100</td></tr>
 <tr><td><code>[parameter]=gt100</code></td><td>Values that are greater than exactly 100</td></tr>
 <tr><td><code>[parameter]=ge100</code></td><td>Values that are greater or equal to exactly 100</td></tr>
 <tr><td><code>[parameter]=ne100</code></td><td>Values that are not equal to 100 (actually, in the range 99.5 to 100.5)</td></tr>
</table>
<p>
Notes about searching on Numbers:
</p>
<ul>
 <li>When a number search is used against a resource element that stores a simple integer (e.g.
 <a href="immunizationrecommendation-definitions.html#ImmunizationRecommendation.recommendation.doseNumber_x_">ImmunizationRecommendation.recommendation.doseNumber</a>), and the search parameter
    is not expressed using the exponential forms, and does not include any non-zero digits after a decimal point,
    the significance issues cancel out and searching is based on exact matches.  Note that if there are non-zero digits after a decimal point,
    there cannot be any matches</li>
 <li>When a comparison prefix in the set <code>gt, lt, ge, le, sa &amp; eb</code> is provided, the
     implicit precision of the number is ignored, and they are treated as if they have arbitrarily high precision</li>
 <li>The way search parameters operate in resources is not the same as whether two numbers are equal to each other in a mathematical sense</li>
 <li>Searching on decimals without using one of the comparisons listed in the earlier bullet involves an implicit range.  The number of 
     significant digits of the implicit range is the number of digits specified in the search parameter value, excluding leading zeros. 
     So 100 and 1.00e2 both have the same number of significant digits - three</li>
</ul>

<p>
Here are some example searches:
</p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table>
  <tr><td width="50%"><b>Search</b></td><td><b>Description</b></td></tr>
  <tr>
    <td>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/RiskAssessment?probability=gt0.8</span>
        <span class="http-verb-display-post">POST [base]/RiskAssessment/_search
Content-Type: application/x-www-form-urlencoded
probability=gt0.8</span>
      </span>
    </td>
    <td>Search for all the Risk Assessments with probability great than 0.8 (could also be <code>probability=gt8e-1</code> using exponential form)</td>
  </tr>
  <tr>
    <td>
      <span class="http-verb-display">
        <span class="http-verb-display-get">GET [base]/ImmunizationRecommendation?dose-number=2</span>
        <span class="http-verb-display-post">POST [base]/ImmunizationRecommendation/_search
Content-Type: application/x-www-form-urlencoded
dose-number=2</span>
      </span>
    </td>
    <td>Search for any immunization recommendation recommending a second dose</td>
  </tr>
  </table>
</span>

<a name="quantity"></a>
<h4>quantity</h4>
<p>
A quantity parameter searches on the <a href="datatypes.html#Quantity">Quantity</a> datatype.
The syntax for the value follows the form:
</p>
<ul>
 <li><code>[parameter]={[prefix]}[number]</code> matches a quantity by <code>value</code>, with an optional prefix</li>
 <li><code>[parameter]={[prefix]}[number]|[system]|[code]</code> matches a quantity by <code>value</code>, <code>system</code> and <code>code</code>, with an optional prefix</li>
 <li><code>[parameter]={[prefix]}[number]||[code]</code> matches a quantity by <code>value</code> and <code>code</code> or <code>unit</code>, with an optional prefix</li>
</ul>
<p>
The prefix is optional, and is as described in the section on <a href="#prefix">Prefixes</a>, both regarding how
precision and comparator/range operators are interpreted. Like a number parameter, the
number part of the search value can be a decimal in exponential format. The <code>system</code> and <code>code</code>
follow the same pattern as <a href="#token">token parameters</a> are also optional. Note that when the <code>[system]</code>
component has a value, it is implied that a precise (and potentially canonical) match is desired. In this case, it is 
inappropriate to search on the human display for the unit, which can be is uncontrolled and may unpredictable.
Example searches:
</p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table>
    <tr><td width="50%"><b>Search</b></td><td><b>Description</b></td></tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=5.4|http://unitsofmeasure.org|mg</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=5.4|http://unitsofmeasure.org|mg</span>
        </span>
      </td>
      <td>Search for all the observations with a value of 5.4(+/-0.05) mg where mg is understood as a UCUM unit (<code>system</code>/<code>code</code>)
      </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=5.40e-3|http://unitsofmeasure.org|g</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=5.40e-3|http://unitsofmeasure.org|g</span>
        </span>
      </td>
      <td>Search for all the observations with a value of 0.0054(+/-0.000005) g where g is understood as a UCUM unit (<code>system</code>/<code>code</code>)
      </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=5.4||mg</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=5.4||mg</span>
        </span>
      </td>
      <td>Search for all the observations with a value of 5.4(+/-0.05) mg where the unit - either the code (<code>code</code>) or the stated human unit (<code>unit</code>) are "mg"
      </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=5.4</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=5.4</span>
        </span>
      </td>
      <td>Search for all the observations with a value of 5.4(+/-0.05) irrespective of the unit
      </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=le5.4|http://unitsofmeasure.org|mg</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=le5.4|http://unitsofmeasure.org|mg</span>
        </span>
      </td>
      <td>Search for all the observations where the value of is less than 5.4 mg exactly where mg is understood as a UCUM unit
      </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?value-quantity=ap5.4|http://unitsofmeasure.org|mg</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
value-quantity=ap5.4|http://unitsofmeasure.org|mg</span>
        </span>
      </td>
      <td>Search for all the observations where the value of is about 5.4 mg where mg is understood as a UCUM unit (typically, within 10% of the value - see above)
      </td>
    </tr>
  </table>
</span>
<p>
Specifying a system and a code for the search implies that the search is based on a particular code system - usually <a href="http://unitsofmeasure.org">UCUM</a>, and
that a precise (and potentially canonical) match is desired. In this case, it is inappropriate to search on the human display for the unit, which can be
is uncontrolled and may be unpredictable.
</p>

<p>
The search processor may choose to perform a search based on <a href="datatypes.html#quantity">canonical units</a>
(e.g. any value where the units can be converted to a value in mg in the case above). For example, an observation
may have a value of <code>23 mm/hr</code>. This is equal to <code>0.023 m/hr</code>. The search processor can
choose to normalize all the values to a canonical unit such as <code>6.4e-6 m/sec</code>, and convert
search terms to the same units (m/sec). Such conversions can be performed based on the semantics defined
in <a href="http://unitsofmeasure.org">UCUM</a>
</p>


<a name="reference"></a>
<h4>reference</h4>
<p>
A reference parameter refers to <a href="references.html">references between resources</a>.  For example, find all
Conditions where the subject reference is a particular patient, where the patient is selected by name or identifier.
The interpretation of a <i>reference</i> parameter is either:
</p>
<ul>
  <li><b><code>[parameter]=[id]</code></b> the logical [id] of a resource using a local reference (i.e. a relative reference).</li>
  <li><b><code>[parameter]=[type]/[id]</code></b> the logical [id] of a resource of a specified type using a local reference (i.e. a relative reference),
   for when the reference can point to different types of resources (e.g. <a href="observation-definitions.html#Observation.subject">Observation.subject</a>).</li>
  <li><b><code>[parameter]=[type]/[id]/_history/[version]</code></b> <span class="stu">TU</span> the logical [id] of a resource of a specified type using a 
   local reference (i.e. a relative reference), for when the reference can point to different types of resources and a specific version is requested. Note 
   that server implementations MAY return an error when using this syntax if resource versions are not supported.  For more information, see 
   <a href="#versions">References and Versions</a>.</li>
  <li><b><code>[parameter]=[url]</code></b> where the [url] is an absolute URL - a reference to a resource by its absolute location, or by its canonical URL</li>
  <li><b><code>[parameter]=[url]|[version]</code></b> <span class="stu">TU</span> where the search element is a canonical reference, the [url] is an absolute URL, and a specific version
  or partial version is desired.  For more information, see <a href="#versions">References and Versions</a>. </li>
</ul>
<p>
Notes:
<ul>
  <li>A relative reference resolving to the same value as a specified absolute URL, or vice versa, qualifies as a match.</li>
  <li>If a reference value is a non-versioned relative reference (e.g., does not contain <code>[url]</code> or <code>_history/[version]</code> parts), the search 
    SHOULD match instances that match the reference in it contains a versioned reference.</li>
</ul>
</p>
<p>
  For example, if the base URL of a server is http://example.org/fhir, the search:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET http://example.org/fhir/Observation?subject=Patient/123</span>
      <span class="http-verb-display-post">POST http://example.org/fhir/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject=Patient/123</span>
    </span>
  </span>
  will match Observations with <code>subject.reference</code> values:
  <ul>
    <li><code>Patient/123</code> - exact match of search input</li>
    <li><code>http://example.org/fhir/Patient/123</code> - search input with implicit resolution to the local server</li>
    <li><code>Patient/123/_history/1</code> - reference to a specific version of the search input <span class="stu">TU</span></li>
  </ul>
</p>
<p>
  Similarly, the search:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET http://example.org/fhir/Observation?subject=http://example.org/fhir/Patient/123</span>
      <span class="http-verb-display-post">POST http://example.org/fhir/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject=http://example.org/fhir/Patient/123</span>
    </span>
  </span>
  will match Observations with <code>subject.reference</code> values:
  <ul>
    <li><code>http://example.org/fhir/Patient/123</code> - exact match of search input</li>
    <li><code>Patient/123</code> - search input with implicit reference to the local server</li>
  </ul>
  Note that it will <b>not</b> match an Observation with <code>Patient/123/_history/1</code>, since the original reference was 
  not a relative reference <span class="stu">TU</span>.
</p>
<p>
  Also, the search:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET http://example.org/fhir/Observation?subject=123</span>
      <span class="http-verb-display-post">POST http://example.org/fhir/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject=123</span>
    </span>
  </span>
  will match Observations with <code>subject.reference</code> values:
  <ul>
    <li><code>Patient/123</code> - search input of type Patient</li>
    <li><code>http://example.org/fhir/Patient/123</code> - search input with implicit resolution to the local server, of type Patient</li>
    <li><code>Practitioner/123</code> - search input of type Practitioner</li>
    <li><code>http://example.org/fhir/Practitioner/123</code> - search input with implicit resolution to the local server, of type Practitioner</li>
    <li>Etc.</li>
  </ul>
</p>

<p>
Some references may point to more than one type of resource; e.g. <code>subject: Reference(Patient|Group|Device|..)</code>.
In these cases, multiple resources may have the same logical identifier. Servers SHOULD reject a search where
the logical id refers to more than one matching resource across different types.
In order to allow the client to perform a search in these situations the type is specified explicitly:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?subject=Patient/23</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject=Patient/23</span>
  </span>
</span>
</p>
<p>
This searches for any observations where the subject refers to the patient resource with the
logical identifier "23". A modifier is also defined to allow the client to be explicit
about the intended type:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?subject:Patient/23</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject:Patient/23</span>
  </span>
</span>
</p>
<p>
This has the same effect as the previous search. The modifier becomes useful when used with chaining
as explained in the next section. Note: The <code>[type]</code> modifier can't be used with a reference to a resource found on another server,
since the server would not usually know what type that resource has.  However, since these are absolute references,
there can be no ambiguity about the type.
</p>
<p>
In some cases, search parameters are defined with an implicitly limited scope. For example,
<a href="observation.html"><code>Observation</code></a> has an element <code>subject</code>, which is
a reference to one of a number of types. This has a matching search parameter <code>subject</code>,
which refers to any of the possible types. In addition to this, there is another search parameter
<code>patient</code>, which also refers to <code>Observation.subject</code>, but is limited to
only include references of type <a href="patient.html"><code>Patient</code></a>. When using
the patient search parameter, there is no need to specify ":Patient" as a modifier, or "Patient/"
in the search value, as this must always be true.
</p>
<p>
References are also allowed to have an <code>identifier</code>. The modifier :identifier
allows for searching by the identifier rather than the literal reference:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?subject:identifier=http://acme.org/fhir/identifier/mrn|123456</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
subject:identifier=http://acme.org/fhir/identifier/mrn|123456</span>
  </span>
</span>
</p>
<p>
This is a search for all observations that reference a patient by a particular patient MRN.
When the :identifier modifier is used, the search value works as a <a href="#token">token search</a>.
The :identifier modifier is not supported on canonical elements since they do not have an identifier
separate from the reference itself.
</p>
<p>
Chaining is not supported when using the :identifier modifier, nor are chaining, includes
or reverse includes supported for reference elements that do not have a <code>reference</code>
element.
</p>
<p>
The reference search parameter is mostly used for resource elements of type <code>Reference</code> or <code>canonical</code>.
However, it is also be used to search resource elements of type Resource - i.e. where
one resource is directly nested within another - see the <a href="bundle.html#search">Bundle
search parameters</a> 'message' and 'composition' as an example of this.
</p>

<a name="string"></a>
<h4>string</h4>
<p>
For a simple string search, a string parameter serves as the input for a search against
sequences of characters. This search is insensitive to casing and included combining characters, like accents or other diacritical marks.
Punctuation and non-significant whitespace (e.g. repeated space characters, tab vs space) should also be ignored.
By default, a field matches a string query if the value of the field equals or starts with the supplied parameter value, after both have
been normalized by case and combining characters. Therefore, the default string search only operates on the base characters of the string parameter.
The <code>:contains</code> modifier returns results that include the supplied parameter value anywhere within the field
being searched. The <code>:exact</code> modifier returns results that match
the entire supplied parameter, including casing and accents.
</p>
<p>
When a string type search parameter points to a complex or backbone element (an element that contains sub-elements), by default the 
search is interpreted as a search against one or more string values in sub-elements, as selected by the implementation. A search 
parameter MAY explicitly choose elements by using an expression that instead points directly to the sub-elements. <span class="stu">TU</span>
</p>
<p>
For example, if a search parameter is of type string and the expression points to <code>Patient.name</code>, the implementation MAY search 
against any one or more elements of the <a href="datatypes.html#humanname">HumanName</a> datatype (e.g., <code>given</code>, <code>family</code>, 
<code>prefix</code>, <code>suffix</code>, etc.) <span class="stu">TU</span>. However, if the search parameter intends to explicitly match against
<code>given</code> and <code>family</code> only, the search parameter should use an expression of <code>Patient.name.given | Patient.name.family</code>.
</p>
<p>
If the SearchParameter's narrative description includes additional considerations about what fields are indexed, 
<code>SearchParameter.processingMode</code> should have the value <code>other</code>.
</p>
<p>
Examples:
</p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table class="grid">
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?given=eve</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given=eve</span>
        </span>
      </td>
      <td>Any patients with a name containing a given part with "eve" at the start of the name. This would include patients with the given name "Eve", "Evelyn".</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?given:contains=eve</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given:contains=eve</span>
        </span>
      </td>
      <td>Any patients with a name with a given part containing "eve" at any position. This would include patients with the given name "Eve", "Evelyn", and also "Severine".</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?given:exact=Eve</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
given:exact=Eve</span>
        </span>
      </td>
      <td>Any patients with a name with a given part that is exactly "Eve". Note: This would not include patients with the given name "eve" or "EVE".</td>
    </tr>
  </table>
</span>
<p>
An additional modifier <code>:text</code>
can be used to specify a search with advanced text handling (see <a href="#text">below</a>)
though only a few servers are expected to offer this facility.
</p>
<p>
When a string search parameter refers to the types <a href="datatypes.html#HumanName">HumanName</a> and <a href="datatypes.html#Address">Address</a>,
the search covers the elements of type string, and does not cover elements such as <code>use</code> and <code>period</code>.
For robust search, servers should search the parts of a family name independently.
E.g. searching either "Carreno" or "Quinones" should match a family name of "Carreno Quinones".
HL7 affiliates may make more specific recommendations about how search should work
in their specific culture.
</p>
<p>
It is at the discretion of the server whether to pre-process names, addresses,
and contact details to remove separator characters prior to matching in order
to ensure more consistent behavior. For example, a server might remove all
spaces and <code>-</code> characters from phone numbers. What is most appropriate varies
depending on culture and context.
A server may also use a free-text style searches on this property to achieve the best results.<br/>
When searching whole names and addresses (not parts), servers may also use flexible match
or a free-text style searches on names to achieve the best results.
</p>

<a name="token"></a>
<h4>token</h4>
<p>
A token type is a parameter that provides a close to exact match search on a string of characters, potentially
scoped by a URI. It is mostly used against a code or identifier datatype where the value may have a
URI that scopes its meaning, where the search is performed against the  pair from a Coding or an
Identifier. Tokens are also used against other fields where exact matches are required - uris,
booleans, <a href="datatypes.html#ContactPoint">ContactPoints</a>, and <a href="datatypes.html#id">ids</a>. In these
cases the URI portion (<code>[system]|</code>) is not used (only the <code>[code]</code> portion).
</p>
<p>
For tokens, matches are literal (e.g. not based on <a href="codesystem.html#subsumption">subsumption</a> or other code system features).
Match is case sensitive unless the underlying semantics for the context indicate that the token should be interpreted case-insensitively
(see, e.g. <a href="codesystem-definitions.html#CodeSystem.caseSensitive">CodeSystem.caseSensitive</a>). Note that matches on <code>_id</code>
are always case sensitive. If the underlying datatype is <code><a href="datatypes.html#string">string</a></code>
then the search is not case sensitive.
</p>
<p>
<b>Note</b>: There are many challenging issues around case sensitivity and token searches. Some
code systems are case sensitive (e.g. UCUM) while others are known not to be. For many code
systems, it's ambiguous. Other kinds of values are also ambiguous. When in doubt, servers
SHOULD treat tokens in a case-insensitive manner, on the grounds that including undesired
data has less safety implications than excluding desired behavior. Clients SHOULD always
use the correct case when possible, and allow for the server to perform case-insensitive
matching.
</p>
<p>
To use subsumption-based logic, use the modifiers below, or list
all the codes in the hierarchy. The syntax for the value is one of the following:
</p>
<ul>
 <li><b><code>[parameter]=[code]</code></b>: the value of <code>[code]</code> matches a Coding.code or Identifier.value irrespective of the value of the system property</li>
 <li><b><code>[parameter]=[system]|[code]</code></b>: the value of <code>[code]</code> matches a Coding.code or Identifier.value, and the value of <code>[system]</code> matches the system property of the Identifier or Coding</li>
 <li><b><code>[parameter]=|[code]</code></b>: the value of <code>[code]</code> matches a Coding.code or Identifier.value, and the Coding/Identifier has no system property</li>
 <li><b><code>[parameter]=[system]|</code></b>: any element where the value of <code>[system]</code> matches the system property of the Identifier or Coding</li>
</ul>
<p>
Notes:
</p>
<ul>
 <li>The namespace URI and code both must be <a href="#escaping">escaped</a> correctly.
If a system is not applicable (e.g. an element of type <a href="datatypes.html#uri">uri</a>,
then just the form [parameter]=[code] is used.</li>
 <li>For token parameters on elements of type <a href="datatypes.html#id">id</a>, <a href="datatypes.html#ContactPoint">ContactPoint</a>, 
  <a href="datatypes.html#uri">uri</a>, or <a href="datatypes.html#boolean">boolean</a>, the pipe symbol 
  SHALL NOT be used - only the <code>[parameter]=[code]</code> form is allowed</li>
</ul>
<p>
Token search parameters are used for the following datatypes:
</p>
<table class="grid">
 <tr>
  <td><b>Datatype</b></td>
  <td><b>URI</b></td>
  <td><b>Code</b></td>
  <td><b>Comments</b></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Coding">Coding</a></td>
  <td>Coding.system</td>
  <td>Coding.code</td>
  <td></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#CodeableConcept">CodeableConcept</a></td>
  <td>CodeableConcept.coding.system</td>
  <td>CodeableConcept.coding.code</td>
  <td>Matches against any coding in the CodeableConcept</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Identifier">Identifier</a></td>
  <td>Identifier.system</td>
  <td>Identifier.value</td>
  <td>Clients can search by <code>type</code> not <code>system</code> using the :of-type modifier, see below. To search on a CDA <code>II.root</code> - which
	    may appear in either <code>Identifier.system</code> or <code>Identifier.value</code>, use the syntax <code>identifier=|[root],[root]</code></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#ContactPoint">ContactPoint</a></td>
  <td></td>
  <td>ContactPoint.value</td>
  <td>At the discretion of the server, token searches on ContactPoint may use special handling, such as ignoring punctuation, performing partial searches etc.</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#code">code</a></td>
  <td>(implicit)</td>
  <td>code</td>
  <td>the system is defined in the value set (though it's not usually needed)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#boolean">boolean</a></td>
  <td></td>
  <td>boolean</td>
  <td>The implicit system for boolean values is <a href="valueset-special-values.html">http://terminology.hl7.org/CodeSystem/special-values</a> but this is never actually used</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#id">id</a></td>
  <td></td>
  <td>id</td>
  <td></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#uri">uri</a></td>
  <td></td>
  <td>uri</td>
  <td></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#string">string</a></td>
  <td>n/a</td>
  <td>string</td>
  <td>Token is sometimes used for string to indicate that exact matching is the correct default search strategy</td>
 </tr>
</table>
<p>
Note: The use of token search parameters for boolean fields: the boolean values "true" and "false" are also represented
as formal codes in the <a href="valueset-special-values.html">Special Values</a> code system, which is useful when boolean values
need to be represented in a <a href="datatypes.html#coding">Coding</a> datatype. The namespace for these codes is
http://terminology.hl7.org/CodeSystem/special-values, though there is usually no reason to use this, as a simple true or false is sufficient.
</p>
<p>
Most servers will only process value sets that are already known/registered/supported internally.
However, servers can elect to accept any valid reference to a value set.
Servers may elect to consider concept mappings when testing for subsumption relationships.
</p>

<p>
Example searches:
</p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table>
    <tr><td width="50%"><b>Search</b></td><td><b>Description</b></td></tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?identifier=http://acme.org/patient|2345</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
identifier=http://acme.org/patient|2345</span>
        </span>
      </td>
      <td>Search for all the patients with an identifier with key = "2345" in the system "http://acme.org/patient"</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?gender=male</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
gender=male</span>
        </span>
      </td>
      <td>Search for any patient with a gender that has the code "male"</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?gender:not=male</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
gender:not=male</span>
        </span>
      </td>
      <td>Search for any patient with a gender that does not have the code "male", including those that do not have a code for gender at all.</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Composition?section=48765-2</span>
          <span class="http-verb-display-post">POST [base]/Composition/_search
Content-Type: application/x-www-form-urlencoded
section=48765-2</span>
        </span>
      </td>
      <td>Search for any Composition that contains an Allergies and adverse reaction section</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Composition?section:not=48765-2</span>
          <span class="http-verb-display-post">POST [base]/Composition/_search
Content-Type: application/x-www-form-urlencoded
section:not=48765-2</span>
        </span>
      </td>
      <td>Search for any Composition that does not contain an Allergies and adverse reaction section. Note that this search does not return 
        "any document that has a section that is not an Allergies and adverse reaction section" (e.g. in the presence of multiple possible 
        matches, the <i>negation</i> applies to the set, not each individual entry)</td>
      </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?active=true</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
active=true</span>
        </span>
      </td>
      <td>Search for any patients that are active</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code=http://acme.org/conditions/codes|ha125</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code=http://acme.org/conditions/codes|ha125</span>
        </span>
      </td>
      <td>Search for any condition with a code "ha125" in the code system "http://acme.org/conditions/codes"</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code=ha125</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code=ha125</span>
        </span>
      </td>
      <td>Search for any condition with a code "ha125". Note that there is not often any useful overlap in literal symbols between code systems, so the previous example is generally preferred </td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code:text=headache</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:text=headache</span>
        </span>
      </td>
      <td>Search for any Condition with a code that has a text "headache" associated with it (either in the text, or a display)</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code:in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F126851005</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:in=http%3A%2F%2Fsnomed.info%2Fsct%3Ffhir_vs%3Disa%2F126851005</span>
        </span>
      </td>
      <td>Search for any condition in the SNOMED CT value set "http://snomed.info/sct?fhir_vs=isa/126851005" that includes all descendants of "Neoplasm of liver"</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code:below=126851005</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:below=126851005</span>
        </span>
      </td>
      <td>Search for any condition that is subsumed by the SNOMED CT Code "Neoplasm of liver". Note: This is the same outcome as the previous search</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Condition?code:in=http://acme.org/fhir/ValueSet/cardiac-conditions</span>
          <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
code:in=http://acme.org/fhir/ValueSet/cardiac-conditions</span>
        </span>
      </td>
      <td>Search for any condition that is in the institutions list of cardiac conditions</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Patient?identifier:of-type=http://terminology.hl7.org/CodeSystem/v2-0203|MR|446053</span>
          <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
identifier:of-type=http://terminology.hl7.org/CodeSystem/v2-0203|MR|446053</span>
        </span>
      </td>
      <td>Search for the Medical Record Number 446053 - this is useful where the system id for the MRN is not known</td>
    </tr>
  </table>
</span>

<!--
A server defined search (link to search page) that may consider matching any of the string fields in the HumanName, including family, give, prefix, suffix, suffix, and/or text
 -->
 <a name="uri"></a>
 <h4>uri</h4>
 <p>
 The uri parameter refers to an element that contains a URI (<a href="https://tools.ietf.org/html/rfc3986">RFC 3986</a>).
 By default, matches are precise, case and accent sensitive, and the entire URI must match.
 The modifier <code>:above</code> or <code>:below</code> can be used to indicate
 that partial matching is used. For example (note that the search parameter <code>ValueSet.url</code> is of type <code>uri</code>):
 <span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url=http://acme.org/fhir/ValueSet/123</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url=http://acme.org/fhir/ValueSet/123</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url:below=http://acme.org/fhir/</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url:below=http://acme.org/fhir/</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url:above=http://acme.org/fhir/ValueSet/123/_history/5</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url:above=http://acme.org/fhir/ValueSet/123/_history/5</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?url=urn:oid:1.2.3.4.5</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
url=urn:oid:1.2.3.4.5</span>
  </span>
</span>
 </p>
 <ul>
  <li>The first line is a request to find any value set with the exact url "http://acme.org/fhir/ValueSet/123"</li>
  <li>The second line performs a search that will return any value sets that have a URL that starts with "http://acme.org/fhir/"</li>
  <li>The third line shows the converse - search for any value set above a given specific URL. This will match on any value set with the specified URL, but also on http://acme.org/ValueSet/123.
     Note that there are not many use cases where :above is useful as compared to the <code>:below</code> search</li>
  <li>The fourth line shows an example of searching by an OID. Note that the :above and :below modifiers only apply to URLs, and not URNS such as OIDs</li>
 </ul>
 <p>
 The search type <code>uri</code> is used with elements of type <a href="datatypes.html#uri">uri</a> and <a href="datatypes.html#url">url</a>.
 The type <a href="#reference">reference</a> is used for the types <a href="references.html#Reference">Reference</a> and
 <a href="datatypes.html#canonical">canonical</a>.
 </p>

 <a name="special"></a>
 <h4>Special Parameters</h4>
 <p>
 A few parameters have the type 'special'. That indicates that the way this parameter works is
 unique to the parameter and described with the parameter. The general
 modifiers and comparators do not apply, except as stated in the description.
 </p>
 <p>
 Implementers will generally need to do special implementations for these
 parameters. These parameters are special:
 </p>
 <ul>
  <li><a href="search_filter.html">_filter</a> (all resources)</li>
 [%special-search-parameters%]
 </ul>
 

 <a name="composite"></a>
 <h4>Composite Search Parameters</h4>
 <p>
  Composite search parameters are allow joining multiple elements into distinct single values with a <code>$</code>.
  This is different from doing a simple intersection - the intersection rules apply at the resource level, so,
  for example, an Observation with multiple <a href="observation-definitions.html#Observation.component">component</a>
  repetitions may match because one repetition has a desired code and a <em>different</em> repetition matches
  a value filter.
 </p>
 <p>
  The <code>composite</code> parameter approach works in this context because it allows searches based on a tuples of values.  For example:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Observation?code-value-quantity=code$loinc|12907-2,value$ge150|http://unitsofmeasure.org|mmol/L</span>
      <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code-value-quantity=code$loinc|12907-2,value$ge150|http://unitsofmeasure.org|mmol/L</span>
    </span>
  </span>
  will match Observation records with a LOINC code of "12907-2" (Sodium [Moles/volume] in Red Blood Cells) AND a value
  greater than "150 mmol/L".
  </p>
  <p>
    Note that the sequence is a single value and itself can be composed into a set of values.
    For example, searching <a href="group-definitions.html#Group.characteristic">Group.characteristic</a>, searching
    for multiple key/value pairs (instead of an intersection of matches on key and value):
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Group?characteristic-value=gender$mixed,owner$Eve</span>
      <span class="http-verb-display-post">POST [base]/Group/_search
Content-Type: application/x-www-form-urlencoded
characteristic-value=gender$mixed,owner$Eve</span>
    </span>
  </span>
    will match Groups that have a <code>gender</code> characteristic of "mixed" (the group contains people of
    multiple genders) OR the group has a <code>owner</code> characteristic of "Eve".
  </p>
 <p>
 Note that <a href="#modifiers">search modifiers</a> are NOT allowed on composite parameters.
 <!--
 Future note: use \p and \m in search values? if we add a double = to parameter value for text, that would get rid
 of <code>:exact</code>.
 Won't try to get rid of type modifier - that's the real use for modifiers because it has to be in a chaining line.
 Other modifier is <code>:text</code> on token - use "~"? or ""?
 -->
 </p>
 
 <p>
 Examples of using composite parameters:
 </p>
 
 <span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <table>
    <tr><td width="50%"><b>Search</b></td><td><b>Description</b></td></tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/DiagnosticReport?result.code-value-quantity=http://loinc.org|2823-3$gt5.4|http://unitsofmeasure.org|mmol/L</span>
          <span class="http-verb-display-post">POST [base]/DiagnosticReport/_search
Content-Type: application/x-www-form-urlencoded
result.code-value-quantity=http://loinc.org|2823-3$gt5.4|http://unitsofmeasure.org|mmol/L</span>
        </span>
      </td>
      <td>Search for all diagnostic reports that contain on observation with a potassium value of >5.4 mmol/L (UCUM)</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Observation?component-code-value-quantity=http://loinc.org|8480-6$lt60</span>
          <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
component-code-value-quantity=http://loinc.org|8480-6$lt60</span>
        </span>
      </td>
      <td>Search for all the observations with a systolic blood pressure &lt; 60. Note that in this case, the unit is assumed (everyone uses mmHg)</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Group?characteristic-value=gender$mixed</span>
          <span class="http-verb-display-post">POST [base]/Group/_search
Content-Type: application/x-www-form-urlencoded
characteristic-value=gender$mixed</span>
        </span>
      </td>
      <td>Search for all groups that have a characteristic "gender" with a text value of "mixed"</td>
    </tr>
    <tr>
      <td>
        <span class="http-verb-display">
          <span class="http-verb-display-get">GET [base]/Questionnaire?context-type-value=focus$http://snomed.info/sct|408934002</span>
          <span class="http-verb-display-post">POST [base]/Questionnaire/_search
Content-Type: application/x-www-form-urlencoded
context-type-value=focus$http://snomed.info/sct|408934002</span>
        </span>
      </td>
      <td>Search for all questionnaires that have a clinical focus = "Substance abuse prevention assessment (procedure)"</td>
    </tr>
  </table>
 </span>


<a name="specialconditions"></a>
<h3>Special Search Conditions</h3>
<p>
  In addition to 'basic' searching, this specification defines behaviors for many 'special' cases that 
  are common across implementations.
</p>

<a name="specialidentifiers"></a>
<h4>Searching Identifiers</h4>
<p>
  In FHIR data, there are a few types of identifiers that may apply to a resource: a single 
  <a href="#identifierslogical">logical identifier</a> (the <code>Resource.id</code> of a resource), 
  zero or more <a href="datatypes.html#Identifier">Identifier-type</a> elements (e.g., 
  <a href="patient-definitions.html#Patient.identifier">Patient.Identifier</a>), and, if the resource is
  a <a href="canonicalresource.html">Canonical Resource</a>, a 
  <a href="canonicalresource-definitions.html#CanonicalResource.url">canonical url</a>.  Each of these 'identifiers'
  have a different datatype and expose different search functionality.  Some details about each are included
  below.
</p>

<a name="identifierslogical"></a>
<h5>Logical Identifiers</h5>
<p>
  The <a href="resource.html#id">Logical Identifier</a> of a resource represents a unique key for an instance within
  a specific context (e.g., a single resource type in a server collection, a resource in a bundle, etc.).  Searching
  by the logical id of an instance is done via the <a href="#_id"><code>_id</code></a> search parameter.
</p>
<p>
  Given that a logical id is unique in the context, searching by id will always result in either zero or one records.
  In many ways, the search is functionally equivalent to an equivalent <a href="http.html#read">simple read operation</a>.
  However, there are some differences in using search instead of read:
  <ul>
    <li>
      Search operations always return bundles.
      <ul>
        <li>
          If the id exists (and can be returned), the result will be a bundle containing the resource (search) 
          instead of the resource itself (read).
        </li>
        <li>
          If the id does not exist (or cannot be returned), the result of a valid search will still be a bundle.
          The bundle MAY include further information in the form of an <a href="operationoutcome.html">OperationOutcome</a>.
          See <a href="#errors">Handling Errors</a> for more information.
        </li>
      </ul>
    </li>
    <li>
      Additional resources can be requested and/or returned in the same request - see <a href="#include">Including Other Resources</a>
      for more information.
    </li>
    <li>
      Additional search functionality is available. For example, asking for a Patient resource by id, but also setting the 
      search criteria of <code>deceased</code> to <code>true</code> would only return the Patient if they are deceased.
    </li>
  </ul>
</p>
<p>
  Since <code>_id</code> requires a resource type context and there can only be zero or one resources of a type with a given id, 
  the search is functionally equivalent to the <a href="http.html#read">simple read operation</a> of <code>GET [base]/Patient/23</code>.
  However, searching by logical identifier means that all other search functionality is available - e.g., <code>OperationOutcome</code>
  resources for issues, additional search parameters, inclusion of additional resources, etc..
</p>

<a name="membership"></a>
<h5>Searching by Membership</h5>
<p>
  Some resources (e.g., <a href="group.html">Group</a>, <a href="list.html">List</a>, 
  and <a href="careteam.html">CareTeam</a>) are used to maintain collections of other resources.
  For example, a Group of Patients representing a cohort or a List of patient allergies.
  While it is possible to retrieve the collection resource, iterate over the entries, and fetch each
  referenced resource, using search criterion allows for fewer round-trips and additional search criteria 
  to be specified in-line.
</p>
<p>
  There are two standard search parameters defined by this specification to support searching against
  collection resources:
  <ul>
    <li><a href="#_in"><code>_in</code></a> to test against active membership, and</li>
    <li><a href="#_list"><code>_list</code></a> to test against advanced <code>List</code> functionality
    (e.g., functional list definitions).</li>
  </ul>
</p>

<a name="identifierreferences"></a>
<h5>Identifiers and References</h5>
<p>
  The <a href="datatypes.html#Identifier">Identifier datatype</a> is typically only used on by a single element in a resource
  and is typically named <code>identifier</code>.  The element is typically cardinality <code>0..*</code>, meaning that resources
  may have zero, one, or more identifiers attached to them (e.g., a single patient record with MRNs for several related facilities).
</p>
<p>
  Resources containing identifier elements usually expose a matching search parameter, e.g., <a href="patient.html#search">Patient.identifier</a>
  or <a href="canonicalresource.html#search">CanonicalResource.identifier</a>.  Given the structure of the identifier type, the 
  search parameter is a <a href="#token">token</a> type - see the <a href="#token">token search type</a> for details.
</p>
<p>
  It is often useful to search via reference across resource links.  For example, if you have the MRN for a patient and do not know
  the logical identifier, it is desireable to perform searches like "encounters for the patient with MRN 1234".  There are two ways
  of searching references by identifier, depending on how data is stored in the system: via <a href="#chaining">chaining</a> or via the 
  <a href="#modifieridentifier"><code>identifier</code></a> search modifier.
</p>

<a name="identifiercanonical"></a>
<h5>Canonical Identifiers</h5>
<p>
  Chaining functions by resolving a resource reference and then searching inside it.  In this case, requesting:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Encounter?patient.identifier=http://example.org/facilityA|1234</span>
      <span class="http-verb-display-post">POST [base]/Encounter/_search
Content-Type: application/x-www-form-urlencoded
patient.identifier=http://example.org/facilityA|1234</span>
    </span>
  </span>
  will search Encounter resources, following references in the <code>patient</code> search parameter ("the patient present at the encounter"),
  and testing those Patient resources against the <code>Patient.identifier</code> value of <code>1234</code> in system
  <code>http://example.org/facilityA</code>.  In short, this search will return all Encounters for Patient records matching "1234"
  in "facilityA".
</p>
<p>
  This search is flexible, but does require resolving (searching against) Patient resources, even though
  the request is only for Encounters.  If a system wants to enable searches via identifiers <em>without</em>
  chaining, the server can include additional information in the <a href="references.html#Reference">Reference Datatype</a>
  (in <a href="references-definitions.html#Reference.identifier">Reference.identifier</a>), which is then accessible by
  the <a href="#modifieridentifier"><code>identifier</code></a> search modifier.  Note that this approach requires
  additional bookkeeping by the server - if a patient record is modified, e.g., to add an additional identifier, <b>every</b> 
  resource that reference that patient record would need to be updated.
</p>
<p>
  The <code>identifier</code> modifier functions by testing the <code>Reference.identifier</code> element within resources.
  In this case, requesting:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Encounter?patient:identifier=http://example.org/facilityA|1234</span>
      <span class="http-verb-display-post">POST [base]/Encounter/_search
Content-Type: application/x-www-form-urlencoded
patient:identifier=http://example.org/facilityA|1234</span>
    </span>
  </span>
  will search Encounter resources, testing the <code>Encounter.subject.identifier</code> element against the value of <code>1234</code> in system
  <code>http://example.org/facilityA</code>.  In short, this search will return all Encounters for that have Patient references
  and include the identifier "1234" from "facilityA".
</p>
<p>
  Note that the difference between the two searches is a single character - the <code>.</code> (period) in the first example
  represents a chained search and the <code>:</code> (colon) in the second indicates the use of a search modifier.
</p>

<a name="identifiercanonical"></a>
<h5>Canonical Identifiers</h5>
<p>
  <a href="canonicalresource.html">Canonical Resources</a> are identified by their 
  <a href="canonicalresource-definitions.html#CanonicalResource.url">url</a> and possibly a version.  Similarly, references
  to canonical resources are made with the <a href="datatypes.html#canonical">canonical</a> datatype.  More details about
  canonical references can be found in the <a href="references.html#canonical">Canonical URLs</a> section of the references page.
</p>
<p>
  When searching canonical references, the search type is <a href="#reference">reference</a>, though with an additional syntax
  for version information.  For more information about version resolution, see the 
  <a href="#versions">References and Versions</a> section of this page.
</p>


<a name="versions"></a>
<h4>References and Versions</h4>
<p>
Elements of type <a href="references.html#Reference">Reference</a> may contain a <a href="references.html#versions">versioned</a> reference:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">{
  "resourceType": "Condition",
  ...
  "evidence": {
    "detail": {
      "reference": "Observation/123/_history/234234"
    }
  },
  ...
}</span>
    <span class="example-format-display-xml">&lt;Condition&gt;
  ...
  &lt;evidence&gt;
    &lt;detail&gt;
      &lt;reference value="Observation/123/_history/234234"/&gt;
    &lt;/detail&gt;
  &lt;/evidence&gt;
  ...
&lt;/Condition&gt;</span>
  </span>
</span>
</p>
<p>
When searching on versioned references, the following rules apply:
</p>
<ul>
 <li>
  If a resource has a reference that is versioned and chaining is performed, the criteria should ideally be evaluated against the version 
  referenced, but most systems will not be capable of this because search is only defined to function against the current version of a resource
 </li>
 <li>
  Where a search does not act on the referenced version, search results SHOULD contain a <a href="operationoutcome.html">OperationOutcome</a> 
  with a warning that indicates the discrepancy
 </li>
 <li>
  If a resource has a reference that is versioned and the resource is included (e.g., <code>_include</code>, <code>_revinclude</code>), 
  the specified version SHOULD be provided.
 </li>
 <li>
  If a reference-type search parameter does not contain a version (i.e., no <code>/_history/[version]</code> in the URL),
  the search will match against resources containing both versioned and un-versioned references.
 </li>
</ul>

<p>
Elements of type <a href="references.html#canonical">canonical</a> may contain a <a href="references.html#versions">version specific</a> reference,
but this version is different in both meaning and format to version specific references that might be found in a <a href="references.html#Reference">Reference</a>:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">{
  "resourceType": "QuestionnaireResponse",
  ...
  "questionnaire": "http://example.org/fhir/questionnaire/patient-intake|3.0",
  ...
}</span>
    <span class="example-format-display-xml">&lt;QuestionnaireResponse&gt;
  ...
  &lt;questionnaire value="http://example.org/fhir/questionnaire/patient-intake|3.0"/&gt;
  ...
&lt;/QuestionnaireResponse&gt;</span>
  </span>
</span>
</p>
<p>
This version is a reference to the business version of the resource.
</p>
<p>
For canonical references, servers SHOULD support searching by Canonical URLs, and SHOULD support
automatically detecting a <code>|[version]</code> portion as part of the search parameter and
interpreting that portion as a search on the business version of the target resource.
The modifier <code>:below</code> is used with canonical references, to control
whether the version is considered in the search. The search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/QuestionnaireResponse?questionnaire:below=http://example.org/fhir/questionnaire/patient-intake</span>
    <span class="http-verb-display-post">POST [base]/QuestionnaireResponse/_search
Content-Type: application/x-www-form-urlencoded
questionnaire:below=http://example.org/fhir/questionnaire/patient-intake</span>
  </span>
</span>
would match QuestionnaireResponses based on Questionnaires:
</p>
<ul>
  <li>http://example.org/fhir/questionnaire/patient-intake|1.0</li>
  <li>http://example.org/fhir/questionnaire/patient-intake|1.1</li>
  <li>http://example.org/fhir/questionnaire/patient-intake|2.0</li>
  <li>Etc.</li>
</ul>
<p>
The search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/QuestionnaireResponse?questionnaire:below=http://example.org/fhir/questionnaire/patient-intake|1</span>
    <span class="http-verb-display-post">POST [base]/QuestionnaireResponse/_search
Content-Type: application/x-www-form-urlencoded
questionnaire:below=http://example.org/fhir/questionnaire/patient-intake|1</span>
  </span>
</span>
would match QuestionnaireResponses based on Questionnaires with a major version of '1', e.g.:
<ul>
  <li>http://example.org/fhir/questionnaire/patient-intake|1.0</li>
  <li>http://example.org/fhir/questionnaire/patient-intake|1.1</li>
</ul>
For further information about searching canonical references, 
see <a href="references.html#canonical-matching">Choosing the right Canonical Reference</a>.
</p>

<a name="recursive"></a>
<h4>Searching Hierarchies</h4>
<p>
Some references are <a href="references.html#circular">circular</a> - that is, the reference
points to another resource of the same type. When the reference establishes a strict hierarchy,
the modifiers :above and :below may be used to search transitively through the hierarchy:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Procedure?location:below=42</span>
    <span class="http-verb-display-post">POST [base]/Procedure/_search
Content-Type: application/x-www-form-urlencoded
location:below=42</span>
  </span>
</span>
</p>
<p>
This search returns not only all procedures that occurred at location with id 42, but also any procedures
that occurred in locations that are part of location with id 42.
</p>
<p>
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/MedicationAdministration?encounter:above=21</span>
    <span class="http-verb-display-post">POST [base]/MedicationAdministration/_search
Content-Type: application/x-www-form-urlencoded
encounter:above=21</span>
  </span>
</span>
</p>
<p>
Returns all medication administrations that happened during encounter with id 21 or during any "parent"
encounter of that encounter.
</p>
<p>
Servers indicate that :above/:below is supported on a search parameter by defining them as
<a href="searchparameter-definitions.html#SearchParameter.modifier">Modifiers</a> on the
Search Parameter definition.
</p>


<a name="mimetype"></a>
<h4>Searching MIME Types</h4>
<p>
The <code>:below</code> modifier is also very useful with searching <a href="https://datatracker.ietf.org/doc/html/rfc6838">MIME type</a>, 
such as the search parameter <a href="documentreference.html#search">DocumentReference.contenttype</a>,
which refers to <a href="datatypes.html#Attachment">Attachment.contentType</a>. A simple search such as:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/DocumentReference?contenttype=text/xml</span>
    <span class="http-verb-display-post">POST [base]/DocumentReference/_search
Content-Type: application/x-www-form-urlencoded
contenttype=text/xml</span>
  </span>
</span>
will miss documents with a MIME type such as <code>text/xml; charset=UTF-8</code>. This
search will find all text/xml documents:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/DocumentReference?contenttype:below=text/xml</span>
    <span class="http-verb-display-post">POST [base]/DocumentReference/_search
Content-Type: application/x-www-form-urlencoded
contenttype:below=text/xml</span>
  </span>
</span>
</p>
<p>
For ease of processing on the server, servers are only required to support <code>:below</code> on the
base part of the MIME type; servers are not required to sort between different parameters and do
formal subsumption logic.
</p>
<p>
  Additionally, the <code>below</code> modifier can be applied to the first segment only:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/DocumentReference?contenttype:below=image</span>
      <span class="http-verb-display-post">POST [base]/DocumentReference/_search
Content-Type: application/x-www-form-urlencoded
contenttype:below=image</span>
    </span>
  </span>
  will match all <code>image/</code> content types, e.g., "image/png", "image/jpeg", etc.
</p>
  

<a name="chaining"></a>
<h4>Chaining (chained parameters)</h4>
<p>
In order to save a client from performing a series of search operations,
reference parameters may be "chained" by appending them with
a period (<code>.</code>) followed by the name of a search parameter defined for the target
resource. This can be done recursively, following a logical path
through a graph of related resources, separated by <code>.</code>.
For instance, given that
the resource <a href="diagnosticreport.html">DiagnosticReport</a>
has a search parameter named <i>subject</i>, which is usually a
reference to a <a href="patient.html">Patient</a> resource, and
the Patient resource includes a parameter <i>name</i> which
searches on patient name, then the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/DiagnosticReport?subject.name=peter</span>
    <span class="http-verb-display-post">POST [base]/DiagnosticReport/_search
Content-Type: application/x-www-form-urlencoded
subject.name=peter</span>
  </span>
</span>
is a request to return all the lab reports that have a subject whose name includes "peter". Because
the Diagnostic Report subject can be one of a set of different resources, it's necessary to limit
the search to a particular type:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/DiagnosticReport?subject:Patient.name=peter</span>
    <span class="http-verb-display-post">POST [base]/DiagnosticReport/_search
Content-Type: application/x-www-form-urlencoded
subject:Patient.name=peter</span>
  </span>
</span>
This request returns all the lab reports that have a subject which is a patient, whose name includes "peter".
</p>
<p>
Note that chained parameters are applied independently to the target resource. For example,
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
general-practitioner.name=Joe&amp;general-practitioner.address-state=MN</span>
  </span>
</span>
may return Patients cared for by Joe from CA and Jane from MN: no one practitioner need satisfy both conditions.
E.g. the chains are evaluated separately. For use cases where the joins must be evaluated in groups,
there are either <a href="#composite">Composite</a> search parameters, or the <a href="#filter">_filter</a>
parameter.
</p>
<p>
  Note that chained search parameters are not intended to work with <a href="#modifiers">search modifiers</a>.
  While their use is not prohibited, searches requiring advanced matching across resources are encouraged
  to use <a href="#advanced">Named Queries</a> or <a href="#_filter">Advanced filtering</a>.
</p>
<p>
Advanced Search Note:
Where a chained parameter searches a resource reference that may have more than one
type of resource as its target, the parameter chain may end up referring
to search parameters with the same name on more than one kind of resource at once.
Servers SHOULD reject a search where the logical id refers to more than one matching
resource across different types.  For example, the client has to specify the type explicitly
using the syntax in the second example above.
</p>

<a name="has"></a>
<h4>Reverse Chaining</h4>
<p>
The _has parameter provides limited support for reverse chaining - that is, selecting
resources based on the properties of resources that refer to them (instead of chaining,
above, where resources can be selected based on the properties of resources that they
refer to). Here is an example of the _has parameter:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?_has:Observation:patient:code=1234-5</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_has:Observation:patient:code=1234-5</span>
  </span>
</span>
</p>
<p>
This requests the server to return Patient resources, where the patient resource is
referred to by at least one Observation where the observation has a code of 1234, and
where the Observation refers to the patient resource in the patient search parameter.
</p>
<p>
"Or" searches are allowed (e.g. <code>_has:Observation:patient:code=123,456</code>), and multiple <code>_has</code>
parameters are allowed (e.g. <code>_has:Observation:patient:code=123&amp;_has:Observation:patient:code=456</code>).
Note that each <code>_has</code> parameter is processed independently of other <code>_has</code> parameters.
</p>
<p>
The <code>_has</code> parameter can be nested, like this:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?_has:Observation:patient:_has:AuditEvent:entity:agent=MyUserId</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_has:Observation:patient:_has:AuditEvent:entity:agent=MyUserId</span>
  </span>
</span>
This search will fetch all Patient records that have an Observation where the observation has an audit event from a specific user.
</p>
<p>
  The <code>_has</code> parameter can also be used in chained-searches, for example:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Encounter?patient._has:Group:member:_id=102</span>
      <span class="http-verb-display-post">POST [base]/Encounter/_search
Content-Type: application/x-www-form-urlencoded
patient._has:Group:member:_id=102</span>
    </span>
  </span>
  to search for the Encounters of patients that are members of the Group "102".
</p>
<p>
  Note that reverse-chained search parameters are not intended to work with <a href="#modifiers">search modifiers</a>.
  While their use is not prohibited, the syntax of <code>_has</code> makes construction and parsing error-prone.
  Searches requiring advanced matching across resources are encouraged
  to use <a href="#advanced">Named Queries</a> or <a href="#_filter">Advanced filtering</a>.
</p>


<a name="missing"></a>
<h4>Handling Missing Data</h4>
<p>
Consider the case of searching for all AllergyIntolerance resources:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/AllergyIntolerance?clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active</span>
    <span class="http-verb-display-post">POST [base]/AllergyIntolerance/_search
Content-Type: application/x-www-form-urlencoded
clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active</span>
  </span>
</span>
</p>
<p>
This search will only return resources that have a value for clinicalStatus:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
{
  "resourceType" : "AllergyIntolerance",
   "clinicalStatus": {
    "coding": [
      {
        "system": "http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical",
        "code": "active"
      }
    ]
  }
}
    </span>
    <span class="example-format-display-xml">
&lt;AllergyIntolerance&gt;
  &lt;clinicalStatus&gt;
    &lt;coding&gt;
      &lt;system value="http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical"/&gt;
      &lt;code value="active"/&gt;
    &lt;/coding&gt;
  &lt;/clinicalStatus&gt;
&lt;/AllergyIntolerance&gt;
    </span>
  </span>
</span>
</p>
<p>
Resources missing a clinicalStatus will not be returned. This is probably unsafe - it would not usually
be appropriate to ignore AllergyIntolerance warnings with an unknown clinical status, and
only return resources with an explicit clinicalStatus. Instead, it might be desired to return
AllergyIntolerance resources with either an explicit value for clinicalStatus, or none:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/AllergyIntolerance?clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active</span>
    <span class="http-verb-display-post">POST [base]/AllergyIntolerance/_search
Content-Type: application/x-www-form-urlencoded
clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/AllergyIntolerance?clinical-status:missing=true</span>
    <span class="http-verb-display-post">POST [base]/AllergyIntolerance/_search
Content-Type: application/x-www-form-urlencoded
clinical-status:missing=true</span>
  </span>
</span>
</p>
<p>
Note that this is 2 separate queries. They can be <a href="http.html#transaction">combined in a batch</a>,
but not in a single operation. This query will always return an empty list, as no resource can satisfy both criteria at once:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/AllergyIntolerance?clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active&amp;clinical-status:missing=true</span>
    <span class="http-verb-display-post">POST [base]/AllergyIntolerance/_search
Content-Type: application/x-www-form-urlencoded
clinical-status=http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical|active&amp;clinical-status:missing=true</span>
  </span>
</span>
</p>
<p>
There is no way to use the :missing modifier and mix with a value using the
comma syntax documented above for composite search parameters.
</p>
<p>
An alternative approach is to use the <a href="#filter"><code>_filter</code></a> parameter,
for servers that support this parameter.
</p>

<a name="filter"></a>
<a name="_filter"></a>
<h4>Advanced filtering</h4>
<p>
The search mechanism described above is flexible, and easy to implement
for simple cases, but is limited in its ability to express combination
queries. To complement this mechanism, the <code>_filter</code> search expression
parameter can be used.
</p>
<p>
For example, "Find all the
observations for patient with a name including <code>peter</code> that have a LOINC code <code>1234-5</code>":
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?code=http://loinc.org|1234-5&amp;subject.name=peter</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
code=http://loinc.org|1234-5&amp;subject.name=peter</span>
  </span>
</span>
</p>
<p>
Using the <code>_filter</code> parameter, the search would be expressed like this (note that the value is unescaped for readability):
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_filter=code eq http://loinc.org|1234-5 and subject.name co "peter"</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_filter=code eq http://loinc.org|1234-5 and subject.name co "peter"</span>
  </span>
</span>
</p>
<p>
The <code>_filter</code> parameter is described in detail on the <a href="search_filter.html">"_Filter Parameter" page</a>.
</p>

<a name="type"></a>
<h4>Searching Multiple Resource Types</h4>
<p>
Normally, a search is initiated against a known type of resource, e.g.:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?params...</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
params...</span>
  </span>
</span>
However, in some circumstances, a search is executed where there is no fixed
type of resource, for example:
</p>
<ul>
 <li>Using search across all resource types (<code>[base]?params...</code>)</li>
 <li>Using search with <a href="messaging.html">messaging</a></li>
 <li>Some search specifications inside other services e.g. decision support usage</li>
</ul>
<p>
In these circumstances, the search criteria may need to specify one or more resource
types that the search applies to. This can be done by using the standard search parameter
<a href="#_type"><code>_type</code></a>.
</p>
<p>
  If no type is specified, the only search parameters that can be used in global search like
  this are the base parameters that apply to <a href="#all">all resources</a>.
</p>
<p>
  If a single type is specified, all search parameters for that type are allowed.
</p>
<p>
  If multiple types are specified, all search parameters that can be referenced commonly
  between resources can be used (e.g., listed with the same <code>name</code> in the
  CapabilityStatement, typically the value of 
  <a href="searchparameter-definitions.html#SearchParameter.code">SearchParameter.code</a>)
  <span class="stu">TU</span>.
  For example, both <a href="patient.html#search">Patient</a> and <a href="person.html#search">Person</a>
  define a search parameter referenced by <code>name</code>.  Assuming a server implements
  both parameters and uses <code>name</code> to do so, the <code>name</code> parameter
  can be used to search across both Patient and Person resources.  Note that this is allowed
  even though the search parameters do not share a common definition. If a request references
  multiple parameters that are not the same type (e.g., if one parameter is a
  <code>number</code> type and another is a <code>token</code> type, despite sharing the same name),
  this is an error and servers SHOULD return a 400 status <span class="stu">TU</span>.
</p>

<a name="implicitresources"></a>
<h4>Implicit Resources</h4>
<p>
  Some resources are defined <i>implicitly</i> rather than as explicit instances 
  (e.g. <a href="codesystem.html#detailed-metadata">Implicit Code Systems</a>).  When searching 
  resources where implicit instances might exist, it is up to the server whether they will include 
  implicit resources as part of the search set.  Implementation Guides MAY set specific expectations 
  about search behavior around implicit resources. <span class="stu">TU</span>
</p>

<a name="advanced"></a>
<h4>Named Queries</h4>
<p>
The search framework described above is a useful framework
for providing a simple search based on indexed criteria,
but more sophisticated query capability is needed to handle precise
queries, complex decision support-based requests, and
direct queries that have human resolution.  To support more advanced functionality,
this specification defines a method for creating and using <i>named</i>.
</p>
<p>
The <a href="#_query"><code>_query</code></a> parameter names a custom search profile that
describes a specific query operation. The named query
may define additional named parameters that are used with that
particular named query. Servers can define their own additional
named queries to meet their own uses using an <a href="operationdefinition.html">OperationDefinition</a>.
</p>
<p>
  Query operations are only allowed in the <code>base</code> and <code>type</code> 
  <a href="#searchcontexts">search contexts</a>.  Named queries cannot be defined
  at the <code>instance</code> level.  Query operations SHOULD NOT be invoked via
  any method other than search with the <code>_query</code> parameter (e.g., 
  servers SHOULD NOT execute query operations via <code>[base]/$[operation code]</code>, etc.).
  <span class="stu">TU</span>
</p>
<p>
  For named queries, all the <a href="#standard">standard search parameters</a> (parameters for 
  <a href="#all">all resources</a> and <a href="#modifyingresults">search result</a> parameters) are potentially 
  available for use in addition to any parameters defined by the query operation. In addition, if the query 
  operation is defined in the scope of a specific resource, the search parameters for that resource are also 
  potentially available. For example, a named query with a scope of <code>Patient</code> could include the 
  <a href="#_lastUpdated"><code>_lastUpdated</code></a>, <a href="#_sort"><code>_sort</code></a>, and/or 
  <a href="patient.html#search">Patient.gender</a> search parameters, even if those aren't explicitly listed 
  as parameters on the query operation.
</p>
<p>
  Servers do not need to support ANY such 'inherited' parameters unless explicitly documented in the operation's 
  description. Clients should not assume the availability of any search parameter that is not supported for 
  general queries (i.e. listed in the server's <a href="capabilitystatement.html">CapabilityStatement</a>, either in 
  <a href="capabilitystatement-definitions.html#CapabilityStatement.rest.searchParam">CapabilityStatement.rest.searchParam</a> or 
  <a href="capabilitystatement-definitions.html#CapabilityStatement.rest.resource.searchParam">CapabilityStatement.rest.resource.searchParam</a>). 
  Servers MAY further document the search parameters they support for a specific <code>query</code> operation - either in text 
  or by defining a constrained operation based on the original that explicitly enumerates all supported parameters. <span class="stu">TU</span>
</p>
<p>
  In order to ensure consistent behavior, authors SHOULD include relevant search parameters
  in the named query definition (<code>OperationDefinition</code>). <span class="stu">TU</span>
</p>
<p>
  For example, the operation definition:
  <span class="fhir-example">
    <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
    <span class="example-format-display">
      <span class="example-format-display-json">{
  "resourceType": "OperationDefinition",
  "id": "current-high-risk",
  "url": "http://example.org/OperationDefinition/current-high-risk",
  "version": "0.0.1",
  "name": "Current High-Risk Patients",
  "status": "draft",
  "kind": "query",
  "description": "Filter Patients based on risk assessments",
  "code": "current-high-risk",
  "resource": [ "Patient" ],
  "system": false,
  "type": true,
  "instance": false,
  "parameter": [
    {
      "name": "ward",
      "use": "in",
      "min": 0,
      "max": "*",
      "documentation": "Ward filters to apply to patient locations",
      "type": "string",
      "searchType": "reference"
    },
    {
      "name": "return",
      "use": "out",
      "min": 1,
      "max": "1",
      "documentation": "Searchset bundle",
      "type": "Bundle"
    }
  ]
}</span>
      <span class="example-format-display-xml">&lt;OperationDefinition xmlns="http://hl7.org/fhir"&gt;
  &lt;id value="current-high-risk" /&gt;
  &lt;url value="http://example.org/OperationDefinition/current-high-risk" /&gt;
  &lt;version value="0.0.1" /&gt;
  &lt;name value="Current High-Risk Patients" /&gt;
  &lt;status value="draft" /&gt;
  &lt;kind value="query" /&gt;
  &lt;description value="Filter Patients based on risk assessments" /&gt;
  &lt;code value="current-high-risk" /&gt;
  &lt;resource value="Patient" /&gt;
  &lt;system value="false" /&gt;
  &lt;type value="true" /&gt;
  &lt;instance value="false" /&gt;
  &lt;parameter&gt;
    &lt;name value="ward" /&gt;
    &lt;use value="in" /&gt;
    &lt;min value="0" /&gt;
    &lt;max value="*" /&gt;
    &lt;documentation value="Ward filters to apply to patient locations" /&gt;
    &lt;type value="string" /&gt;
    &lt;searchType value="reference" /&gt;
  &lt;/parameter&gt;
  &lt;parameter&gt;
    &lt;name value="return" /&gt;
    &lt;use value="out" /&gt;
    &lt;min value="1" /&gt;
    &lt;max value="1" /&gt;
    &lt;documentation value="Searchset bundle" /&gt;
    &lt;type value="Bundle" /&gt;
  &lt;/parameter&gt;
&lt;/OperationDefinition&gt;</span>
    </span>
  </span>
</p>
<p>
  Note that operations defined as named queries (using a <code>OperationDefinition.kind</code> of <code>query</code>)
  SHOULD NOT be invoked via any mechanism other than search (i.e., do not expose <code>[base]/[type]/$[operation code]</code>)
  <span class="stu">TU</span>.
</p>


<a name="modifyingresults"></a>
<h3>Modifying Search Results</h3>
<p>
  Along with search parameters that are used as input to search filters, there are also Search Result Parameters
  defined by this specification to modify the results of a performed search.  These parameters control aspects 
  of the results such as sort order, including additional resources, etc., and are defined in the following 
  sections. Note that since these are not search parameters, they do not have definitions as 
  <a href="searchparameter.html">SearchParameter</a> resources and do not appear in the
  <a href="searchparameter-registry.html#common">search parameter registry</a>.
</p>
<p>
  Note that with the exception of <code>_include</code> and <code>_revinclude</code>, search result parameters SHOULD only appear once in a 
  search.  If such a parameter appears more than once, the behavior is undefined and a server MAY treat the situation 
  as an error <span class="stu">TU</span>.
</p>
<p>
  The search result parameters defined by this specification are:
</p>
<table class="grid">
  <tr>
    <td><code><a href="#_contained">_contained</a></code></td>
    <td>
      Request different types of handling for contained resources.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_count">_count</a></code></td>
    <td>
      Limit the number of <code>match</code> results per page of response.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_elements">_elements</a></code></td>
    <td>
      Request that only a specific set of elements be returned for resources.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_graph">_graph</a></code> <span class="stu">TU</span></td>
    <td>
      Include additional resources according to a <code>GraphDefinition</code>.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_include">_include</a></code></td>
    <td>
      Include additional resources, based on following links forward across references.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_revinclude">_revinclude</a></code></td>
    <td>
      Include additional resources, based on following reverse links across references.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_score">_score</a></code></td>
    <td>
      Request match relevance in results.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_sort">_sort</a></code></td>
    <td>
      Request which order results should be returned in.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_summary">_summary</a></code></td>
    <td>
      Return only portions of resources, based on pre-defined levels.
    </td>
  </tr>
  <tr>
    <td><code><a href="#_total">_total</a></code> <span class="stu">TU</span></td>
    <td>
      Request a precision of the total number of results for a request.
    </td>
  </tr>
</table>

<a name="sort"></a>
<a name="_sort"></a>
<h4>Sorting (_sort)</h4>
<p>
The client can indicate which order to return the results by
using the parameter <code>_sort</code>, which can contain a
comma-separated list of sort rules in priority order:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_sort=status,-date,category</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_sort=status,-date,category</span>
  </span>
</span>
</p>
<p>
Each item in the comma separated list is a search parameter,
optionally with a '-' prefix. The prefix indicates decreasing
order; in its absence, the parameter is applied in increasing order.
</p>
<p>
Notes:
</p>
<ul>
 <li>When sorting, the actual sort value used is not returned explicitly by
     the server for each resource, just the resource contents.</li>
 <li>To sort by relevance, use <code>_score</code>.</li>
 <li>The server returns the sort it performs as part of the returned
     search parameters (see <a href="#conformance">below</a>).</li>
 <li>
  Servers have discretion on the implementation of sorting for both repeated elements and complex elements. 
  For example, if requesting a sort on <code>Patient.name</code>, servers might search by family name 
  then given, given name then family, or prefix, family, and then given. Similarly, when 
  sorting with multiple given names, the sort might be based on the 'earliest' name in sort order or the 
  first name in the instance.
 </li>
  <li>When sorting on string search parameters, sorting SHOULD be performed
     on a case-insensitive basis. Accents may either be ignored or sorted as
     per realm convention.</li>
  <li>This specification does not specify exact rules for consistency of sorting
     across servers. In general, this is deemed to be not as essential as
     consistency of filtering (though even that is a little variable). The
     purpose of sorting is to provide data in a "reasonable" order for end-users.
    "Reasonable" may vary by use case and realm, particularly for accented characters.</li>
  <li>When sorting on search parameters of <code>reference</code> and <code>token</code>
    types, the search parameter MAY include the <a href="#modifiertexttoken">text modifier</a>
    to request sorting based on the text or display portions of the element values.
    For example, <code>_sort=code:text</code> or <code>_sort:-code:text</code>.</li>
</ul>

<a name="total"></a>
<a name="_total"></a>
<h4>Total number of matching resources (_total)</h4>
<p>
The return <a href="bundle.html">Bundle</a> has an element <code>total</code>
which is the number of resources that match the search parameters.
</p>
<p>
Note that <code>Bundle.total</code> represents the total
number of matches, not how many resources are returned in
a particular response (see <a href="#count">paging</a>).
</p>
<p>
Providing a precise number of matching resources may be onerous for the
server, depending on how the server is designed. To help reduce the server
load, a client can provide the parameter <code>_total</code> to indicate
its preference with regard to the total, which can have one of the
following values:
</p>
<table class="codes">
 <tr><td>none</td><td>There is no need to populate the total count; the client will not use it</td></tr>
 <tr><td>estimate</td><td>A rough estimate of the number of matching resources is sufficient</td></tr>
 <tr><td>accurate</td><td>The client requests that the server provide an exact total of the number of matching resources</td></tr>
</table>
<p>
The <code>Bundle.total</code> element is still optional, and the servers can ignore the <code>_total</code>
parameter: it is just an optimization hint, that might possibly save the server some work.
</p>
<div class="trial-content">
  <p>
  The _total parameter has the status <a href="versions.html#std-process" title="Trial Content" class="draft-flag">trial-use</a>
  pending real world experience of it's use.
  </p>
</div>

<a name="count"></a>
<a name="_count"></a>
<h4>Limiting Page Size (_count)</h4>
<p>
In order to keep the load on clients, servers and the network
minimized, the server may choose to return the results in
a series of pages. The search result set contains the URLs
that the client uses to request additional pages from the
search set. For a simple RESTful search, the page links are
<a href="http.html#paging">contained in the returned bundle as links</a>.
</p>
<p>
Typically, a server will provide its own parameters in the links
that it uses to manage the state of the search as pages are
retrieved. These parameters do not need to be understood
or processed by the client.
</p>
<p>
The parameter <code>_count</code> is defined as an instruction to the server
regarding how many resources should be returned in a
single page. Servers SHALL NOT return more resources in a single page than requested,
even if they don't support paging, but may return less than the client requested.
NOTE: This means that all servers that support search or history SHALL support
checking the _count parameter. The server SHOULD ensure that any pages reachable via 
links (e.g. previous/next) respect the the original requested
<code>_count</code> expectations (or a server-overridden max page size).  Note:
It is at the discretion of the search engine as to how to
handle ongoing updates to the resources while the search
is proceeding.
</p>
<p>
Note: The combination of <code>_sort</code> and <code>_count</code> can be used to return
only the latest resource that meets a particular criteria - set the
criteria, and then sort by date in descending order, with <code>_count=1</code>.
This way, the last matching resource will be returned.
</p>
<p>
if <code>_count</code> has the value 0, this shall be treated the same as <code>_summary=count</code>: the
server returns a bundle that reports the total number of resources that match in Bundle.total,
but with no entries, and no prev/next/last links. Note that the <code>Bundle.total</code> only
include the total number of matching resources. It does not count extra resources such as
<a href="operationoutcome.html">OperationOutcome</a> or <a href="#include">included</a> resources that may also be returned.
In the same way, the _count parameter only applies to resources with <code>entry.search.mode = match</code>, and does not include
included resources or operation outcomes.
</p>
<p>
The _count parameter has no impact on the value of <code>Bundle.total</code> as the latter represents the total
number of matches, not how many are returned in a single Bundle response.
</p>


<a name="summary"></a>
<a name="_summary"></a>
<h4>Summary (_summary)</h4>
<p>
The client can request the server to return only a portion of the resources
by using the parameter <code>_summary</code>:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/ValueSet?_summary=true</span>
    <span class="http-verb-display-post">POST [base]/ValueSet/_search
Content-Type: application/x-www-form-urlencoded
_summary=true</span>
  </span>
</span>
</p>
<p>
The <code>_summary</code> parameter requests the server to return a subset of the
resource. It can contain one of the following values:
</p>
<table class="codes">
 <tr>
  <td><a href="#summary-true">true</a></td>
  <td>
    Return a limited subset of elements from the resource.  This subset SHOULD consist solely of all supported 
    elements that are marked as "summary" in the base definition of the resource(s) (see 
    <a href="elementdefinition-definitions.html#ElementDefinition.isSummary">ElementDefinition.isSummary</a>)
  </td>
 </tr>
 <tr>
  <td><a href="#summary-text">text</a></td>
  <td>
    Return only the <code>text</code>, <code>id</code>, <code>meta</code>, and top-level mandatory elements
    (these mandatory elements are included to ensure that the payload is valid FHIR; servers MAY omit elements 
    within these sub-trees as long as they ensure that the payload is valid).  Servers MAY return extensions,
    but clients SHOULD NOT rely on extensions being present and SHOULD use another search mode if data contained
    in extensions is required. <span class="stu">TU</span>
  </td>
 </tr>
 <tr>
  <td><a href="#summary-data">data</a></td>
  <td>Remove the <code>text</code> element</td>
 </tr>
 <tr>
  <td><a href="#summary-count">count</a></td>
  <td>Search only: just return a count of the matching resources, without returning the actual matches</td>
 </tr>
 <tr>
  <td><a href="#summary-false">false</a></td>
  <td>Return all parts of the resource(s)</td>
 </tr>
</table>
<p>
The intent of the <code>_summary</code> parameter is to reduce the total processing load on
server, client, and resources between them such as the network. It is most useful for
resources that are large, particularly ones that include images or elements that
may repeat many times. The purpose of the summary form is to allow a client to quickly
retrieve a large set of resources, and let a user pick the appropriate one. The
summary for an element is defined to allow a user to quickly sort and filter the
resources, and typically omit important content on the basis that the entire
resource will be retrieved when the user selects a resource.
</p>
<p>
Servers are not obliged to return just a summary as requested. There are only
a limited number of summary forms defined for resources in order to allow servers
to store the summarized form(s) in advance. Servers SHOULD mark the by populating
<code>meta.tag</code> resources with the code <a href="https://terminology.hl7.org/CodeSystem-v3-ObservationValue.html#v3-ObservationValue-SUBSETTED"><code>SUBSETTED</code></a>
to ensure that the incomplete resource is not accidentally used to overwrite
a complete resource.
</p>
<p>
The self link in the search result Bundle is important for the interpretation of the result 
and should always be returned, regardless of the type of _summary.  
</p>
<p>
Note that the <code>_include</code> and <code>_revinclude</code> parameters cannot be mixed with <code>_summary=text</code>.
</p>

[%impl-note%]
<a name="dstu-tc"></a>
There is some question about the inclusion of extensions in the summary. Additional rules may be made
around this in the future.
[%end-note%]

<a name="elements"></a>
<a name="_elements"></a>
<h4>Elements (_elements)</h4>
<p>
If one of the summary views defined above is not appropriate, a client can
request a specific set of elements be returned as part of a resource in the search results using
the <code>_elements</code> parameter:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?_elements=identifier,active,link</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_elements=identifier,active,link</span>
  </span>
</span>
</p>
<p>
The <code>_elements</code> parameter consists of a comma-separated list of base element
names such as, elements defined at the root level in the resource. Each element name SHALL 
be the base element name without specifying <code>[x]</code> or one of the types (e.g.,
"value" is valid, while "value[x]" and "valueQuantity" are not) <span class="stu">TU</span>.  Only
elements that are listed are to be returned. Clients SHOULD list all mandatory and modifier
elements in a resource as part of the list of elements.  Servers have the right to return
more data than request, however clients can generally expect that returned elements will be:
<ul>
  <li>elements explicity requested,</li>
  <li>mandatory elements, or</li>
  <li>modifier elements that have values.</li>
</ul>
</p>
<p>
Servers are not obliged to return just the requested elements.
Servers SHOULD always return mandatory and modifier elements whether they are
requested or not. Servers SHOULD mark the resources with the
tag <a href="https://terminology.hl7.org/CodeSystem-v3-ObservationValue.html#v3-ObservationValue-SUBSETTED"><code>SUBSETTED</code></a>
to ensure that the incomplete resource is not actually used to overwrite
a complete resource.
</p>
<p>
If a client supplies <code>_elements</code> values prefixed with resource types, such as 
<code>_elements=Patient.gender</code>, then servers SHOULD apply these element-level restrictions 
to all resources in the returned bundle, rather than just to direct search matches (i.e., 
restrictions should be applied to bundle entries with any search.mode).
</p>

<a name="score"></a>
<a name="_score"></a>
<h4>Relevance (_score)</h4>
<p>
Where a search specifies a non-deterministic sort, the search algorithm
may generate a ranking score to indicate which resources meet
the specified criteria better than others. The server can return this
score in <a href="bundle-definitions.html#Bundle.entry.score">entry.score</a>:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
"entry": {
  "score": 0.45,
  "resource": {
    "resourceType": "Patient",
    ... patient data ...
  }
}
    </span>
    <span class="example-format-display-xml">
&lt;entry&gt;
  &lt;score value=&quot;.45&quot;/&gt;
  &lt;resource&gt;
    &lt;Patient&gt;
      ... patient data ...
    &lt;/Patient&gt;
  &lt;/resource&gt;
&lt;/entry&gt;
    </span>
  </span>
</span>
</p>
<p>
The score is a decimal number with a value between (and including) 0 and 1, where 1 is best match, and 0 is least match.
</p>


<a name="include"></a>
<h4>Including Referenced Resources</h4>
<p>
  Along with resources matching search criteria, clients may request that related resources
  are included with results (i.e., to reduce the overall network delay of repeated retrievals).
  For example, when searching for clinical resources (e.g., <a href="condition.html">Condition</a>,
  <a href="observation.html">Observation</a>, etc.), the client will also generally need the subject
  (<a href="patient.html">Patient</a>) resource that the clinical resource refers to.  This section
  describes several mechanisms for requesting additional data within FHIR search.
</p>
<p>
  Note that implementers should also consider whether using <a href="graphql.html">GraphQL</a> is
  an appropriate approach, but outside the scope of FHIR Search and thus not described here.
</p>

<a name="_include"></a>
<a name="revinclude"></a>
<a name="_revinclude"></a>
<h5>Inline Requests (<code>_include</code> and <code>_revinclude</code>)</h5>
<p>
  The most common method for requesting additional resources is inline, via the search result 
  parameters <code>_include</code> and <code>_revinclude</code>.  The parameters are similar to
  <a href="#chaining">chaining</a> search parameters, in that they follow links between resources
  based on search parameters.
</p>
<p>
  The parameter <code>_include</code> is used to follow links 'forward'.  For example, to include 
  relevant <code>Patient</code> resources for requested <code>Encounter</code> matches, based on the
  <code>Encounter.subject</code> element, using either the <code>subject</code> or 
  <code>patient</code> search parameters.
</p>
<p>
  The parameter <code>_revinclude</code> is used to follow reverse links.  For example, to include 
  relevant <code>Observation</code> resources for requested <code>Patient</code> matches, based on the
  <code>Observation.subject</code> element, using either the <code>subject</code> or
  <code>patient</code> search parameters.
</p>
<p>
  Both <code>_include</code> and <code>_revinclude</code> share the same syntax - up to three components, separated
  by colon characters (<code>:</code>).  The details of the syntax are:
</p>
<ul>
  <li>
    <b><code>[_include|_revinclude]=*</code></b>: the wildcard literal <code>*</code> (asterisk) is requesting all resources and 
    references supported by the server (will typically only be supported references that are indexed). <span class="stu">TU</span>
  </li>
  <li>
    <b><code>[_include|_revinclude]=[resource]:*</code></b>: where <code>[resource]</code> is the name of the source resource from which the join comes
    and the wildcard literal <code>*</code> (asterisk) is requesting all supported reference type search parameters for that resource.  Note that
    the list of search parameters supported for <code>_include</code> or <code>_revinclude</code> is not the same as the list of supported search parameters.
  </li>
  <li>
    <b><code>[_include|_revinclude]=[resource]:[parameter]</code></b>: where <code>[resource]</code> is the name of the source resource from which the join comes
    and <code>[parameter]</code> is the name of a search parameter which must be of type <code>reference</code>.
  </li>
  <li>
    <b><code>[_include|_revinclude]=[resource]:[parameter]:[targetType]</code></b>: where <code>[resource]</code> is the name of the source resource from which
    the join comes, <code>[parameter]</code> is the name of a search parameter which must be of type <code>reference</code>, and <code>[targetType]</code> is
    a specific resource type (for when a search parameter refers to references of multiple types).
  </li>
 </ul>
<p>
  Note that implementers intending to support wildcard (<code>*</code>) segments SHOULD advertise them along with other resources and search parameters
  in their capability statement (e.g., in <code>CapabilityStatement.rest.resource.searchInclude</code>).
</p>
<p>
<code>_include</code> and <code>_revinclude</code> parameters do not include multiple values. Instead, the
parameters are repeated for each different include criteria.
</p>

<p>
Each <code>_include</code> parameter specifies a search parameter to join on:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/MedicationRequest?_include=MedicationRequest:requester</span>
    <span class="http-verb-display-post">POST [base]/MedicationRequest/_search
Content-Type: application/x-www-form-urlencoded
_include=MedicationRequest:requester</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/MedicationRequest?_revinclude=Provenance:target</span>
    <span class="http-verb-display-post">POST [base]/MedicationRequest/_search
Content-Type: application/x-www-form-urlencoded
_revinclude=Provenance:target</span>
  </span>
</span>
</p>
<p>
The first search requests all matching MedicationRequests, and asks the server to follow
the references to any "requester" for each medication returned and include them in the 
returned result set.  The second search requests all prescriptions, and that any
Provenance resources referring to those prescriptions be included in the result set.
</p>

<p>
For each returned resource, the server identifies the resources that meet
the criteria expressed in the join, and adds to the results,
with the <a href="bundle-definitions.html#Bundle.entry.search.mode">entry.search.mode</a>
set to "include" (in some searches, it is not obvious which resources are
matches, and which are includes). If there is no reference, or no matching resource, the resource
cannot be retrieved (e.g. on a different server), then the resource is omitted, and no
error is returned.
</p>
<p>
Servers SHOULD resolve <code>_include</code> and <code>_revinclude</code> requests for version-specific 
references by resolving the version named in the reference.
</p>
<p>
  <code>_include</code> and <code>_revinclude</code> are, by default, invoked only on the initial results
  of the search set, not on any 'included' resources.  To repeatedly perform the <code>_include</code> and 
  <code>_revinclude</code> instructions on included resources, use the 
  <a href="#modifieriterate"><code>iterate</code></a> modifier.
</p>
<p>
  For example, this search returns all <a href="medicationrequest.html">MedicationRequest</a> resources and their 
  <a href="practitioner.html">prescribing Practitioner</a> Resources
  for the matching <a href="medicationdispense.html">MedicationDispense</a> resources:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/MedicationDispense?_include=Medication:prescription
      &amp;_include:iterate=MedicationRequest:requester&amp;criteria...</span>
    <span class="http-verb-display-post">POST [base]/MedicationDispense/_search
Content-Type: application/x-www-form-urlencoded
_include=MedicationDispense:prescription&amp;_include:iterate=MedicationRequest:requester&amp;criteria...</span>
  </span>
</span>
</p>
<p>
  Details about the <code>iterate</code> modifier can be found in the section 
  <a href="#modifieriterate">Modifier: iterate</a>.
</p>
<p>
This technique applies to circular relationships as well. For example,
the first of these two searches includes any related observations to the
target relationships, but only those directly related. The second search
asks for the <code>_include</code> based on <code>related</code> parameter to be executed
iteratively, so it will retrieve observations that are directly related, and
also any related observations to any other included observation.
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_include=Observation:has-member&amp;criteria...</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_include=Observation:has-member&amp;criteria...</span>
  </span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_include:iterate=Observation:has-member&amp;criteria...</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_include:iterate=Observation:has-member&amp;criteria...</span>
  </span>
</span>
</p>
<p>
Both <code>_include</code> and <code>_revinclude</code> use the wild card "*" for the search parameter
name, indicating that any search parameter of type=reference be included.  Though
both clients and servers need to take care not to request or return too many resources
when doing this. Most notably, using iterative wildcards inclusions might lead to the retrieval of the
full patient's record, or even more than that: resources are organized into an interlinked network
and broad <code>_include</code> paths may eventually traverse all possible paths on the server. For
servers, these iterative and wildcard <code>_include</code>s are demanding and may slow the search
response time significantly.
</p>
<p>
It is at the server's discretion how deep to iteratively evaluate the inclusions.
Servers are expected to limit the number of iterations done to an appropriate level
and are not obliged to honor requests to include additional resources in the search results.
Because iterative search is generally resource intensive, it is not the default behavior.
</p>
<p>
When search results are paged, each page of search results should include
the matching includes for the resources in each page, so that each page stands
alone as a coherent package.
</p>

<a name="external"></a>
<h5>External References</h5>
<p>
If the <code>_include</code> path selects a reference that refers to a resource on another server,
the server can elect to include that resource in the search results for the convenience
of the client.
</p>
<p>
If the <code>_include</code> path selects a reference that refers to an entity that is not a Resource, such as
an image attachment, the server may also elect to include this in the returned
results as a <a href="binary.html">Binary</a> resource. For example, the include
path may point to an attachment which is by reference, like this:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
"content": {
  "contentType": "image/jpeg",
  "url": "http://example.org/images/2343434/234234.jpg"
}
    </span>
    <span class="example-format-display-xml">
&lt;content&gt;
  &lt;contentType&gt;image/jpeg&lt;/contentType&gt;
  &lt;url&gt;http://example.org/images/2343434/234234.jpg&lt;/url&gt;
&lt;/content&gt;
       </span>
  </span>
</span>
</p>
<p>
The server can retrieve the target of this reference, and add it to the
results for the convenience of the client.
</p>

<a name="_graph"></a>
<h5>Graph Definitions (_graph) <span class="stu">TU</span></h5>
<p>
  While inline requests for additional resources are flexible, there are times when a more
  structured approach is desired (e.g., optimizing frequent requests, etc.).  To facilitate
  a structured approach, the <code>_graph</code> result parameter is defined.
</p>
<p>
  The <code>_graph</code> result parameter functions as a <a href="#reference">reference</a>
  type search parameter.  The input is a reference to a <a href="graphdefinition.html">GraphDefinition</a>
  resource, which is used to define the graph of desired resources for inclusion.
</p>

<a name="contained"></a>
<a name="_contained"></a>
<a name="containedType"></a>
<a name="_containedType"></a>
<h5>Contained Resources (_contained)</h5>
<p>
By default, search results only include resources that are not contained in other resources.
However, chained parameters will be evaluated inside contained resources. To illustrate this, consider
a <a href="medicationrequest.html">MedicationRequest</a> resource (id: <code>MedicationRequest/23</code>) 
that has a contained Medication resource specifying a custom formulation that has ingredient with an 
<code>itemCodeableConcept</code> "abc" in "http://example.org/medications" (id: <code>Medication/m1</code>).
</p>
<p>
In this case, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/MedicationRequest?medication.ingredient-code=abc</span>
    <span class="http-verb-display-post">POST [base]/MedicationRequest/_search
Content-Type: application/x-www-form-urlencoded
medication.ingredient-code=abc</span>
  </span>
</span>
</p>
<p>
  will include <code>MedicationRequest/23</code> in the results as a match.  The search chained into the 
  contained resource and met the search criteria.
</p>
<p>
  However, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Medication?ingredient-code=abc</span>
    <span class="http-verb-display-post">POST [base]/Medication/_search
Content-Type: application/x-www-form-urlencoded
ingredient-code=abc</span>
  </span>
</span>
will not find <code>Medication/m1</code> - the medication is a contained resource
within a MedicationRequest and not subject to search.  This is because either the
wrong type of resource would be returned (the MedicationRequest containing the Medication), 
or the contained resource would be returned without its container resource (just the Medication),
which would be missing the required context provided by the container resource.
</p>
<p>
Clients can modify the search behavior for contained resources using the <code>_contained</code> 
parameter, which can have one of the following values:
</p>
<ul>
 <li><code>false</code> (default): Do not search and return contained resources</li>
 <li><code>true</code>: search and return only contained resources</li>
 <li><code>both</code>: search and return both contained and non-contained (normal) resources</li>
</ul>
<p>
When contained resources are being returned, the server
can return either the container resource, or the contained resource alone. The
client can specify which by using the <code>_containedType</code> parameter, which can have one of the
following values:
</p>
<ul>
 <li><code>container</code> (default): Return the container resources</li>
 <li><code>contained</code>: return only the contained resource</li>
</ul>

<p>
  To return just the contained Medication (<code>Medication/m1</code>), the following search
  could be used:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Medication?ingredient-code=abc&amp;_contained=true&amp;_containedType=contained</span>
    <span class="http-verb-display-post">POST [base]/Medication/_search
Content-Type: application/x-www-form-urlencoded
ingredient-code=abc&amp;_contained=true&amp;_containedType=contained</span>
  </span>
</span>
  This search would return a result bundle with the contained <code>Medication</code> records.  Note
  that the <code>fullUrl</code> of the entry points to the containing resource first and includes the
  required resolution for the contained resource:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
{
  "resourceType": "Bundle",
  ...
  "entry": [{
    "fullUrl": "http://example.com/fhir/MedicationRequest/23#m1",
    "resource": {
      "resourceType": "Medication",
      "id": "m1",
      ...
    },
    "search": {
      "mode": "match"
    }
  }]
}
    </span>
    <span class="example-format-display-xml">
&lt;Bundle&gt;
  ...
  &lt;entry&gt;
    &lt;fullUrl value="http://example.com/fhir/MedicationRequest/23#m1"/&gt;
    &lt;resource&gt;
      &lt;Medication&gt;
        &lt;id value=&quot;m1&quot;&gt;
        ...
      &lt;/Medication&gt;
    &lt;/resource&gt;
    &lt;search&gt;
      &lt;mode value=&quot;match&quot;/&gt;
    &lt;/search&gt;
  &lt;/entry&gt;
&lt;/Bundle&gt;
    </span>
  </span>
</span>
</p>

<p>
  Similarly, the search could be performed to return the MedicationRequests containing the Medication records:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Medication?ingredient-code=abc&amp;_contained=true&amp;_containedType=container</span>
    <span class="http-verb-display-post">POST [base]/Medication/_search
Content-Type: application/x-www-form-urlencoded
ingredient-code=abc&amp;_contained=true&amp;_containedType=container</span>
  </span>
</span>
  This search would return a result bundle with the container <code>MedicationRequest</code> records and the
  relevant contained resources.  Note that even though the request was for <code>Medication</code> resources,
  the container <code>MedicationRequest</code> entries are categorized with the <code>mode</code> of <code>match</code>:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
{
  "resourceType": "Bundle",
  ...
  "entry": [{
    "resource": {
      "resourceType": "MedicationRequest",
      "id": "23",
      ...
      "contained": [{
        "resourceType": "Medication",
        "id": "m1",
        ...
      }],
      ...
    },
    "search": {
      "mode": "match"
    }
  }]
}
    </span>
    <span class="example-format-display-xml">
&lt;Bundle&gt;
  ...
  &lt;entry&gt;
    &lt;resource&gt;
      &lt;MedicationRequest&gt;
        &lt;id value=&quot;23&quot;&gt;
        ...
        &lt;contained&gt;
          &lt;Medication&gt;
            &lt;id value=&quot;m1&quot;&gt;
            ...
          &lt;/Medication&gt;
        &lt;contained&gt;

      &lt;/MedicationRequest&gt;
    &lt;/resource&gt;
    &lt;search&gt;
      &lt;mode value=&quot;match&quot;/&gt;
    &lt;/search&gt;
  &lt;/entry&gt;
&lt;/Bundle&gt;
        </span>
  </span>
</span>
</p>

<a name="Paging"></a>
<h5>Paging and Other Resources</h5>
<p>
When returning paged results for a search with <code>_include</code> resources, all <code>_include</code> resources that are
related to the primary resources returned for the page SHOULD also be returned as part of that
same page, even if some of those resource instances have previously been returned on previous
pages.  This approach allows both sender and receiver to avoid caching results of other pages.
</p>


<a name="standard"></a>
<h3>Standard Parameters</h3>
<p>
  Search parameters can be defined in either the core specification or externally (e.g., via Implementation Guides).
  The parameters defined in the core specification fall into a few categories, as listed below.
</p>
<p>
  Note that if a 'base' <a href="searchparameter.html">SearchParameter</a> defined by HL7 or an implementation guide 
  (i.e., one that does not inherit from another <code>SearchParameter</code> definition) is referenced and the 
  <code>SearchParameter</code> does not otherwise enumerate the modifiers and comparators, then all 
  <a href="#modifiers">modifiers</a> and <a href="#prefix">prefixes</a> that are permitted for that parameter's
  <a href="#ptypes">search type</a> are expected to be supported.  If an implementation wishes to restrict which 
  modifiers they support, the implementation must define their own <code>SearchParameter</code> instance, which
  SHOULD inherit from the original definition <span class="stu">TU</span>.  The definition of any locally-defined  
  search parameters SHALL be available to clients, either as resources at the <code>[base]/SearchParameter</code>
  endpoint or as <a href="references.html#contained">contained</a> resources in the 
  <a href="capabilitystatement.html">CapabilityStatement</a> <span class="stu">TU</span>.
</p>

<a name="all"></a>
<h4>Parameters for all resources</h4>
<p>
The following parameters apply <a href="resource.html#search">to all resources</a>: [%allparams%]. In addition, the search
parameters <a href="#text"><code>_text</code></a> and <a href="#filter"><code>_filter</code></a>, (documented below) also applies to all resources (as do the search result parameters).
</p>

<a name="_content"></a>
<h5>_content</h5>
<p>
  The standard search parameter <code>_content</code> is used to allow searching all textual content of
  a resource.
</p>
<p>
  The <code>_content</code> search parameter is defined as a <a href="#special">special</a> type parameter.
  While the actual format used by the parameter is implementation-dependant, the search is some form of string
  which can be used for advanced searching (similar to <a href="#_text"><code>_text</code></a>).
</p>
<p>
  For example, the following search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_content=cancer OR metastases OR tumor</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_content=cancer OR metastases OR tumor</span>
  </span>
</span>
  is a search for Observations that contain any of the phrases "cancer", "metastases", and "tumor" anywhere in 
  the resource.  For example, the key words may appear in:
  <ul>
    <li><code>Observation.text</code> - Text summary of the resource, for human interpretation</li>
    <li><code>Observation.code.text</code> - Type of observation, Plain text representation of the concept</li>
    <li><code>Observation.note</code> - Comments about the observation</li>
    <li>etc.</li>
  </ul>
</p>
<p>
  The server MAY choose to search for related terms (e.g., "carcinoma", etc.), but is not required to do so.
</p>
<p>
  More information can be found in the section <a href="#text">Text Search Parameters</a>.
</p>

<a name="id"></a>
<a name="_id"></a>
<h5>_id</h5>
<p>
  The standard search parameter <code>_id</code> is used to allow searching based on the logical identifier
  of resources (<code>Resource.id</code>). The parameter requires a resource type specified in the 
  <a href="#searchcontexts">search context</a> - it can only be used in searches that contain a <code>[type]</code> 
  component in the search request.
</p>
<p>
  The <code>_id</code> search parameter is defined as a <a href="#token">token</a> type parameter, with the
  restriction that only the <code>code</code> segment is allowed (e.g., no vertical pipes).  This means that
  the literal provided as search input is matched as a code instead of a string - e.g., exact match instead
  of case-insensitive starts-with.
</p>
<p>
  For example, the following search:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <span class="http-verb-display">
      <span class="http-verb-display-get">GET [base]/Patient?_id=23</span>
      <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_id=23</span>
    </span>
  </span>
  is a search for Patient records with a logical id of "23".
</p>
<p>
  For information about the difference between performing a read operation and searching by identifier, see
  <a href="#specialidentifiers">Searching Identifiers</a>.
</p>

<a name="_in"></a>
<h5>_in</h5>
<p>
  The standard search parameter <code>_in</code> is used to match resources against <b>active</b> membership in collection
  resources.  Matching is performed against the <code>Resource.id</code> of the resource against the membership
  test of a collection resource (e.g., CareTeam, Group, List). Details about how each resource applies the
  active membership test can be found on the relevant resource pages:
  <ul>
    <li><a href="group.html#membership">Group Membership</a></li>
    <li><a href="list.html#membership">List Membership</a></li>
  </ul>
</p>
<p>
  The <code>_in</code> search parameter is defined as a <a href="#reference">reference</a> type parameter.  The
  target of the reference must be one of: <code>CareTeam</code>, <code>Group</code>, or <code>List</code>.
</p>
<p>
  For example:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <table>
      <tr><td width="50%"><b>Description</b></td><td><b>Search</b></td></tr>
      <tr>
        <td>Any resource in a CareTeam, List, or Group with id "101"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/?_in=101</span>
            <span class="http-verb-display-post">POST [base]/_search
Content-Type: application/x-www-form-urlencoded
_in=101</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Conditions in List "102"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Condition?_in=List/102</span>
            <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
_in=List/102</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Patients which are participants of CareTeam "103"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Patient?_in=CareTeam/103</span>
            <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_in=CareTeam/103</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Encounters for Patients in Group "104"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Encounter?patient._in=Group/104</span>
            <span class="http-verb-display-post">POST [base]/Encounter/_search
Content-Type: application/x-www-form-urlencoded
patient._in=Group/104</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Smooth muscle relaxant medications that are not in the allergy list "105"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Medication?code:below=http://snomed.info/sct|90000002&amp;ingredient._in:not=List/105</span>
            <span class="http-verb-display-post">POST [base]/Medication/_search
Content-Type: application/x-www-form-urlencoded
code:below=http://snomed.info/sct|90000002&amp;ingredient._in:not=List/105</span>
          </span>
        </td>
      </tr>
    </table>
   </span>  
</p>
<p>
  Note that inactive/excluded members are not considered 'in' the membership.  If a full reference is required,
  <a href="#chaining">chaining</a> can be used to search all references.
</p>
<p>
  For more information about membership testing, see <a href="#membership">Searching by Membership</a>.
</p>

<a name="_language"></a>
<h5>_language</h5>
<p>
  The standard search parameter <code>_language</code> is used to match resources based on the language of 
  the resource used.  Note that match testing is performed against the element <code>Resource.language</code> 
  and does not match against the actual language used in elements. 
</p>
<p>
  The <code>_language</code> search parameter is defined as a <a href="#token">token</a> type parameter. 
  <a href="resource-definitions.html#Resource.language">Resource.language</a> is restricted to 
  <a href="valueset-languages.html">Common Languages</a> and <a href="valueset-all-languages.html">All Languages</a>.
</p>
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Questionnaire?_language=es</span>
    <span class="http-verb-display-post">POST [base]/Questionnaire/_search
Content-Type: application/x-www-form-urlencoded
_language=es</span>
  </span>
</span>
will match Questionnaire resources with a <code>Resource.language</code> of <code>es</code> (Spanish).
</p>

<a name="lastUpdated"></a>
<a name="_lastUpdated"></a>
<h5>_lastUpdated</h5>
<p>
  The standard search parameter <code>_lastUpdated</code> is used to match resources based on when
  the most recent change has been made.
</p>
<p>
  The <code>_lastUpdated</code> search parameter is defined as a <a href="#date">date</a> type parameter.
  Matching is performed against the element <a href="resource-definitions.html#Meta.lastUpdated">Resource.meta.lastUpdated</a>,
  or an implementation's internal equivalent.
</p>
<p>
For example, the following search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_lastUpdated=gt2010-10-01</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_lastUpdated=gt2010-10-01</span>
  </span>
</span>
</p>
<p>
is a search for Observations changed since October 1, 2010. 
Applications considering using this parameter should also consider defined synchronization approaches - 
<a href="http.html#history">RESTful history</a> and <a href="subscriptions.html">Subscriptions framework</a>.
</p>

<a name="list"></a>
<a name="_list"></a>
<h5>_list</h5>
<p>
  The standard search parameter <code>_list</code> is used to test resources against references in a
  <code>List</code> resource.
</p>
<p>
  The <code>_list</code> search parameter is defined as a <a href="#special">special</a> type parameter.
  Input values are treated as <a href="#token">token</a> values - either the logical identifier (id) of
  a <code>List</code> or a literal for a functional list, as defined in
  <a href="lifecycle.html#current">Current Resource Lists</a>.  Note that when using functional lists,
  servers are not required to make the lists available to the clients as <code>List</code> resources,
  but may choose to do so.
</p>
<p>
  For example:
  <span class="http-search-example">
    <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
    <table>
      <tr><td width="50%"><b>Description</b></td><td><b>Search</b></td></tr>
      <tr>
        <td>Any resource referenced by List "101"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/?_list=101</span>
            <span class="http-verb-display-post">POST [base]/_search
Content-Type: application/x-www-form-urlencoded
_list=101</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Conditions referenced by List "102"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Condition?_list=102</span>
            <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
_list=102</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Female Patients referenced by List "103"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Patient?_list=013&amp;gender=female</span>
            <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_list=013&amp;gender=female</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Encounters for Patients in Group "104"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/Encounter?patient._in=Group/104</span>
            <span class="http-verb-display-post">POST [base]/Encounter/_search
  Content-Type: application/x-www-form-urlencoded
  patient._in=Group/104</span>
          </span>
        </td>
      </tr>
      <tr>
        <td>Current allergy list for patient "42"</td>
        <td>
          <span class="http-verb-display">
            <span class="http-verb-display-get">GET [base]/AllergyIntolerance?patient=42&amp;_list=\$current-allergies</span>
            <span class="http-verb-display-post">POST [base]/AllergyIntolerance/_search
Content-Type: application/x-www-form-urlencoded
patient=42&amp;_list=\$current-allergies</span>
          </span>
        </td>
      </tr>
    </table>
   </span>  
</p>
<p>
  For more information about membership testing, see <a href="#membership">Searching by Membership</a>.
</p>

<a name="profile"></a>
<a name="_profile"></a>
<h5>_profile</h5>
<p>
  The standard search parameter <code>_profile</code> is used to match resources based on values in the
  <a href="resource-definitions.html#Meta.profile">Resource.meta.profile</a> element.  Note that the
  profile search does not test conformance of a resource against any profile, just the values of that
  element.
</p>
<p>
  The <code>_profile</code> search parameter is defined as a <a href="#reference">reference</a> type parameter.
</p>
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_profile=http://hl7.org/fhir/StructureDefinition/bp</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_profile=http://hl7.org/fhir/StructureDefinition/bp</span>
  </span>
</span>
will match Observation resources that contain a <code>Resource.meta.profile</code> of <code>http://hl7.org/fhir/StructureDefinition/bp</code>.
</p>

<a name="query"></a>
<a name="_query"></a>
<h5>_query</h5>
<p>
  The standard search parameter <code>_query</code> is used to execute a pre-defined and named query operation.
  Note that there can only ever be one <code>_query</code> parameter in a set of search parameters. Servers processing
  search requests SHALL refuse to process a search request if they do not recognize the <code>_query</code> parameter value.
</p>
<p>
  The <code>_query</code> search parameter is defined as a <a href="#special">special</a> type parameter.  Input to the
  parameter is treated as a token-based search <span class="stu">TU</span>, requiring an exact match to the query name,
  as defined by the <code>OperationDefinition.code</code> element.
</p>
<p>
  There can only ever be one <code>_query</code> parameter in a set of search
  parameters. Servers processing search requests SHALL
  refuse to process a search request if they do not recognize
  the <code>_query</code> parameter value.
</p>  
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?_query=current-high-risk&amp;ward=1A</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_query=current-high-risk&amp;ward=1A</span>
  </span>
</span>
is a request to run the named query <code>current-high-risk</code> against Patient resources, with a parameter
named <code>ward</code> set to the value <code>1A</code>.  If a server does not have a definition for 
<code>current-high-risk</code>, it would reject the request.
</p>
<p>
  More information about named queries can be found in the section <a href="#advanced">Named Queries</a>.
</p>

<a name="security"></a>
<a name="_security"></a>
<h5>_security</h5>
<p>
  The standard search parameter <code>_security</code> is used to match resources based on security labels in the
  <a href="resource-definitions.html#Meta.security">Resource.meta.security</a> element.
</p>
<p>
  The <code>_security</code> search parameter is defined as a <a href="#token">token</a> type parameter.
</p>
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_security=http://terminology.hl7.org/CodeSystem/v3-Confidentiality|R</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_security=http://terminology.hl7.org/CodeSystem/v3-Confidentiality|R</span>
  </span>
</span>
will match Observation resources that contain a <code>Resource.meta.security</code> value matching the
system <code>http://terminology.hl7.org/CodeSystem/v3-Confidentiality</code> and code of <code>R</code>.
</p>
<p>
  For more information about security labels, please see the <a href="security-labels.html">Security Labels</a> page.
</p>

<a name="source"></a>
<a name="_source"></a>
<h5>_source</h5>
<p>
  The standard search parameter <code>_source</code> is used to match resources based on source information in the
  <a href="resource-definitions.html#Meta.source">Resource.meta.source</a> element.  <code>Meta.source</code> is
  a lightweight way of providing minimal provenance for resources.  If more functionality is required, use of
  <a href="provenance.html">Provenance</a> is recommended.
</p>
<p>
  The <code>_source</code> search parameter is defined as a <a href="#uri">uri</a> type parameter.
</p>
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Patient?_source=http://example.com/Organization/123</span>
    <span class="http-verb-display-post">POST [base]/Patient/_search
Content-Type: application/x-www-form-urlencoded
_source=http://example.com/Organization/123</span>
  </span>
</span>
will match Patient resources that contain the <code>Resource.meta.source</code> value of
<code>http://example.com/Organization/123</code>.
</p>

<a name="tag"></a>
<a name="tags"></a>
<a name="_tag"></a>
<h5>_tag</h5>
<p>
  The standard search parameter <code>_tag</code> is used to match resources based on tag information in the
  <a href="resource-definitions.html#Meta.tag">Resource.meta.tag</a> element.  Tags are intended to be used 
  to identify and relate resources to process and workflow.
</p>
<p>
  The <code>_tag</code> search parameter is defined as a <a href="#token">token</a> type parameter.
</p>
<p>
  For example, the search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_tag=http://terminology.hl7.org/ValueSet/v3-SeverityObservation|H</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_tag=http://terminology.hl7.org/ValueSet/v3-SeverityObservation|H</span>
  </span>
</span>
will match Observation resources that contain the a tag value matching the system 
<code>http://terminology.hl7.org/ValueSet/v3-SeverityObservation</code> and code <code>H</code>, indicating
that an observation has been tagged as potentially life-threatening or with the potential cause permanent injury.
</p>


<a name="_text"></a>
<h5>_text</h5>
<p>
  The standard search parameter <code>_text</code> is used to perform searches against the narrative content
  of a resource.
</p>
<p>
  The <code>_text</code> search parameter is defined as a <a href="#string">string</a> type parameter.
  While the actual format used by the parameter is implementation-dependant, the search is some form of string
  which can be used for advanced searching.
</p>
<p>
  For example, the following search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Observation?_text=cancer OR metastases OR tumor</span>
    <span class="http-verb-display-post">POST [base]/Observation/_search
Content-Type: application/x-www-form-urlencoded
_text=cancer OR metastases OR tumor</span>
  </span>
</span>
  is a search for Observations that contain any of the phrases "cancer", "metastases", and "tumor" in
  their narrative text (<code>Observation.text</code>).  For example, the key words may appear in:
  <ul>
    <li><code>Observation.text</code> - Text summary of the resource, for human interpretation</li>
    <li><code>Observation.code.text</code> - Type of observation, Plain text representation of the concept</li>
  </ul>
</p>
<p>
  The server MAY choose to search for related terms (e.g., "carcinoma", etc.), but is not required to do so.
</p>
<p>
  More information can be found in the section <a href="#text">Text Search Parameters</a>.
</p>


<a name="_type"></a>
<h5>_type</h5>
<p>
  The standard search parameter <code>_type</code> is used to allow filtering of types in searches
  that are performed across multiple resource types (e.g., searches across the server root).
</p>
<p>
  The <code>_type</code> search parameter is defined as a <a href="#special">special</a> type parameter,
  because there is no standard path expression for searching the types of resources.  However, the parameter is
  a token parameter restricted to the <a href="valueset-resource-types.html">Resource Types</a> Value Set.
</p>
<p>
  For example, the following search:
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/?_type=Observation,Condition&amp;patient=Patient/123</span>
    <span class="http-verb-display-post">POST [base]/_search
Content-Type: application/x-www-form-urlencoded
_type=Observation,Condition&amp;patient=Patient/123</span>
  </span>
</span>
  is a search for Observations and Conditions that are about the patient <code>Patient/123</code>. Since
  the <code>patient</code> search parameter is valid on both the Observation and Condition resources, the
  search is valid.  The same search <b>would not</b> be valid if the <code>_type</code> parameter was
  excluded, since <code>patient</code> is not a search parameter that works across all resources.
</p>
<p>
  More information can be found in the section <a href="#types">Searching Multiple Resource Types</a>.
</p>

<a name="parameters"></a>
<h4>Parameters for each resource</h4>
<p>
In addition to the common parameters defined for all resources, each
FHIR resource type defines its own set of search parameters with
their names, types, and meanings. These search parameters are on the
same page as the resource definitions, and are also published as part
of the standard Capability statement (<a href="capabilitystatement-base.xml.html">XML</a> 
or <a href="capabilitystatement-base.json.html">JSON</a>).
</p>
<p>
In general, the defined search parameters correspond to a
single element in the resource, but this is not required, and some
search parameters refer to the same type of element in multiple
places, or refer to derived values.
</p>
<p>
Some search parameters defined by resources are associated
with more than one path in a resource. This means that the search
parameter matches if any of the paths contain matching content.  If a
path matches, the whole resource is returned in the
search results. The client may have to examine the resource to determine
which path contains the match.
</p>
<p>
Servers are not required to implement any of the standard search parameters. However, servers SHOULD
support the <a href="#id"><code>_id</code></a> parameter <span class="stu">TU</span>.  Servers MAY also define their own parameters.
</p>


<a name="text"></a>
<a name="content"></a>
<h4>Text Search Parameters</h4>
<p>
The special text search parameters, <code>_text</code> and <code>_content</code>, search
on the narrative of the resource, and the entire content of the resource respectively.
Just like string parameters using the <a href="#modifiers"><code>:text</code></a> modifier, these parameters SHOULD support a sophisticated search functionality of the type
offered by typical text indexing services.
The value of the parameter is a text-based search, which may involve searching
multiple words with thesaurus and proximity considerations, and logical operations
such as AND, OR etc. For example (note that the values are unescaped for clarity):
<span class="http-search-example">
  <span class='http-verb-selector'>Show as: <a href='#get'>HTTP GET</a> | <a href='#post'>HTTP POST</a></span>
  <span class="http-verb-display">
    <span class="http-verb-display-get">GET [base]/Condition?_text=(bone OR liver) AND metastases</span>
    <span class="http-verb-display-post">POST [base]/Condition/_search
Content-Type: application/x-www-form-urlencoded
_text=(bone OR liver) AND metastases</span>
  </span>
</span>
</p>
<p>
This request returns all Condition resources with the word "metastases" and either
"bone" or "liver" in the narrative. The server MAY choose to search
for related words as well.
</p>
<p>
Implementers could consider using the rules specified by the <a href="http://docs.oasis-open.org/odata/odata/v4.0/cs01/part1-protocol/odata-v4.0-cs01-part1-protocol.html#_The_$search_System">
OData specification for the $<code>search</code> parameter</a>. Typical implementations would use Lucene, Solr, an SQL-based full text search, or some similar indexing service.
</p>


<a name="conformance"></a>
<h3>Server Conformance</h3>
<p>
In order to allow the client to be confident about what search parameters
were used as criteria by the server, the server SHALL return the parameters
that were actually used to process the search. Applications processing search
results SHALL check these returned values where necessary. For example, if
the server did not support some of the filters specified in the search, a
client might manually apply those filters to the retrieved result set,
display a warning message to the user or take some other action.
</p>
<p>
In the case of a RESTful search, these parameters are encoded in the
self link in the bundle that is returned:
<span class="fhir-example">
  <span class="example-format-selector">Show as: <a href="#json">FHIR+JSON</a> | <a href="#xml">FHIR+XML</a></span>
  <span class="example-format-display">
    <span class="example-format-display-json">
"link": {
  "relation": "self",
  "url": "http://example.org/Patient?name=peter"
}
    </span>
    <span class="example-format-display-xml">
&lt;link&gt;
  &lt;relation value="self"/&gt;
  &lt;url value="http://example.org/Patient?name=peter"/&gt;
&lt;/link&gt;
      </span>
  </span>
</span>
</p>
<p>
In other respects, servers have considerable discretion with regards to supporting search:
</p>
<ul>
 <li>Servers can choose which parameters to support (other than <code>_id</code> above).</li>
 <li>Servers can choose when and where to implement parameter chaining, and when and where they support the <code>_include</code> parameter.</li>
 <li>Servers can declare additional parameters in the profiles referenced from their Capability statements. Servers SHOULD define custom search parameters
    with codes starting with a hyphen ("-") character to ensure that the names they choose do not clash with future parameters defined by this specification. <span class="stu">TU</span></li>
 <li>Servers are not required to enforce case sensitivity on parameter names, though the names are case sensitive (and URLs are generally case-sensitive).</li>
 <li>Servers may choose how many results to return, though the client can use <code>_count</code> as above</li>
 <li>Servers can choose how to sort the return results, though they SHOULD honor the <code>_sort</code> parameter.</li>
</ul>

<a name="currency"></a>
<h3>Search Result Currency</h3>
<p>
The results of a search operation are only guaranteed to be current
at the instant the operation is executed. After the operation is executed,
ongoing actions performed on the resources against which the search was
executed will render the results increasingly stale. The significance
of this depends on the nature of the search, and the kind of use that
is being made of the results.
</p>
<p>
This is particularly relevant when the server is returning the results
in a series of pages. It is at the discretion of the search engine of
how to handle ongoing updates to the resources while the search
is proceeding.
</p>
<p>
Performing a search operation does not change the set of
resources on the server, with the possible exception of the creation
of <a href="auditevent.html">Audit Event</a> resources
auditing the search itself.
</p>

<a name="Summary"></a>
<a name="table"></a>
<h3>Summary Tables</h3>

<table class="list">
<tr><td colspan="4">Common Parameters defined for all resources:</td></tr>
<tr><td><b>Name</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Paths</b></td></tr>
<tr><td><a href="#_content"><code>_content</code></a></td><td><a href="#string">string</a></td><td>Text search against the entire resource</td><td></td></tr>
<tr><td><a href="#_id"><code>_id</code></a></td><td><a href="#token">token</a></td><td>Resource id (not a full URL)</td><td>Resource.id</td></tr>
<tr><td><a href="#_in"><code>_in</code></a></td><td><a href="#reference">reference</a></td><td>Group, List, or CareTeam membership</td><td>Resource.id</td></tr>
<tr><td><a href="#_language"><code>_language</code></a></td><td><a href="#token">token</a></td><td>Language of the resource content</td><td>Resource.language</td></tr>
<tr><td><a href="#_lastUpdated"><code>_lastUpdated</code></a></td><td><a href="#date">date</a></td><td>Date last updated. Server has discretion on the boundary precision</td><td>Resource.meta.lastUpdated</td></tr>
<tr><td><a href="#_list"><code>_list</code></a></td><td><a href="#string">string</a></td><td>All resources in nominated list (by id, not a full URL)</td><td></td></tr>
<tr><td><a href="#_profile"><code>_profile</code></a></td><td><a href="#reference">reference</a></td><td>Search for all resources tagged with a profile</td><td>Resource.meta.profile</td></tr>
<tr><td><a href="#_query">_query</a></td><td><a href="#string">string</a></td><td>Custom named query</td><td></td></tr>
<tr><td><a href="#_security"><code>_security</code></a></td><td><a href="#token">token</a></td><td>Search by a security label</td><td>Resource.meta.security</td></tr>
<tr><td><a href="#_source"><code>_source</code></a></td><td><a href="#uri">uri</a></td><td>Search by where the resource comes from</td><td>Resource.meta.source</td></tr>
<tr><td><a href="#_tag"><code>_tag</code></a></td><td><a href="#token">token</a></td><td>Search by a resource tag</td><td>Resource.meta.tag</td></tr>
<tr><td><a href="#_text"><code>_text</code></a></td><td><a href="#string">string</a></td><td>Text search against the narrative</td><td></td></tr>

<tr><td colspan="4">Search Control Parameters:</td></tr>
<tr><td><b>Name</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Allowable Content</b></td></tr>
<tr><td><a href="#_contained"><code>_contained</code></a></td><td><a href="#string">string</a></td><td>Whether to return resources contained in other resources in the search matches</td><td><code>true</code> | <code>false</code> | <code>both</code> (<code>false</code> is default)</td></tr>
<tr><td><a href="#_containedType"><code>_containedType</code></a></td><td><a href="#string">string</a></td><td>If returning contained resources, whether to return the contained or container resources</td><td><code>container</code> | <code>contained</code></td></tr>
<tr><td><a href="#_count"><code>_count</code></a></td><td><a href="#number">number</a></td><td>Number of results per page</td><td>Whole number</td></tr>
<tr><td><a href="#_elements"><code>_elements</code></a></td><td><a href="#token">token</a></td><td>Request that only a specific set of elements be returned for resources</td><td></td></tr>
<tr><td><a href="#_graph"><code>_graph</code></a></td><td><a href="#reference">reference</a></td><td>Include additional resources according to a <code>GraphDefinition</code></td><td></td></tr>
<tr><td><a href="#_include"><code>_include</code></a></td><td><a href="#string">string</a></td><td>Other resources to include in the search results that search matches point to</td><td>SourceType:searchParam(:targetType)</td></tr>
<tr><td><a href="#_revinclude"><code>_revinclude</code></a></td><td><a href="#string">string</a></td><td>Other resources to include in the search results when they refer to search matches</td><td>SourceType:searchParam(:targetType)</td></tr>
<tr><td><a href="#_score"><code>_score</code></a></td><td><a href="#token">token</a></td><td>Request match relevance in results</td><td><code>true</code> | <code>false</code></td></tr>
<tr><td><a href="#_sort"><code>_sort</code></a></td><td><a href="#string">string</a></td><td>Order to sort results in (can repeat for inner sort orders)</td><td>Name of a valid search parameter</td></tr>
<tr><td><a href="#_summary"><code>_summary</code></a></td><td><a href="#string">string</a></td><td>Just return the summary elements (for resources where this is defined)</td><td><code>true</code> | <code>false</code> (<code>false</code> is default)</td></tr>
<tr><td><a href="#_total"><code>_total</code></a></td><td><a href="#token">token</a></td><td>Request a precision of the total number of results for a request</td><td><code>none</code> | <code>estimate</code> | <code>accurate</code></td></tr>

</table>

<p>
Cross-map between search parameter types and Datatypes:
</p>
<table class="list">
 <tr>
  <td><b>Datatype</b></td>
  <td><b><a href="#number">number</a></b></td>
  <td><b><a href="#date">date</a></b></td>
  <td><b><a href="#reference">reference</a></b></td>
  <td><b><a href="#quantity">quantity</a></b></td>
  <td><b><a href="#uri">uri</a></b></td>
  <td><b><a href="#string">string</a></b></td>
  <td><b><a href="#token">token</a></b></td>
 </tr>
 <tr>
   <td colspan="8" style="background-color: #efefef"><b>Primitive Types</b></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#base64Binary">base64Binary</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk base64Binary%>Not used in search</td> <!-- uri -->
 </tr>
 <tr>
  <td><a href="datatypes.html#boolean">boolean</a></td>
  <td><%xcm boolean:number%></td> <!-- number -->
  <td><%xcm boolean:date%></td> <!-- date -->
  <td><%xcm boolean:reference%></td> <!-- reference -->
  <td><%xcm boolean:quantity%></td> <!-- quantity -->
  <td><%xcm boolean:uri%></td> <!-- uri -->
  <td><%xcm boolean:string%></td> <!-- string -->
  <td><%xcm boolean:token%>. true|false (System = http://terminology.hl7.org/CodeSystem/special-values but not usually needed)</td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#canonical">canonical</a></td>
  <td><%xcm canonical:number%></td> <!-- number -->
  <td><%xcm canonical:date%></td> <!-- date -->
  <td><%xcm canonical:reference%></td> <!-- reference -->
  <td><%xcm canonical:quantity%></td> <!-- quantity -->
  <td><%xcm canonical:uri%></td> <!-- uri -->
  <td><%xcm canonical:string%></td> <!-- string -->
  <td><%xcm canonical:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#code">code</a></td>
  <td><%xcm code:number%></td> <!-- number -->
  <td><%xcm code:date%></td> <!-- date -->
  <td><%xcm code:reference%></td> <!-- reference -->
  <td><%xcm code:quantity%></td> <!-- quantity -->
  <td><%xcm code:uri%></td> <!-- uri -->
  <td><%xcm code:string%></td> <!-- string -->
  <td><%xcm code:token%>. (System, if desired, is defined in the underlying value set for each code)</td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#date">date</a></td>
  <td><%xcm date:number%></td> <!-- number -->
  <td><%xcm date:date%></td> <!-- date -->
  <td><%xcm date:reference%></td> <!-- reference -->
  <td><%xcm date:quantity%></td> <!-- quantity -->
  <td><%xcm date:uri%></td> <!-- uri -->
  <td><%xcm date:string%></td> <!-- string -->
  <td><%xcm date:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#dateTime">dateTime</a></td>
  <td><%xcm dateTime:number%></td> <!-- number -->
  <td><%xcm dateTime:date%></td> <!-- date -->
  <td><%xcm dateTime:reference%></td> <!-- reference -->
  <td><%xcm dateTime:quantity%></td> <!-- quantity -->
  <td><%xcm dateTime:number%></td> <!-- uri -->
  <td><%xcm dateTime:string%></td> <!-- string -->
  <td><%xcm dateTime:token%></td> <!-- token -->
 </tr>
  <tr>
  <td><a href="datatypes.html#decimal">decimal</a></td>
  <td><%xcm decimal:number%></td> <!-- number -->
  <td><%xcm decimal:date%></td> <!-- date -->
  <td><%xcm decimal:reference%></td> <!-- reference -->
  <td><%xcm decimal:quantity%></td> <!-- quantity -->
  <td><%xcm decimal:uri%></td> <!-- uri -->
  <td><%xcm decimal:string%></td> <!-- string -->
  <td><%xcm decimal:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#id">id</a></td>
  <td><%xcm id:number%></td> <!-- number -->
  <td><%xcm id:date%></td> <!-- date -->
  <td><%xcm id:reference%></td> <!-- reference -->
  <td><%xcm id:quantity%></td> <!-- quantity -->
  <td><%xcm id:uri%></td> <!-- uri -->
  <td><%xcm id:string%></td> <!-- string -->
  <td><%xcm id:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#instant">instant</a></td>
  <td><%xcm instant:number%></td> <!-- number -->
  <td><%xcm instant:date%></td> <!-- date -->
  <td><%xcm instant:reference%></td> <!-- reference -->
  <td><%xcm instant:quantity%></td> <!-- quantity -->
  <td><%xcm instant:uri%></td> <!-- uri -->
  <td><%xcm instant:string%></td> <!-- string -->
  <td><%xcm instant:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#integer">integer</a></td>
  <td><%xcm integer:number%></td> <!-- number -->
  <td><%xcm integer:date%></td> <!-- date -->
  <td><%xcm integer:reference%></td> <!-- reference -->
  <td><%xcm integer:quantity%></td> <!-- quantity -->
  <td><%xcm integer:uri%></td> <!-- uri -->
  <td><%xcm integer:string%></td> <!-- string -->
  <td><%xcm integer:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#markdown">markdown</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk markdown%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#oid">oid</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk oid%>Not used in search (but see uri)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#positiveInt">positiveInt</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk positiveInt%>Not used in search (but see integer)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#string">string</a></td>
  <td><%xcm string:number%></td> <!-- number -->
  <td><%xcm string:date%></td> <!-- date -->
  <td><%xcm string:reference%></td> <!-- reference -->
  <td><%xcm string:quantity%></td> <!-- quantity -->
  <td><%xcm string:uri%></td> <!-- uri -->
  <td><%xcm string:string%></td> <!-- string -->
  <td><%xcm string:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#time">time</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk time%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#unsignedInt">unsignedInt</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk unsignedInt%>Not used in search (but see integer)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#uri">uri</a></td>
  <td><%xcm uri:number%></td> <!-- number -->
  <td><%xcm uri:date%></td> <!-- date -->
  <td><%xcm uri:reference%></td> <!-- reference -->
  <td><%xcm uri:quantity%></td> <!-- quantity -->
  <td><%xcm uri:uri%></td> <!-- uri -->
  <td><%xcm uri:string%> </td> <!-- string -->
  <td><%xcm uri:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#url">url</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk url%>Not used in search (but see uri)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#uuid">uuid</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk uuid%>Not used in search (but see uri)</td>
 </tr>
 <tr>
   <td colspan="8" style="background-color: #efefef"><b>Datatypes</b></td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Address">Address</a></td>
  <td><%xcm Address:number%></td> <!-- number -->
  <td><%xcm Address:date%></td> <!-- date -->
  <td><%xcm Address:reference%></td> <!-- reference -->
  <td><%xcm Address:quantity%></td> <!-- quantity -->
  <td><%xcm Address:uri%></td> <!-- uri -->
  <td><%xcm Address:string%> search on any string element in the address</td> <!-- string -->
  <td><%xcm Address:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Age">Age</a></td>
  <td><%xcm Age:number%></td> <!-- number -->
  <td><%xcm Age:date%></td> <!-- date -->
  <td><%xcm Age:reference%></td> <!-- reference -->
  <td><%xcm Age:quantity%></td> <!-- quantity -->
  <td><%xcm Age:uri%></td> <!-- uri -->
  <td><%xcm Age:string%></td> <!-- string -->
  <td><%xcm Age:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Annotation">Annotation</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk Annotation%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Annotation">Attachment</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk Attachment%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#CodeableConcept">CodeableConcept</a></td>
  <td><%xcm CodeableConcept:number%></td> <!-- number -->
  <td><%xcm CodeableConcept:date%></td> <!-- date -->
  <td><%xcm CodeableConcept:reference%></td> <!-- reference -->
  <td><%xcm CodeableConcept:quantity%></td> <!-- quantity -->
  <td><%xcm CodeableConcept:uri%></td> <!-- uri -->
  <td><%xcm CodeableConcept:string%></td> <!-- string -->
  <td><%xcm CodeableConcept:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#CodeableReference">CodeableReference</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk CodeableReference%>Not used in search (searches either refer to .concept or .reference)</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Coding">Coding</a></td>
  <td><%xcm Coding:number%></td> <!-- number -->
  <td><%xcm Coding:date%></td> <!-- date -->
  <td><%xcm Coding:reference%></td> <!-- reference -->
  <td><%xcm Coding:quantity%></td> <!-- quantity -->
  <td><%xcm Coding:uri%></td> <!-- uri -->
  <td><%xcm Coding:string%></td> <!-- string -->
  <td><%xcm Coding:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Count">Count</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk Count%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#ContactPoint">ContactPoint</a></td>
  <td><%xcm ContactPoint:number%></td> <!-- number -->
  <td><%xcm ContactPoint:date%></td> <!-- date -->
  <td><%xcm ContactPoint:reference%></td> <!-- reference -->
  <td><%xcm ContactPoint:quantity%></td> <!-- quantity -->
  <td><%xcm ContactPoint:uri%></td> <!-- uri -->
  <td><%xcm ContactPoint:string%></td> <!-- string -->
  <td><%xcm ContactPoint:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Distance">Distance</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk Distance%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Duration">Duration</a></td>
  <td><%xcm Duration:number%></td> <!-- number -->
  <td><%xcm Duration:date%></td> <!-- date -->
  <td><%xcm Duration:reference%></td> <!-- reference -->
  <td><%xcm Duration:quantity%></td> <!-- quantity -->
  <td><%xcm Duration:uri%></td> <!-- uri -->
  <td><%xcm Duration:string%></td> <!-- string -->
  <td><%xcm Duration:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#HumanName">HumanName</a></td>
  <td><%xcm HumanName:number%></td> <!-- number -->
  <td><%xcm HumanName:date%></td> <!-- date -->
  <td><%xcm HumanName:reference%></td> <!-- reference -->
  <td><%xcm HumanName:quantity%></td> <!-- quantity -->
  <td><%xcm HumanName:uri%></td> <!-- uri -->
  <td><%xcm HumanName:string%> Search on any string element in the name</td> <!-- string -->
  <td><%xcm HumanName:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Identifier">Identifier</a></td>
  <td><%xcm Identifier:number%></td> <!-- number -->
  <td><%xcm Identifier:date%></td> <!-- date -->
  <td><%xcm Identifier:reference%></td> <!-- reference -->
  <td><%xcm Identifier:quantity%></td> <!-- quantity -->
  <td><%xcm Identifier:uri%></td> <!-- uri -->
  <td><%xcm Identifier:string%></td> <!-- string -->
  <td><%xcm Identifier:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Money">Money</a></td>
  <td><%xcm Money:number%></td> <!-- number -->
  <td><%xcm Money:date%></td> <!-- date -->
  <td><%xcm Money:reference%></td> <!-- reference -->
  <td><%xcm Money:quantity%></td> <!-- quantity -->
  <td><%xcm Money:uri%></td> <!-- uri -->
  <td><%xcm Money:string%></td> <!-- string -->
  <td><%xcm Money:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Period">Period</a></td>
  <td><%xcm Period:number%></td> <!-- number -->
  <td><%xcm Period:date%></td> <!-- date -->
  <td><%xcm Period:reference%></td> <!-- reference -->
  <td><%xcm Period:quantity%></td> <!-- quantity -->
  <td><%xcm Period:uri%></td> <!-- uri -->
  <td><%xcm Period:string%></td> <!-- string -->
  <td><%xcm Period:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Quantity">Quantity</a></td>
  <td><%xcm Quantity:number%></td> <!-- number -->
  <td><%xcm Quantity:date%></td> <!-- date -->
  <td><%xcm Quantity:reference%></td> <!-- reference -->
  <td><%xcm Quantity:quantity%></td> <!-- quantity -->
  <td><%xcm Quantity:uri%></td> <!-- uri -->
  <td><%xcm Quantity:string%></td> <!-- string -->
  <td><%xcm Quantity:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Range">Range</a></td>
  <td><%xcm Range:number%></td> <!-- number -->
  <td><%xcm Range:date%></td> <!-- date -->
  <td><%xcm Range:reference%></td> <!-- reference -->
  <td><%xcm Range:quantity%></td> <!-- quantity -->
  <td><%xcm Range:uri%></td> <!-- uri -->
  <td><%xcm Range:string%></td> <!-- string -->
  <td><%xcm Range:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#Ratio">Ratio</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk base64Binary%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Reference">Reference</a></td>
  <td><%xcm Reference:number%></td> <!-- number -->
  <td><%xcm Reference:date%></td> <!-- date -->
  <td><%xcm Reference:reference%></td> <!-- reference -->
  <td><%xcm Reference:quantity%></td> <!-- quantity -->
  <td><%xcm Reference:uri%></td> <!-- uri -->
  <td><%xcm Reference:string%></td> <!-- string -->
  <td><%xcm Reference:token%></td> <!-- token -->
 </tr>
 <tr>
  <td><a href="datatypes.html#base64Binary">SampledData</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk SampledData%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Signature">Signature</a></td>
  <td colspan="7" style="background-color: #f9f9f9"><%xcmchk Signature%>Not used in search</td>
 </tr>
 <tr>
  <td><a href="datatypes.html#Timing">Timing</a></td>
  <td><%xcm Timing:number%></td> <!-- number -->
  <td><%xcm Timing:date%></td> <!-- date -->
  <td><%xcm Timing:reference%></td> <!-- reference -->
  <td><%xcm Timing:quantity%></td> <!-- quantity -->
  <td><%xcm Timing:uri%></td> <!-- uri -->
  <td><%xcm Timing:string%></td> <!-- string -->
  <td><%xcm Timing:token%></td> <!-- token -->
 </tr>
</table>

[%file newfooter%]

<!-- based off terminologies -->
<script src="external/jquery/jquery.js"> </script>
<script src="jquery-ui.min.js"> </script>
<script>
$(function() {
  try {
    var httpVerbSelector = sessionStorage.getItem('fhir-http-verb-selector');
  }
  catch(exception){ }

  if (!httpVerbSelector) { httpVerbSelector = 'get'; }
  $(`.http-verb-display-${httpVerbSelector}`).show().siblings().hide();

  $('.http-verb-selector a').on('click', function(e) {
    e.preventDefault();
    httpVerbSelector = $(this).attr('href').substr(1);
    $(`.http-verb-display-${httpVerbSelector}`).show().siblings().hide();
    try {
      sessionStorage.setItem('fhir-http-verb-selector', httpVerbSelector);
    }
    catch(exception){ }
  });

  try {
  var exampleFormatSelector = sessionStorage.getItem('fhir-example-format-selector');
  }
  catch(exception){ }

  if (!exampleFormatSelector) { exampleFormatSelector = 'json'; }
  $(`.example-format-display-${exampleFormatSelector}`).show().siblings().hide();

  $('.example-format-selector a').on('click', function(e) {
    e.preventDefault();
    exampleFormatSelector = $(this).attr('href').substr(1);
    $(`.example-format-display-${exampleFormatSelector}`).show().siblings().hide();
    try {
      sessionStorage.setItem('fhir-example-format-selector', exampleFormatSelector);
    }
    catch(exception){ }
  });
})
</script>


</body>
</html>

