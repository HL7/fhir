<!DOCTYPE HTML>

[%settitle Differences from DSTU Release 2%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]


<table class="colsi"><tr><td id="wg">Responsible Owner: <a _target="blank" href="[%wg fhir%]">[%wgt fhir%]</a> Work Group</td><td id="ballot"><a href="versions.html#std-process">Standards Status</a>:<!--!ns!--><a href="versions.html#std-process">Informative</a></td></tr></table>

<h2>Transforms between DSTU 2 and STU 3</h2>

<p>
In addition to a <a href="diff.html">list of all differences between DSTU 2 and STU 3</a>,
this specification also provides transforms between DSTU and STU 3 for most resources
that were in DSTU 2. These transforms are expressed using the 
<a href="mapping-language.html">FHIR Mapping Language</a>, and both serve as
formal documentation of the relationship between the resource structures in R2 and R3, 
and can also be used to convert between the formats automatically. 
</p>
<p>
The following table summarizes the state of the R2:R3 maps for each resource type.
</p>
<p>
Note the following:
</p>
<ul>
 <li>Transforms are tested using the following method:
  <ol>
   <li>For each example resource in the R2 release of the FHIR specification that has a transform to R3</li>
   <li>apply the transform to R3</li>
   <li>validate against the R3 specification</li>
   <li>apply the reverse transform back to R2</li>
   <li>compare the outcome with the original resource - ideally, it should be identical</li>
  </ol>
 </li>
 <li>
   All transforms should execute - that is, they should be able to take any R2 resource, represent the content in R3, and then generate an R2 representation for the same content.
   Note, though, that in a few cases, the differences between R2 and R3 designs are so significant that not all examples can be successfully transformed at all.
 </li>
 <li>
   For some resources, the differences in design between R2 and R3 are sufficiently great that the R2 examples cannot reproduce the same output 
   after conversion to R3 and then back to R2. For example, the R3 resource may have a different set of status codes with imperfect maps
 </li>
 <li>
   For some resources, the information available in the R2 examples is not enough to generate valid R3 resources, and so the resources generate
   R3 validation errors. (e.g. R2 resources missing an element that is required in R3)
 </li>
 <li>
   The transform scripts are only tested to the degree that R2 provided example data
 </li>
 <li>The Bundle tests include the large distribution files (all valuesets, structure definitions, etc.) and so generate large numbers of validation errors</li>
 <li style="background: gold">For all these reasons, the maps provided in the specification are not authoritative; they are provided to help implementers 
   who need to convert between the R2 and R3 format, but additional revision may be required in an implementation specific context. The 
   <a href="https://confluence.hl7.org/display/FHIR/R2-R3+Transformations">FHIR Wiki</a> tracks ongoing work to provide improved transforms, and other transformation options</li> 
</ul>

<table class="grid">
 <tr>
  <td><b>Resource</b></td>
  <td title="The number of resource examples defined for this resource type as part of FHIR R2"><b># Tests</b></td>
  <td title="The % of the tests that result in succesfully producing an R2 resource (R2 to R3, back to R2)"><b>% Execute OK</b></td>
  <td title="The % of successful tests that produce an identical resource (compare starting example to final example)"><b>% RoundTrip Ok</b></td>
  <td title="The % of successful test that produce a valid R3 resource"><b>% R3 Valid</b></td>
  <td title="The total number of R3 validation error messages"><b>R3 Error Count</b></td>
 </tr>
[%r2maps-summary%]
</table>
[%file newfooter%]


</body>
</html>