<?xml version="1.0" encoding="UTF-8"?>
<Questionnaire xmlns="http://hl7.org/fhir">
    <!-- this is from the PHR Blue Book, (6-5) -->
    <!-- this example uses my proposal: nested groups within questions -->
    <group>
        <header value="Birth details"/>
        <group>
            <header value="Neonatal Information"/>
            <question>
                <text value="Birth weight (kg)"/>
                <answerDecimal value="3.25"/>
            </question>
            <question>
                <text value="Birth length (cm)"/>
                <answerDecimal value="44.3"/>
            </question>
            <question>
                <text value="Vitamin K given"/>
                <choice>
                    <code value="INJECTION"/>
                </choice>
                <group>
                    <extension url="http://hl7.org/Profile/questionnaire#visibilityCondition">
                        <!-- some crappy syntax -->
                        <valueString value="HAS_VALUE(../choice/code) AND NEQ(../choice/code,'NO')"
                        />
                    </extension>
                    <question>
                        <text value="1st dose"/>
                        <answerDate value="1972-11-30"/>
                    </question>
                    <question>
                        <text value="2nd dose"/>
                        <answerDate value="1972-12-11"/>
                    </question>
                </group>
            </question>
            <question>
                <text value="Hep B given y / n"/>
                <answerBoolean value="true"/>
                <group>
                    <question>
                        <text value="Date given"/>
                        <answerDate value="1972-12-04"/>
                    </question>
                </group>
            </question>
            <question>
                <text value="Abnormalities noted at birth"/>
                <answerString value="Already able to speak Chinese"/>
            </question>
        </group>


        <!-- this is again from the PHR Blue Book, (6-5) -->
        <!-- this example uses Group and Question in such a way that Question is never nested -->
        <group>
            <header value="Birth details"/>
            <group>
                <!-- this group is just there to group contiguous lists of questions
                    and the goups which represent 1 question + nested groups -->
                <group>
                    <header value="Neonatal Information"/>
                    <question>
                        <text value="Birth weight (kg)"/>
                        <answerDecimal value="3.25"/>
                    </question>
                    <question>
                        <text value="Birth length (cm)"/>
                        <answerDecimal value="44.3"/>
                    </question>
                </group>
                <group>
                    <question>
                        <text value="Vitamin K given"/>
                        <choice>
                            <code value="INJECTION"/>
                        </choice>
                    </question>
                    <group>
                        <extension url="http://hl7.org/Profile/questionnaire#visibilityCondition">
                            <!-- some crappy syntax -->
                            <valueString
                                value="HAS_VALUE(../choice/code) AND NEQ(../choice/code,'NO')"/>
                        </extension>
                        <question>
                            <text value="1st dose"/>
                            <answerDate value="1972-11-30"/>
                        </question>
                        <question>
                            <text value="2nd dose"/>
                            <answerDate value="1972-12-11"/>
                        </question>
                    </group>
                </group>
                <group>
                    <question>
                        <text value="Hep B given y / n"/>
                        <answerBoolean value="true"/>
                        <group>
                            <question>
                                <text value="Date given"/>
                                <answerDate value="1972-12-04"/>
                            </question>
                        </group>
                    </question>
                </group>
                <group>
                    <question>
                        <text value="Abnormalities noted at birth"/>
                        <answerString value="Already able to speak Chinese"/>
                    </question>
                </group>
            </group>
        </group>
    </group>


    <!-- this is from the PHR Blue Book, (6-5) -->
    <!-- this example allows the content for a group to be a choice between a question and a group, and thus allows interleaving -->
    <group>
        <header value="Birth details"/>
        <item>
            <group>
                <header value="Neonatal Information"/>
                <item>
                    <question>
                        <text value="Birth weight (kg)"/>
                        <answerDecimal value="3.25"/>
                    </question>
                </item>
                <item>
                    <question>
                        <text value="Birth length (cm)"/>
                        <answerDecimal value="44.3"/>
                    </question>
                </item>
                <item>
                    <question>
                        <text value="Vitamin K given"/>
                        <choice>
                            <code value="INJECTION"/>
                        </choice>
                    </question>
                </item>
                <item>
                    <extension url="http://hl7.org/Profile/questionnaire#visibilityCondition">
                        <!-- some crappy syntax -->
                        <valueString value="HAS_VALUE(../choice/code) AND NEQ(../choice/code,'NO')"
                        />
                    </extension>
                    <group>
                        <item>
                            <question>
                                <text value="1st dose"/>
                                <answerDate value="1972-11-30"/>
                            </question>
                        </item>
                        <item>
                            <question>
                                <text value="2nd dose"/>
                                <answerDate value="1972-12-11"/>
                            </question>
                        </item>
                    </group>
                </item>
                <!-- and so on -->
            </group>
        </item>
    </group>


    <!-- this is again from the PHR Blue Book, (6-5) -->
    <!-- And finally, use a janushead element that can contain both a question details and be a group -->
    <element>
        <header value="Birth details"/>
        <element>
            <header value="Neonatal Information"/>
            <element>
                <text value="Birth weight (kg)"/>
                <answerDecimal value="3.25"/>
            </element>
            <element>
                <text value="Birth length (cm)"/>
                <answerDecimal value="44.3"/>
            </element>
            <element>
                <text value="Vitamin K given"/>
                <choice>
                    <code value="INJECTION"/>
                </choice>
                <element>
                    <extension url="http://hl7.org/Profile/questionnaire#visibilityCondition">
                        <!-- some crappy syntax -->
                        <valueString value="HAS_VALUE(../choice/code) AND NEQ(../choice/code,'NO')"
                        />
                    </extension>
                    <element>
                        <text value="1st dose"/>
                        <answerDate value="1972-11-30"/>
                    </element>
                    <element>
                        <text value="2nd dose"/>
                        <answerDate value="1972-12-11"/>
                    </element>
                </element>
            </element>
            <element>
                <text value="Hep B given y / n"/>
                <answerBoolean value="true"/>
                <element>
                    <element>
                        <text value="Date given"/>
                        <answerDate value="1972-12-04"/>
                    </element>
                </element>
            </element>
            <element>
                <text value="Abnormalities noted at birth"/>
                <answerString value="Already able to speak Chinese"/>
            </element>
        </element>
    </element>
</Questionnaire>
