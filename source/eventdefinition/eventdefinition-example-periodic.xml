<?xml version="1.0" encoding="UTF-8"?>

<EventDefinition xmlns="http://hl7.org/fhir">
  <id value="example-periodic"/>
  <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-standards-status">
    <valueCode value="informative"/>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-fmm">
    <valueInteger value="6"/>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/structuredefinition-wg">
    <valueCode value="cds"/>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-library">
    <valueCanonical value="http://hl7.org/fhir/EventDefinition/ExampleEventDefinitionLogic"/>
  </extension>
  <url value="http://hl7.org/fhir/EventDefinition/example-periodic"/>
  <name value="PeriodicEventDefinitionExample"/>
  <title value="Periodic EventDefinition Example"/>
  <status value="draft"/>
  <experimental value="true"/>
  <description value="Example of an EventDefinition using the periodic event approach."/>
  <purpose value="Monitor when 3 consecutive negative stick tests have occurred using a periodic event."/>
  <trigger>
    <type value="periodic"/>
    <timingTiming>
      <repeat>
        <frequency value="1"/>
        <period value="3"/>
        <periodUnit value="h"/>
      </repeat>
    </timingTiming>
    <condition>
      <language value="text/cql-expression"/>
      <expression value="StickTest.within(3 hours).consecutively.take(3).negative().count() = 3"/>
    </condition>
  </trigger>
</EventDefinition>